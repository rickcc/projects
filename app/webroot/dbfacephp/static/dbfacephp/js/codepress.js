CodePress=function(b){var a=document.createElement("iframe");a.textarea=b;a.textarea.disabled=true;a.textarea.style.overflow="hidden";a.style.height=a.textarea.clientHeight+"px";a.style.width="100%";a.textarea.style.overflow="auto";a.style.border="1px solid gray";a.frameBorder=0;a.style.visibility="hidden";a.style.position=CodePress.isWebkit?"static":"absolute";a.options=a.textarea.className;a.initialize=function(){a.body=a.contentWindow.document.getElementsByTagName("body")[0];a.editor=a.contentWindow.CodePress;a.contentWindow.CodePress.setCode(a.textarea.value);a.contentWindow.CodePress.syntaxHighlight("init");a.setOptions();a.textarea.style.display="none";a.style.position="static";a.style.visibility="visible";a.style.display="inline";if(finishedTrigger!=null&&Object.isFunction(finishedTrigger)){finishedTrigger.apply()}};a.edit=function(c,d){if(c){a.textarea.value=document.getElementById(c)?document.getElementById(c).value:c}if(!a.textarea.disabled){return}a.language=d?d:a.getLanguage();a.src=CodePress.path+"codepress.html?language="+a.language;if(a.attachEvent){a.attachEvent("onload",a.initialize)}else{a.addEventListener("load",a.initialize,false)}};a.getLanguage=function(){for(language in CodePress.languages){if(a.options.match("\\b"+language+"\\b")){return CodePress.languages[language]?language:"generic"}}};a.setOptions=function(){if(a.options.match("autocomplete-off")){a.toggleAutoComplete()}if(a.options.match("readonly-on")){a.toggleReadOnly()}if(a.options.match("linenumbers-off")){a.toggleLineNumbers()}};a.getCode=function(){return a.textarea.disabled?a.contentWindow.CodePress.getCode():a.textarea.value};a.setCode=function(c){a.textarea.disabled?a.contentWindow.CodePress.setCode(c):a.textarea.value=c};a.insertCode=function(c){a.textarea.disabled?a.contentWindow.CodePress.insertCode(c,false):a.textarea.value+=c};a.toggleAutoComplete=function(){a.contentWindow.CodePress.autocomplete=!a.contentWindow.CodePress.autocomplete};a.toggleReadOnly=function(){a.textarea.readOnly=!a.textarea.readOnly;if(a.style.display!="none"){a.contentWindow.CodePress.readOnly(a.textarea.readOnly)}};a.toggleLineNumbers=function(){var c=a.body.className;a.body.className=(c==""||c=="show-line-numbers")?"hide-line-numbers":"show-line-numbers"};a.toggleEditor=function(){if(a.textarea.disabled){a.textarea.value=a.getCode();a.textarea.disabled=false;a.style.display="none";a.textarea.style.display="inline"}else{a.textarea.disabled=true;a.style.display="inline";a.textarea.style.display="none";if(CodePress.isWebkit){return}a.setCode(a.textarea.value);a.contentWindow.CodePress.syntaxHighlight("init")}};a.edit();return a};CodePress.languages={sql:"sql"};CodePress.isWebkit=(navigator.userAgent.match(/AppleWebKit\/(\d\d\d)/)&&parseInt(RegExp.$1)<500);CodePress.doCopy=function(text){var swf_data="setClipboard.swf";var tmp=document.createElement("div");tmp.innerHTML=['<embed src="',swf_data,'"',' FlashVars="code=',encodeURI(text),'"',' width="0" height="0"',"></embed>"].join("");with(tmp.style){position="absolute";left="-10px";top="-10px";visibility="hidden"}document.body.appendChild(tmp);setTimeout(function(){document.body.removeChild(tmp)},1000)};CodePress.showAutoComplete=function(){if(showAutoCompleteWait==0){showAutoCompleteWait=5;setTimeout("CodePress.showAutoCompleteNow()",1000)}else{showAutoCompleteWait-=1}};CodePress.showAutoCompleteNow=function(){var b=codepress.getCode();if(b!=lastQuery){lastQuery=b;var a="/tmworks/rview?requestID=autocomp&dbaction="+encodeURIComponent(b);new Ajax.Request(a,{method:"get",onSuccess:function(e){var c=e.responseText||"no response text";var d=document.getElementById("autoComp");d.innerHTML=c},onFailure:function(){var c=document.getElementById("autoComp");c.innerHTML="<table><tbody><tr><td>ERROR</td></tr></tbody></table>"}})}showAutoCompleteWait=0};var finishedTrigger;CodePress.run=function(){s=document.getElementsByTagName("script");for(var a=0,b=s.length;a<b;a++){if(s[a].src.match("codepress.js")){CodePress.path=s[a].src.replace("codepress.js","")}}t=document.getElementsByTagName("textarea");for(var a=0,b=t.length;a<b;a++){if(t[a].className.match("codepress")){id=t[a].id;t[a].id=id+"_cp";codepress=new CodePress(t[a]);t[a].parentNode.insertBefore(codepress,t[a])}}};document.observe("dom:loaded",function(){CodePress.run()});