<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="[{#s_base#}]/dbfacephp/css/structure.css"/><script type="text/javascript" src="[{#s_base#}]/dbfacephp/js/prototype.js"></script><script type="text/javascript" src="[{#s_base#}]/dbfacephp/js/jquery.js"></script><script type="text/javascript" src="[{#s_base#}]/dbfacephp/js/rview.js"></script><script type="text/javascript">
  function check_tbl() {
    var tblname = document.getElementById('tblname').value.replace(/(^\s*)|(\s*$)/g, "");
    var tblnumfields = document.getElementById('tblnumfields').value.replace(/(^\s*)|(\s*$)/g, "");
    if (tblname == "") {
      alert("The table name is empty! ");
      return false;
    }
    if (isNaN(tblnumfields)) {
      alert("Please enter a valid number!");
      return false;
    }
    return true;
  }
  function drop_database(dbname) {
    if (confirm("You are about to DESTROY the complete database '"+dbname+"'!\nAll data in the database will be LOST.\n\nDo you really want to do this? \nPress OK to confirm or press Cancel to return back.")) {
    }
    
  }

  function get_db_priv() {
    var add_dbuser_username=$('add_dbuser_username').value;
    var add_dbuser=$('add_dbuser').value;
    var tmp=add_dbuser_username.split("@");
    $('tag_cogwheel').show();
    $('usersForm').disable();
    $j.getJSON('[{#dbfacephp_base_url#}]/index.php?c=privileges&m=getdbuserpriv', {user:tmp[0],host:tmp[1],db:add_dbuser}, function(json) {
      var h=$H(json);
      h.each(function(pair) {
        if (pair.key.indexOf("_priv") > 0) {
          $('checkbox_'+pair.key).checked = (pair.value == 'Y' ? true : false);
        }        
      });
      $('tag_cogwheel').hide();
      $('usersForm').enable();
    });
  }
  $j(document).ready(function() {
    get_db_priv();
  });
  </script></head><body style="margin-top:0px"><div id="navcolumn"><a href="[{#dbfacephp_base_url#}]/index.php?c=home&m=dashboard">[{ci_lang key='strDashboard'}]</a> > Database Privileges</div><table class="data" style="border:1px solid #666666;margin-top:5px;"><thead><tr><th></th><th>User</th><th>Host</th><th>Password</th><th>Global privileges</th><th>Grant</th><th></th></tr></thead><tbody> [{section name=i loop=$users}] <tr class="[{cycle values="odd,even"}]"><td>[{$smarty.section.i.index+1}]</td><td><label for="checkbox_sel_users_[{$smarty.section.i.index}]">[{$users[i].User}]</label></td><td>[{$users[i].Host}]</td><td>[{if $users[i].Password != ""}]Yes[{else}]No[{/if}]</td><td>[{$users[i].privileges}]</td><td>[{if $users[i].Grant_priv == "Y"}]Yes[{else}]No[{/if}]</td><td align="center"><a href="[{#dbfacephp_base_url#}]/index.php?c=privileges&m=edituser&user=[{$users[i].User}]@[{$users[i].Host}]"><img src="[{#s_base#}]/dbfacephp/img/b_usredit.png" title="Edit Privileges" alt="Edit Privileges" class="icon" width="16" height="16"/></a><a href=""><img border="none" alt="Delete User" src="[{#s_base#}]/dbfacephp/img/s_user_delete.png"></a></td></tr> [{/section}] </tbody></table><fieldset style="margin-top:3px"><legend>Database-specific privileges</legend><table><tr><td><table class="data" style="border:1px solid #666666;margin-top:5px;border-collapse:collapse"><thead><tr><th>Database</th><th>Size</th><th>User</th><th>Action</th></tr></thead><tbody> [{section name=i loop=$dbs}] <tr class="[{cycle name=c1 values="odd,even"}]"><td align="center">[{$dbs[i].dbname}]</td><td align="right">[{$dbs[i].datalength}]B</td><td align="center"><table width="100" cellspacing="0" cellpadding="0" style="border:0px;border-collapse:collapse"><tbody> [{section name=j loop=$dbs[i].users}] <tr class="[{cycle name=bc values="odd,even"}]"><td width="80" class="nobrd"><a href="javascript:$('add_dbuser_username').value='[{$dbs[i].users[j].User}]@[{$dbs[i].users[j].Host}]';$('add_dbuser').value='[{$dbs[i].dbname}]';get_db_priv();">[{$dbs[i].users[j].User}]@[{$dbs[i].users[j].Host}]</a></td><td width="20" align="left" class="nobrd"><a href="[{#dbfacephp_base_url#}]/index.php?c=privileges&m=delpriv&dbname=[{$dbs[i].dbname}]&user=[{$dbs[i].users[j].User}]&host=[{$dbs[i].users[j].Host}]"><img border="none" alt="Delete User" src="[{#s_base#}]/dbfacephp/img/s_user_delete.png"></a></td></tr> [{/section}] </tbody></table></td><td align="center"><a onclick="javascript:$('add_dbuser').value='[{$dbs[i].dbname}]';get_db_priv();" href="javascript:;"><img src="[{#s_base#}]/dbfacephp/img/s_user_add.png" alt='add new user to the database' title='add new user to the database'/></a>&nbsp;<a href="javascript:drop_database('[{$dbs[i].dbname}]');"><img src='[{#s_base#}]/dbfacephp/img/db_drop.gif' alt='drop database' title='drop database'/></a></td></tr> [{/section}] </tbody></table></td><td><fieldset id="fieldset_db_adduser"><legend>Add Database-specific Privileges to User<span id="tag_cogwheel" style="display:none"><img src="[{#s_base#}]/dbfacephp/img/cogwheel.gif"/></span></legend><form name="usersForm" id="usersForm" method="post" action="[{#dbfacephp_base_url#}]/index.php?c=privileges&m=updatepriv"><input type="hidden" name="grant_count" value=""/><table><tr><td><strong>User:</strong></td><td><select class="config-picklist" name="add_dbuser_username" id="add_dbuser_username" style="width:150px" onchange="javascript:get_db_priv();"> [{section name=i loop=$users}] <option value="[{$users[i].User}]@[{$users[i].Host}]" [{if $add_dbuser_username==$users[i].userhost}]selected[{/if}]>[{$users[i].User}]@[{$users[i].Host}]</option> [{/section}] </select></td></tr><tr><td><strong>Database:</strong></td><td><select class="config-picklist" name="add_dbuser_dbname" id="add_dbuser" style="width:150px" onchange="javascript:get_db_priv();"> [{section name=i loop=$dbs}] <option value="[{$dbs[i].dbname}]" [{if $add_dbuser_dbname==$dbs[i].dbname}]selected[{/if}]>[{$dbs[i].dbname}]</option> [{/section}] </select></td></tr><tr><td colspan="2"><fieldset id="fieldset_user_global_rights"><legend> Database-specific privileges (<a onclick="setCheckboxes('usersForm', true); return false;" href="javascript:;">Check All</a> / <a onclick="setCheckboxes('usersForm', false); return false;" href="javascript:;">Uncheck All</a>) </legend><fieldset><legend>Data</legend><div class="item"><input type="checkbox" title="Allows reading data." value="Y" id="checkbox_Select_priv" name="Select_priv"><label for="checkbox_Select_priv"><tt><dfn title="Allows reading data.">SELECT</dfn></tt></label></div><div class="item"><input type="checkbox" title="Allows inserting and replacing data." value="Y" id="checkbox_Insert_priv" name="Insert_priv"><label for="checkbox_Insert_priv"><tt><dfn title="Allows inserting and replacing data.">INSERT</dfn></tt></label></div><div class="item"><input type="checkbox" title="Allows changing data." value="Y" id="checkbox_Update_priv" name="Update_priv"><label for="checkbox_Update_priv"><tt><dfn title="Allows changing data.">UPDATE</dfn></tt></label></div><div class="item"><input type="checkbox" title="Allows deleting data." value="Y" id="checkbox_Delete_priv" name="Delete_priv"><label for="checkbox_Delete_priv"><tt><dfn title="Allows deleting data.">DELETE</dfn></tt></label></div></fieldset><fieldset><legend>Structure</legend><div class="item"><input type="checkbox" title="Allows creating new databases and tables." value="Y" id="checkbox_Create_priv" name="Create_priv"><label for="checkbox_Create_priv"><tt><dfn title="Allows creating new databases and tables.">CREATE</dfn></tt></label></div><div class="item"><input type="checkbox" title="Allows altering the structure of existing tables." value="Y" id="checkbox_Alter_priv" name="Alter_priv"><label for="checkbox_Alter_priv"><tt><dfn title="Allows altering the structure of existing tables.">ALTER</dfn></tt></label></div><div class="item"><input type="checkbox" title="Allows creating and dropping indexes." value="Y" id="checkbox_Index_priv" name="Index_priv"><label for="checkbox_Index_priv"><tt><dfn title="Allows creating and dropping indexes.">INDEX</dfn></tt></label></div><div class="item"><input type="checkbox" title="Allows dropping databases and tables." value="Y" id="checkbox_Drop_priv" name="Drop_priv"><label for="checkbox_Drop_priv"><tt><dfn title="Allows dropping databases and tables.">DROP</dfn></tt></label></div><div class="item"><input type="checkbox" title="Allows creating temporary tables." value="Y" id="checkbox_Create_tmp_table_priv" name="Create_tmp_table_priv"><label for="checkbox_Create_tmp_table_priv"><tt><dfn title="Allows creating temporary tables.">CREATE TEMPORARY TABLES</dfn></tt></label></div><div class="item"><input type="checkbox" title="Allows performing SHOW CREATE VIEW queries." value="Y" id="checkbox_Show_view_priv" name="Show_view_priv"><label for="checkbox_Show_view_priv"><tt><dfn title="Allows performing SHOW CREATE VIEW queries.">SHOW VIEW</dfn></tt></label></div><div class="item"><input type="checkbox" title="Allows creating stored routines." value="Y" id="checkbox_Create_routine_priv" name="Create_routine_priv"><label for="checkbox_Create_routine_priv"><tt><dfn title="Allows creating stored routines.">CREATE ROUTINE</dfn></tt></label></div><div class="item"><input type="checkbox" title="Allows altering and dropping stored routines." value="Y" id="checkbox_Alter_routine_priv" name="Alter_routine_priv"><label for="checkbox_Alter_routine_priv"><tt><dfn title="Allows altering and dropping stored routines.">ALTER ROUTINE</dfn></tt></label></div><div class="item"><input type="checkbox" title="Allows executing stored routines." value="Y" id="checkbox_Execute_priv" name="Execute_priv"><label for="checkbox_Execute_priv"><tt><dfn title="Allows executing stored routines.">EXECUTE</dfn></tt></label></div><div class="item"><input type="checkbox" title="Allows creating new views." value="Y" id="checkbox_Create_view_priv" name="Create_view_priv"><label for="checkbox_Create_view_priv"><tt><dfn title="Allows creating new views.">CREATE VIEW</dfn></tt></label></div><div class="item"><input type="checkbox" title="Allows to set up events for the event scheduler" value="Y" id="checkbox_Event_priv" name="Event_priv"><label for="checkbox_Event_priv"><tt><dfn title="Allows to set up events for the event scheduler">EVENT</dfn></tt></label></div><div class="item"><input type="checkbox" title="Allows creating and dropping triggers" value="Y" id="checkbox_Trigger_priv" name="Trigger_priv"><label for="checkbox_Trigger_priv"><tt><dfn title="Allows creating and dropping triggers">TRIGGER</dfn></tt></label></div></fieldset><fieldset><legend>Administration</legend><div class="item"><input type="checkbox" title="Allows adding users and privileges without reloading the privilege tables." value="Y" id="checkbox_Grant_priv" name="Grant_priv"><label for="checkbox_Grant_priv"><tt><dfn title="Allows adding users and privileges without reloading the privilege tables.">GRANT</dfn></tt></label></div><div class="item"><input type="checkbox" title="Allows locking tables for the current thread." value="Y" id="checkbox_Lock_tables_priv" name="Lock_tables_priv"><label for="checkbox_Lock_tables_priv"><tt><dfn title="Allows locking tables for the current thread.">LOCK TABLES</dfn></tt></label></div><div class="item"><input type="checkbox" title="Has no effect in this MySQL version." value="Y" id="checkbox_References_priv" name="References_priv"><label for="checkbox_References_priv"><tt><dfn title="Has no effect in this MySQL version.">REFERENCES</dfn></tt></label></div></fieldset><div class="clearfloat"></div></fieldset></td></tr><tr><td colspan="2" style="text-align:right"><input type="submit" class="input-submit" value="Confirm"/></td></tr></table></form></fieldset></td></tr></table></fieldset><fieldset id="fieldset_add_user" style="margin-top:3px"><legend>Add new database user</legend><a href="[{#dbfacephp_base_url#}]/index.php?c=privileges&m=adduser"><img src="[{#s_base#}]/dbfacephp/img/s_user_add.png" title="" alt="" class="icon" width="16" height="16" align="absmiddle"/>Add a new User </a></fieldset></body></html>