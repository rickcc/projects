var h_start=0;var h_pos=0;var v_start=0;var v_pos=0;var vFubar=false;var hFubar=false;var gStartHeight=0;var g_object=null;var cX=0;var cY=0;var link1=false;var link2=false;var qb_state=false;var qb_init=false;var qb_startTime;var qb_resultsOnClick=true;var qb_colDrag=false;var qb_begDrag="";var qb_zIndex=100;var gSetFocus="";var htmldb_Img_Dir="./static/dbfacephp/img/";function qb_hPosition(b){var a=b.id;if(!document.all){h_start=b.screenY+h_pos}else{h_start=event.clientY+h_pos}hFubar=true;return false}function qb_hAction(a){hFubar=false;return false}function qb_hNewPos(b){if(hFubar){if(!document.all){var a=b.screenY}else{var a=event.clientY}h_pos=h_start-a;if(h_pos>-gStartHeight&&h_pos<gStartHeight){html_GetElement("qbTableHolder").style.height=gStartHeight-h_pos+"px";html_GetElement("qbBottomHolder").style.height=gStartHeight+h_pos+"px"}}}function qb_toggleSideBar(){html_ToggleElement("qbSideBar");qb_Resize()}function qb_Resize(){}function html_ToggleElement(a){var b=html_GetElement(a);if(b){if(b.style.display=="none"){html_ShowElement(b)}else{html_HideElement(b)}}return b}function html_ShowElement(a){var b=html_GetElement(a);if(b){b.style.display=""}return b}function html_HiddenElement(a){var b=html_GetElement(a);if(b){b.style.visibility="hidden"}return b}function html_HideElement(a){var b=html_GetElement(a);if(b){b.style.display="none"}return b}function html_GetTarget(c){var b;var a;if(!c){c=window.event}if(c.target){b=c.target}else{if(c.srcElement){b=c.srcElement}}if(b.nodeType==3){b=b.parentNode}return b}var gTableCount=new Array();gTableCount[0]=new Array();function qb_addTable(b){if(gTableCount[b]&&gTableCount[b].length>0){var a=parseInt(gTableCount[b][0])+1;gTableCount[b][0]=a;getTable(b,a)}else{gTableCount[b]=new Array();gTableCount[b][0]=0;getTable(b,0)}}function q(a){getTable(a,0)}function q_iud(c){var a=document.getElementById("loadingtable");if(a){a.style.display="block"}var b=ROOT_URL+"?c=iud&m=addtable&param1="+c;ajaxRequest(b,function(){if(req.readyState==4){if(req.status==200){if(a){a.style.display="none"}var d="<div style='display:block;position:absolute;left:28px;top:14px;z-index:100;' movable='1' closable='1' id='"+renewViewName(c)+"_0'>";d+=req.responseText;d+="</div>";$("qbTableHolder").update(d);iud_g_sql()}}})}function getTable(g,c,f,e){var b=document.getElementById("loadingtable");if(b){b.style.display="block"}g=typeof(g)=="object"?g.id:g;var a=g;qb_chkCount(g,c);var d=ROOT_URL+"?c=qb&m=addtable&param1="+g;ajaxRequest(d,function(){if(req.readyState==4){if(req.status==200){if(b){b.style.display="none"}var l=document.createElement("DIV");l.style.display="none";l.style.position="absolute";l.id=renewViewName(g)+"_"+c;var k=html_GetElement("qbTableHolder");k.insertBefore(l,k.firstChild);l.innerHTML=req.responseText;l.movable="1";l.closable="1";if(f&&e){l.style.left=e;l.style.top=f}else{var n=k.getElementsByTagName("TABLE");var r="";var m=false;for(i=0;i<=n.length-1;i++){var h=0;if(n[i].id!=l.id+"_data"&&n[i].id!=""){h=findPosX(n[i])}if(h>r){m=n[i];r=h}}if(m){var p=findPosX(m);var o=findPosY(m);l.style.left=p+(m.offsetWidth+25);l.style.top=o}else{l.style.left=28;l.style.top=14}}l.style.display="block";qb_genSql();qb_initPage(l)}}})}function qb_initPage(a){if(a){addEvent(a,"mousedown",qb_pickIt);addEvent(a,"mousemove",qb_dragIt);addEvent(document,"mouseup",qb_dropIt);addEvent(document,"keypress",qb_keyHandler);addEvent(document,"keydown",qb_keyHandler)}}function qb_keyHandler(a){var b=a?a:window.event;if(document.all){if(event.keyCode==27){qb_clearLink();return true}if(event.keyCode==10&&event.ctrlKey==true){qb_genSql();html_TabClick(html_GetElement("result_tab"),"queryResults_table");qb_getQueryResults();return true}return event.keyCode}else{if(b.keyCode==27){qb_clearLink();return true}if(b.keyCode==13&&b.ctrlKey==true){qb_genSql();html_TabClick(html_GetElement("result_tab"),"queryResults_table");qb_getQueryResults();return true}return b.keyCode}}function qb_pickIt(a){var a=(a)?a:((window.event)?event:null);var g=a.target?a.target:a.srcElement;if(gSetFocus!=""){qbSetFocus();return false}if(g.id=="QUERYTEXT"||g.id=="P1002_QUERY_DESC"||g.id=="P1002_QUERY_NAME"){return true}if(g.nodeName=="scrollbar"||g.nodeName=="input"){return false}if(g.id=="h_slide"){qb_hPosition(a);return false}var e=0;var d=0;if(a.pageX||a.pageY){e=a.pageX-3;d=a.pageY-12}else{if(a.clientX||a.clientY){e=a.clientX+document.body.scrollLeft-3;d=a.clientY+document.body.scrollTop-12}}if(qb_colDrag){var f=html_GetElement("dragimg");if(f){f.style.display="block";f.style.left=e;f.style.top=d;cX=e-f.offsetLeft;cY=d-f.offsetTop;qb_zIndex=qb_zIndex+1;f.style.zIndex=qb_zIndex;g_object=f}return false}var c=html_GetElement("qbTableHolder").scrollTop;var b=html_GetElement("qbTableHolder").scrollLeft;e=e+b;d=d+c;var f=qb_cascadeUpMove(g,"ANY");if(f){g_object=f;qb_zIndex=qb_zIndex+1;f.style.zIndex=qb_zIndex;cX=e-f.offsetLeft;cY=d-f.offsetTop;return false}else{f=null;if(g.tagName=="INPUT"){return true}return false}}function qb_dragIt(a){a=(a)?a:((window.event)?event:null);var f=a.target?a.target:a.srcElement;if(hFubar){qb_hNewPos(a);return false}var e=0;var d=0;if(a.pageX||a.pageY){e=a.pageX-3;d=a.pageY-12}else{if(a.clientX||a.clientY){e=a.clientX+document.body.scrollLeft-3;d=a.clientY+document.body.scrollTop-12}}if(g_object){if(qb_colDrag){if(e-cX>0){g_object.style.left=e-cX+"px"}else{g_object.style.left="0px"}if(d-cY>0){g_object.style.top=d-cY+"px"}else{g_object.style.top="0px"}qb_redraw();return false}else{var c=html_GetElement("qbTableHolder").scrollTop;var b=html_GetElement("qbTableHolder").scrollLeft;e=e+b;d=d+c;if(e-cX>0){g_object.style.left=e-cX+"px"}else{g_object.style.left="0px"}if(d-cY>0){g_object.style.top=d-cY+"px"}else{g_object.style.top="0px"}qb_redraw();return false}}if(f.nodeName=="INPUT"||f.id=="QUERYTEXT"){qb_redraw();return}else{qb_redraw();return false}}function qb_dropIt(a){a=(a)?a:((window.event)?event:null);var h=a.target?a.target:a.srcElement;if(hFubar){qb_hAction(a);return false}if(qb_colDrag){var f=0;var e=0;var d=html_GetElement("qbTableHolder").scrollTop;var c=html_GetElement("qbTableHolder").scrollLeft;if(a.pageX||a.pageY){f=a.pageX+c;e=a.pageY+d}else{if(a.clientX||a.clientY){f=a.clientX+document.body.scrollLeft+c;e=a.clientY+document.body.scrollTop+d}}var g=qb_getItem(f,e);if(g){qb_dragStop(g.getAttributeNode("htmldb:col").nodeValue)}else{var b=html_GetElement("dragimg");if(b){b.style.display="none";qb_colDrag=false;qb_begDrag=""}}}if(g_object){g_object=null}return false}function qb_chkCount(c,b){if(gTableCount[c]&&gTableCount[c].length>0){var a=parseInt(gTableCount[c][0]);if(a<b){gTableCount[c][0]=b}}else{gTableCount[c]=new Array();gTableCount[c][0]=b}}function qb_redraw(){if(qb_links&&qb_links.length>0){for(j=0;j<qb_links.length;j++){qb_links[j].redim()}}}var qb_checkCols=0;var qb_suspendGen=false;function qb_linkDblClick(){var a=this}function qb_tableDblClick(){var a=this}function qb_columnDblClick(){var a=this}function qb_getAlias(d){var b=d.getAttribute("dbname");var c=d.getAttribute("dbcnt");var a="";if(c>0){a=b+"_"+c}else{a=b}return a}function qb_rmTableConditions(e){var d=html_GetElement(e+"_thold");if(d){var b=html_GetElement("conditions").getElementsByTagName("TR");for(var c=0;c<b.length;c++){if(b[c].table&&b[c].table==qb_getAlias(d)){qb_checkCols--;var a=b[c].table;b[c].parentNode.removeChild(b[c]);c--}}}else{return false}qb_genSql()}function qb_addCondition(a){alert(a)}function qb_rmCondition(a){alert(a)}function qb_rmCondition(a){a=html_GetElement(a);a.parentNode.removeChild(a);qb_checkCols--;qb_genSql()}function qb_rmConditionImg(a){var b=html_GetElement("selectColumns_"+a);b.checked=false;a=html_GetElement(a+"_condition");a.parentNode.removeChild(a);qb_checkCols--;qb_genSql()}function qb_toggleOut(c){var a=html_GetElement(c);var b=html_GetElement(a.col+"_grp");if(a.checked){a.checked=true;a.defaultChecked=true}else{a.checked=false;b.checked=false;a.defaultChecked=false;b.defaultChecked=false}qb_genSql()}function qb_toggleGrp(c){var a=html_GetElement(c);cDebug(a);var b=html_GetElement(a.col+"_out");cDebug(b+":"+a.col+"_out");if(a.checked){a.checked=true;b.checked=true;a.defaultChecked=true;b.defaultChecked=true}else{a.defaultChecked=false;a.checked=false}qb_genSql()}function qb_setFun(d){var a=d.value;var b=0;if(a!=""){var c=a.match(/\(/g);if(c){b=c.length}}d.paren=b;qb_genSql()}function qb_rendCharSelect(a){a.options.length=0;a.options[a.options.length]=new Option("","");a.options[a.options.length]=new Option("COUNT","count(");a.options[a.options.length]=new Option("COUNT DISTINCT ","count( distinct ");a.options[a.options.length]=new Option("INITCAP","initcap(");a.options[a.options.length]=new Option("LENGTH","length(");a.options[a.options.length]=new Option("LOWER","lower(");a.options[a.options.length]=new Option("LTRIM","ltrim(");a.options[a.options.length]=new Option("RTRIM","rtrim(");a.options[a.options.length]=new Option("TRIM","rtrim(ltrim(");a.options[a.options.length]=new Option("UPPER","upper(");a=null;return}function qb_rendNumberSelect(a){a.options.length=0;a.options[a.options.length]=new Option("","");a.options[a.options.length]=new Option("COUNT","count(");a.options[a.options.length]=new Option("COUNT DISTINCT ","count( distinct ");a.options[a.options.length]=new Option("AVG","avg(");a.options[a.options.length]=new Option("MAXIMUM","max(");a.options[a.options.length]=new Option("MINIMUM","min(");a.options[a.options.length]=new Option("SUM","sum(");a=null;return}function qb_rendFunSelect(a){a.options.length=0;a.options[a.options.length]=new Option("","");a.options[a.options.length]=new Option("AVG","avg(");a.options[a.options.length]=new Option("COUNT","count(");a.options[a.options.length]=new Option("MAX","max(");a.options[a.options.length]=new Option("MIN","min(");a.options[a.options.length]=new Option("SUM","sum(");a=null;return}function qb_rendDateSelect(a){a.options.length=0;a.options[a.options.length]=new Option("","");a.options[a.options.length]=new Option("COUNT","count(");a.options[a.options.length]=new Option("COUNT DISTINCT ","count( distinct ");a=null;return}function qb_addCondition(c){qb_checkCols++;var a=c;var b=html_GetElement("conditions");cTestClone(c.value.substring(0,c.value.lastIndexOf(".")),c.value.substring(c.value.lastIndexOf(".")+1),c);if(!qb_suspendGen){qb_genSql()}}function cTestClone(a,u,z){var o=new Date();var b=z.parentNode.parentNode.parentNode.rows[0].cells[1].firstChild.value;var h=a+"."+u;var v=html_GetElement("conditions");var d=html_GetElement("clone");var s=d.cloneNode(true);var k=z.value.substring(0,z.value.indexOf("."));s.table=k;s.table=a;var w=s.getElementsByTagName("TD");s.name=b;s.id=z.value+"_condition";w[3].getElementsByTagName("SELECT")[0].id=h+"_fun";var t=w[1];t.id=h+"_Column";t.innerHTML=h;w[2].getElementsByTagName("INPUT")[0].id=h+"_alias";var e=v.getElementsByTagName("INPUT");var y=0;var p=0;for(j=0;j<e.length;j++){var f=e[j].id.substring(e[j].id.indexOf(".")+1);var n=e[j].value.substring(e[j].value.indexOf("_")+1);if(f==u+"_alias"){y=y+1;if(n>p){p=n}}}var m="";if(y==1){m=""}if(y==2){m="_1"}p=parseInt(p)+1;if(y>2){m="_"+p}w[2].getElementsByTagName("INPUT")[0].value="";var g=w[4].getElementsByTagName("INPUT")[0];g.id=h+"_grp";g.grp="1";g.col=z.value;var l=w[5].getElementsByTagName("IMG")[0];l.id=h+"_del";l.value=h;if(document.all){v.tBodies[0].appendChild(s)}else{v.tBodies[0].appendChild(s)}qb_rendFunSelect(html_GetElement(h+"_fun"));s=null;w=null;cDebug("Elap:"+(new Date()-o));return}function qb_RowUp(a){oElement=html_RowUp(a);qb_genSql();return oElement}function qb_RowDown(a){oElement=html_RowDown(a);qb_genSql();return oElement}function qb_checkColumn(b){var a=html_GetElement(b.value+"_condition");if(b.checked==true&&a){return}else{if(b.checked==true&&!a){if(qb_checkCols+1>60){b.checked=false;alert(l_maxCols);return}else{var c=html_GetElement("checkColumns_"+b.value.substring(0,b.value.lastIndexOf(".")));if(!c.checked){c.checked=true}qb_addCondition(b)}}else{if(b.checked==false&&a){qb_rmCondition(a)}else{if(b.checked==false&&!a){return}}}}}function qb_genSql(){qb_resultsOnClick=true}function qb_getLinks(){var a="";var c="";for(var b=0;b<qb_links.length;b++){a=a==""?" ":a+"\n and\t ";var d=qb_links[b].field1.id;c=[d.substring(0,d.lastIndexOf(".")),d.substring(d.lastIndexOf(".")+1)];a=a+""+c[0]+"."+c[1]+"";if(qb_links[b].condition=="L"){a=a+"(+) ="}else{a=a+"="}d=qb_links[b].field2.id;c=[d.substring(0,d.lastIndexOf(".")),d.substring(d.lastIndexOf(".")+1)];a=a+""+c[0]+"."+c[1]+"";if(qb_links[b].condition=="R"){a=a+"(+)"}}return a}function getFullColumnNames(r){var l="<table id='autoCompTable' class='autoComp' ><tbody>";var n=html_GetElement("qbTableHolder").getElementsByTagName("DIV");var f=n.length;if(f==2){l+='<tr><td class="autoComp0" nowrap="nowrap">No column available, Please drag a table above.</td></tr>'}else{for(var k=0;k<f;k++){if(n[k].id&&n[k].id.substring(n[k].id.length-5)=="thold"){var t=n[k].id.substring(0,n[k].id.length-8);var c=html_GetElement(t+"_0_tog").firstChild;for(var h=1;h<c.rows.length;h++){var o=t+"."+c.rows[h].cells[1].innerHTML;l+="<tr onclick=\"javascript:ab();selectTipItem('"+r.id+"', '"+o+'\')"><td onmouseout=\'$(this).style.backgroundColor=""\' onmouseover=\'$(this).style.backgroundColor="#95beff"\' class="autoComp0" nowrap="nowrap">'+o+"</td></tr>"}}}if(plist){var n=plist.split(";");for(var h=0;h<n.length;h++){var o=n[h];l+="<tr onclick=\"javascript:ab();selectTipItem('"+r.id+"', '"+o+'\')"><td onmouseout=\'$(this).style.backgroundColor=""\' onmouseover=\'$(this).style.backgroundColor="#95beff"\' class="autoComp0" nowrap="nowrap">'+o+"</td></tr>"}}}l+="</tbody></table>";var s=document.getElementById("autoComp");s.innerHTML=l;var p=document.getElementById("autoCompTable");var m=document.getElementById(r.id);var g=$(r.id).cumulativeOffset();var b=g.left;var a=g.top+$(r.id).getHeight()+5;p.style.left=b+"px";p.style.top=a+"px";s.style.display="block"}function qb_getTables(){var e=html_GetElement("qbTableHolder").getElementsByTagName("DIV");var a="";for(var b=0;b<e.length;b++){if(e[b].id&&e[b].id.substring(e[b].id.length-5)=="thold"){var c=e[b].getAttribute("htmldb:name");a=a==""?" ":a+",\n\t ";a=a+'"'+c+'" "'+qb_getAlias(e[b])+'"'}}return a}function qb_getColumns(){var l=html_GetElement("conditions").getElementsByTagName("INPUT");var k="";for(var g=0;g<l.length;g++){if(l[g].checked&&l[g].out){var n=html_GetElement(l[g].col+"_alias");var h=html_GetElement(l[g].col+"_fun");if(h&&h.value!=""){if(h.paren>0){var m="";for(var e=0;e<h.paren;e++){m=m+")"}k=k==""?" ":k+",\n\t ";k=k+h.value+l[g].col+m+' as "'+n.value+'"'}else{k=k==""?" ":k+",\n\t ";var b=" ";switch(h.value){case"year":b="to_char("+l[g].col+",'YYYY')";break;case"quarter":b="to_char("+l[g].col+",'Q')";break;case"month":b="to_char("+l[g].col+",'MONTH')";break;case"doy":b="to_char("+l[g].col+",'DDD')";break;case"week":b="to_char("+l[g].col+",'WW')";break;case"weekday":b="to_char("+l[g].col+",'DAY')";break}k=k+b+' as "'+n.value+'"'}}else{k=k==""?" ":k+",\n\t ";var c=l[g].col.split(".");k=k+'"'+c[0]+'"."'+c[1]+'" as "'+n.value+'"'}}}return k}function qb_getWhere(){var e=html_GetElement("conditions").getElementsByTagName("INPUT");var a="";for(var b=0;b<e.length;b++){var f=e[b].value;if(e[b].where&&e[b].value!=""){a=a==""?"\t ":a+" \n   and\t ";var c=e[b].col.split(".");a=a+'"'+c[0]+'"."'+c[1]+'" '+e[b].value}}return a}function qb_getSort(){var h=html_GetElement("conditions").getElementsByTagName("INPUT");var c=new Array;var b=0;var k=1;var g=1;var e="";for(var f=0;f<h.length;f++){if(h[f].sort&&h[f].value!=""){c[b]=h[f];g=c[b].value>g?c[b].value:g;b++}}while(k<=g){for(var f=0;f<c.length;f++){if(c[f].sort&&c[f].value!=""){if(c[f].value==k){var a=html_GetElement(c[f].st);if(a.value=="None"){e=e==""?"\norder by ":e+", ";e=e+c[f].col+" Asc"}else{e=e==""?"\norder by ":e+", ";e=e+c[f].col+" "+a.value}}}}k++}return e}function qb_getGroup(){var c=html_GetElement("conditions").getElementsByTagName("INPUT");var a="";for(var b=0;b<c.length;b++){if(c[b].grp&&c[b].checked){a=a==""?" \ngroup by ":a+", ";a=a+c[b].col}}return a}function qb_SaveTab(a){html_ShowElement(html_MakeParent("R7170925778234838","Save_table"));html_ShowElement(html_MakeParent("R7099926313598093","Save_table"));html_TabClick(a,"Save_table");return}function qb_newCondition(k,s,r,m,p,v,b,n,l){var w=html_GetElement("selectColumns_"+k);w.checked="true";qb_checkColumn(w);var u=html_GetElement(k+"_fun");u.value=r;u.paren=m;var x=html_GetElement(k+"_alias");x.value=s;var h=html_GetElement(k+"_out");h.checked=p=="false"?"":"true";var y=html_GetElement(k+"_st");y.value=v;var e=html_GetElement(k+"_so");e.value=b;var t=html_GetElement(k+"_grp");t.checked=n=="false"?"":"true";var d=html_GetElement(k+"_con");d.value=l}var qb_links=new Array();var qb_links_clone;var qb_zoomFactor=1;var qb_linkMenuNode;function qb_cascadeUpUntil(d,b){var a=true;var c=d;if(c){while(a){c=c.parentNode;if(!c){return}if(c&&c.nodeName==b){a=false}}}return c}function qb_cascadeUpMove(d,b){var a=true;var c=d;if(c){while(a){if(!c){return}if(c.getAttributeNode&&c.getAttributeNode("htmldb:close")&&c.getAttributeNode("htmldb:close").nodeValue=="0"){return null}else{if((b=="ANY"||c.nodeName==b)&&c.movable=="1"){a=false}else{c=c.parentNode}}}}return c}function qb_cascadeUpClose(d,b){var a=true;var c=d;if(c){while(a){c=c.parentNode;if(!c){return}if((b=="ANY"||c.nodeName==b)&&c.closable=="1"){a=false}}}return c}function cDebug(a){if(false){var b=top.html_GetElement("htmldbDEBUG");if(!b){var b=top.document.createElement("textarea");top.document.body.appendChild(b);b.id="htmldbDEBUG"}if(b){b.value=a+"\n"+b.value}}}function html_TabClick(d,b){var c=html_GetElement(b);var a=c.parentNode;html_HideSiblings(c);html_TabMakeCurrent(d);return}function html_TabMakeCurrent(d){var c=html_GetElement(d);if(c){var b=c.parentNode.parentNode.childNodes;for(var a=0;a<b.length;a++){if(b[a]&&b[a].nodeType==1&&b[a].getElementsByTagName("A")[0]){b[a].getElementsByTagName("A")[0].className=""}}d.className="tabcurrent"}return c}function html_HideSiblings(b){var d=html_GetElement(b);if(d){var e=d.parentNode.childNodes;for(var c=0,a=e.length;c<a;c++){if(e[c]&&e[c].nodeType==1){html_HideElement(e[c])}}}html_ToggleElement(d);return d}function html_ShowSiblings(b){var e=html_GetElement(b);if(e){var d=e.parentNode.childNodes;for(var c=0,a=d.length;c<a;c++){if(d[c]&&d[c].nodeType==1){html_ShowElement(d[c])}}}return e}function html_RowUp(d){var c=html_CascadeUpTill(d,"TR");var a=c.parentNode;var b=c.previousSibling;while(b!=null){if(b.nodeType==1){break}b=b.previousSibling}if(b!=null&&b.firstChild!=null&&b.firstChild.nodeName!="TH"&&b.nodeName=="TR"){oElement=a.insertBefore(c,b)}else{oElement=a.appendChild(c)}return oElement}function html_RowDown(d){var c=html_CascadeUpTill(d,"TR");var b=c.parentNode;var a=c.nextSibling;while(a!=null){if(a.nodeType==1){break}a=a.nextSibling}if(a!=null&&a.nodeName=="TR"){oElement=b.insertBefore(c,a.nextSibling)}else{oElement=b.insertBefore(c,b.getElementsByTagName("TR")[1])}return oElement}function html_CascadeUpTill(f,c,b,a){var e=html_GetElement(f);if(e){var d=e.parentNode;if(b){while(d.nodeName!=c&&d.className!=b){d=d.parentNode}}else{while(d.nodeName!=c){d=d.parentNode}}return d}else{return null}}function qb_linkTable(d){d=d.nodeName=="TD"?d:qb_cascadeUpUntil(d,"TD");var e=d;if(link1==false){link1=d;e.style.backgroundColor="#DDDDDD";html_GetElement(link1.id+"_jbox").style.backgroundColor="#DDDDDD";return}else{if(link2==false){link2=d;if(link1==link2){qb_clearLink();qb_validateLinks();return}var c=link1.id.substring(0,link1.id.lastIndexOf("."));var b=link2.id.substring(0,link2.id.lastIndexOf("."));if(c==b){link2=false;return}e.style.backgroundColor="#DDDDDD";html_GetElement(link2.id+"_jbox").style.backgroundColor="#DDDDDD";var a=new qb_link(link1,link2);qb_genSql();link1=false;link2=false;return}}}function iud_removeTable(){$$("div.qbDataTableHolder")[0].remove()}function qb_removeTable(k){if(k.nodeName&&k.nodeName=="IMG"){var g=qb_cascadeUpClose(k,"DIV")}else{var g=html_GetElement(k)}var e;qb_clearLink();qb_rmTableConditions(g.id);g.parentNode.removeChild(g);qb_validateLinks();qb_validateLinks();toolTip_disable();qb_genSql();var h=0;var b=g.id.substring(0,g.id.indexOf("_"));var a=html_GetElement("qbTableHolder");for(e=0;e<a.childNodes.length;e++){if(a.childNodes[e].id==undefined){continue}var f=a.childNodes[e].id.substring(0,a.childNodes[e].id.indexOf("_"));if(f==b){h++}}if(h==0){gTableCount[b]=new Array}}function qb_clearLink(){if(link1!=false&&link1.id){if(html_GetElement(link1.id)){html_GetElement(link1.id+"_jbox").style.backgroundColor="";html_GetElement(link1.id).style.backgroundColor=""}}if(link2!=false&&link2.id){if(html_GetElement(link2.id)){html_GetElement(link2.id+"_jbox").style.backgroundColor="";html_GetElement(link2.id).style.backgroundColor=""}}link1=false;link2=false;qb_validateLinks()}function qb_validateLinks(){var a;for(a=qb_links.length-1;a>=0;a--){var c=html_GetElement(qb_links[a].field1.id+"_jbox");var e=html_GetElement(qb_links[a].field2.id+"_jbox");if(c){c.innerHTML="&nbsp;"}if(e){e.innerHTML="&nbsp;"}}for(a=qb_links.length-1;a>=0;a--){if(qb_links[a]){var d=html_GetElement(qb_links[a].field1.id);var c=html_GetElement(qb_links[a].field1.id+"_jbox");var b=html_GetElement(qb_links[a].field2.id);var e=html_GetElement(qb_links[a].field2.id+"_jbox");if(qb_links[a]&&(!d||!b)){qb_delLink(qb_links[a].linkObj2)}else{d.style.backgroundColor="#DDDDDD";b.style.backgroundColor="#DDDDDD";if(qb_links[a].condition=="L"){c.innerHTML=c.innerHTML+"+";e.innerHTML=e.innerHTML+""}else{if(qb_links[a].condition=="R"){c.innerHTML=c.innerHTML+"";e.innerHTML=e.innerHTML+"+"}else{if(qb_links[a].condition=="I"){c.innerHTML=c.innerHTML+"-";e.innerHTML=e.innerHTML+"-"}else{if(qb_links[a].condition=="F"){c.innerHTML=c.innerHTML+"+";e.innerHTML=e.innerHTML+"+"}else{c.innerHTML=c.innerHTML+"";e.innerHTML=e.innerHTML+""}}}}if(c.innerHTML.indexOf("+")>-1){c.style.backgroundColor=""}else{c.style.backgroundColor="#DDDDDD"}if(e.innerHTML.indexOf("+")>-1){e.style.backgroundColor=""}else{e.style.backgroundColor="#DDDDDD"}}if(d&&!b){d.style.backgroundColor="";c.style.backgroundColor=""}if(!d&&b){b.style.backgroundColor="";e.style.backgroundColor=""}}}}var tt_target;function toolTip_init(){if(document&&document.body){var a=html_GetElement("dhtmltooltip");if(a==null||typeof(a)!="object"){a=document.createElement("DIV");a.id="dhtmltooltip";a.className="htmldbToolTip";a.style.position="absolute";a.style.border="1px solid black";a.style.padding="2px";a.style.backgroundColor="";a.style.visibility="hidden";a.style.zIndex=10000;document.body.appendChild(a)}var b=html_GetElement("dhtmlpointer");if(b==null||typeof(b)!="object"){b=document.createElement("IMG");b.id="dhtmlpointer";b.src=htmldb_Img_Dir+"arrow2.gif";b.style.position="absolute";b.style.zIndex=10001;document.body.appendChild(b)}return true}else{return false}}function toolTip_disable(){if(toolTip_init()){var a=html_GetElement("dhtmltooltip");var b=html_GetElement("dhtmlpointer");tt_target=null;a.style.visibility="hidden";b.style.visibility="hidden";a.style.backgroundColor="";a.style.width="";a.innerHTML=""}}function toolTip_enable(k,e,h,a,d){var k=(k)?k:((window.event)?event:null);var c=k.pageX?k.pageX:k.clientX;var b=k.pageY?k.pageY:k.clientY;if(toolTip_init()){var g=html_GetElement("dhtmltooltip");var f=html_GetElement("dhtmlpointer");tt_target=e;if(!h){h=e.getAttribute("htmldb:tip")}g.innerHTML=h;if(typeof a!="undefined"){g.style.width=a+"px"}if(typeof d!="undefined"&&d!=""){g.style.backgroundColor=d}else{g.style.backgroundColor="lightyellow"}f.style.left=(10+c)+"px";f.style.top=(15+b)+"px";g.style.left=(7+c)+"px";g.style.top=(28+b)+"px";g.style.visibility="visible";g.style.zIndex=10000;f.style.zIndex=10001;f.style.visibility="visible";try{e.addEventListener("mouseout",toolTip_disable,false)}catch(l){e.attachEvent("onmouseout",toolTip_disable)}}return false}function qb_link(e,d,h){for(i=qb_links.length-1;i>=0;i--){var g=qb_links[i].field1.id.split(".");var a=qb_links[i].field2.id.split(".");if(e.id){var c=e.id.split(".");var f=d.id.split(".")}else{var c=e.split(".");var f=d.split(".")}if(qb_links[i].field1.id==e&&(f[0]==a[0])){var b=html_GetElement("dragimg");b.style.display="none";qb_colDrag=false;qb_begDrag="";return}if(qb_links[i].field1.id==d&&(c[0]==a[0])){var b=html_GetElement("dragimg");b.style.display="none";qb_colDrag=false;qb_begDrag="";return}if(qb_links[i].field2.id==e&&(f[0]==g[0])){var b=html_GetElement("dragimg");b.style.display="none";qb_colDrag=false;qb_begDrag="";return}if(qb_links[i].field2.id==d&&(c[0]==g[0])){var b=html_GetElement("dragimg");b.style.display="none";qb_colDrag=false;qb_begDrag="";return}}qb_links.push(this);this.id="link"+(new Date()).getTime();this.id1=html_GetElement(e);this.id2=html_GetElement(d);this.field1=this.id1;this.field2=this.id2;this.linkObj1;this.linkObj2;this.linkObj3;this.col1;this.col2;this.condition=h==null?"I":h;this.create=qb_link_create;this.redim=qb_link_redim;this.setTip=qb_link_setTip;this.getTip=qb_link_tip;this.updateTip=qb_link_updateTip;this.create();this.setTip();this.updateTip();this.redim()}function qb_link_create(){var b;var a=html_GetElement("qbLinkHolder");this.linkObj2=document.createElement("DIV");this.linkObj2.id=this.id;this.linkObj2.menuId=this.linkObj2.id;this.linkObj2.arrayElement=this;this.linkObj2.vert=0;this.linkObj2.relLeft=0;this.linkObj2.style.position="absolute";this.linkObj2.style.overflow="hidden";this.linkObj2.style.zIndex=500;this.linkObj2.innerHTML="&nbsp;";b=document.createElement("DIV");b.style.position="absolute";b.style.overflow="hidden";b.menuId=this.linkObj2.id;b.arrayElement=this;b.style.left=2;b.style.top=0;b.style.width=2;b.style.height="100%";b.style.zIndex=500;b.style.backgroundColor="#cfdccf";this.linkObj2.appendChild(b);this.linkObj1=document.createElement("DIV");this.linkObj1.id=this.linkObj2.id;this.linkObj1.menuId=this.linkObj2.id;this.linkObj1.arrayElement=this;this.linkObj1.style.position="absolute";this.linkObj1.style.overflow="hidden";this.linkObj1.style.zIndex=500;this.linkObj1.innerHTML="<br />";b=document.createElement("DIV");b.style.position="absolute";b.menuId=this.linkObj2.id;b.arrayElement=this;b.style.overflow="hidden";b.style.left=0;b.style.top=2;b.style.width="100%";b.style.height=2;b.style.zIndex=500;this.linkObj1.appendChild(b);b.style.backgroundColor="#cfdccf";this.linkObj1.vert=1;this.linkObj1.onmousedown="lineMouseDown(event);";this.linkObj1.onmouseup="lineMouseUp(event);";this.linkObj3=document.createElement("DIV");this.linkObj3.id=this.linkObj2.id;this.linkObj3.menuId=this.linkObj3.id;this.linkObj3.arrayElement=this;this.linkObj3.style.position="absolute";this.linkObj3.style.overflow="hidden";this.linkObj3.style.zIndex=500;this.linkObj3.innerHTML="&nbsp;";b=document.createElement("DIV");b.style.position="absolute";b.style.overflow="hidden";b.menuId=this.linkObj2.id;b.arrayElement=this;b.style.left=0;b.style.top=2;b.style.width="100%";b.style.height=2;b.style.zIndex=500;b.style.backgroundColor="#cfdccf";this.linkObj3.appendChild(b);a.appendChild(this.linkObj1);a.appendChild(this.linkObj2);a.appendChild(this.linkObj3);this.linkObj1.vert=1;this.linkObj2.vert=0;this.linkObj3.vert=1;if(document.all){this.linkObj1.style.cursor="hand";this.linkObj2.style.cursor="hand";this.linkObj3.style.cursor="hand"}else{this.linkObj1.style.cursor="pointer";this.linkObj2.style.cursor="pointer";this.linkObj3.style.cursor="pointer"}this.linkObj1.className="links1";this.linkObj2.className="links";this.linkObj3.className="links1";sqlQueryRebuild=true;qb_validateLinks()}function qb_link_redim(){var f=qb_cascadeUpUntil(this.field1,"TR");var c=qb_cascadeUpUntil(this.field2,"TR");var n=qb_cascadeUpUntil(f,"DIV");var d=qb_cascadeUpUntil(c,"DIV");if(n.style.display=="none"||(n.scrollHeight&&n.scrollHeight>250)){f=qb_cascadeUpUntil(f,"DIV");f=qb_cascadeUpUntil(f,"DIV")}if(d.style.display=="none"||(d.scrollHeight&&d.scrollHeight>250)){c=qb_cascadeUpUntil(c,"DIV");c=qb_cascadeUpUntil(c,"DIV")}var g=parseInt(findPosX(f));var m=parseInt(findPosY(f));var l=f.offsetWidth;var p=f.offsetHeight;var b=g+l;var e=parseInt(findPosX(c));var k=parseInt(findPosY(c));var h=c.offsetWidth;var o=c.offsetHeight;var a=e+h;this.linkObj1.style.top=m+10;this.linkObj3.style.top=k+10;if(this.linkObj2.relLeft>0){y1=this.linkObj2.relLeft}else{if(b<e){y1=parseInt((e+b)/2)}else{if(a<g){y1=parseInt((g+a)/2)}else{if(b<=a){y1=a+20}else{y1=e-20}}}}this.linkObj2.style.left=y1-2;this.linkObj2.style.height=qb_abs1((m+23)-(k+23));if(y1<g){this.linkObj1.style.left=y1;this.linkObj1.style.width=g-y1}else{if(y1>b){this.linkObj1.style.left=b;this.linkObj1.style.width=y1-b+1}else{this.linkObj1.style.left=y1;this.linkObj1.style.width=1}}if(y1<e){this.linkObj3.style.left=y1;this.linkObj3.style.width=e-y1}else{if(y1>a){this.linkObj3.style.left=a;this.linkObj3.style.width=y1-a+1}else{this.linkObj3.style.left=y1;this.linkObj3.style.width=1}}var s=parseInt(this.linkObj1.style.top);var r=parseInt(this.linkObj3.style.top);this.linkObj2.style.top=((s-r)<0)?s+2:r+2;return false}function qb_link_setTip(){try{this.linkObj1.attachEvent("onmouseover",qb_link_onmouseover);this.linkObj2.attachEvent("onmouseover",qb_link_onmouseover);this.linkObj3.attachEvent("onmouseover",qb_link_onmouseover);this.linkObj1.attachEvent("onclick",qb_link_onclick);this.linkObj2.attachEvent("onclick",qb_link_onclick);this.linkObj3.attachEvent("onclick",qb_link_onclick)}catch(a){}try{this.linkObj1.setAttribute("onmouseover","qb_link_onmouseover(event)");this.linkObj2.setAttribute("onmouseover","qb_link_onmouseover(event)");this.linkObj3.setAttribute("onmouseover","qb_link_onmouseover(event)");this.linkObj1.setAttribute("onclick","qb_link_onclick(event)");this.linkObj2.setAttribute("onclick","qb_link_onclick(event)");this.linkObj3.setAttribute("onclick","qb_link_onclick(event)")}catch(a){}}function qb_link_tip(){return this.field1.id+(this.condition=="L"?"(+)":"")+"="+this.field2.id+(this.condition=="R"?"(+)":"")}function qb_link_updateTip(){var a=this.getTip();this.linkObj2.tip=a;this.linkObj1.tip=a;this.linkObj3.tip=a}function qb_link_onmouseover(a){var a=(a)?a:((window.event)?event:null);var b=a.target?a.target:a.srcElement;qb_linkMenuNode=b.menuId;if(b.tip!=null){toolTip_enable(a,b,b.tip)}}function qb_link_onclick(a){var a=(a)?a:((window.event)?event:null);var b=a.target?a.target:a.srcElement;qb_linkMenuNode=b.menuId;qb_checkOuterLink();qb_OpenLinkMenu(a,b,"defaultLinkMenu")}function qb_abs1(b){return(b<0)?-b:(b>0?b:1)}function qb_delLink(a){var b=a.arrayElement;var c=html_GetElement(b.field1.id+"_jbox");var d=html_GetElement(b.field2.id+"_jbox");if(c){c.style.backgroundColor="";c.innerHTML="&nbsp;&nbsp;"}if(d){d.innerHTML="&nbsp;&nbsp;";d.style.backgroundColor=""}b.field1.style.backgroundColor="";b.field2.style.backgroundColor="";b.linkObj1.parentNode.removeChild(b.linkObj1);b.linkObj2.parentNode.removeChild(b.linkObj2);b.linkObj3.parentNode.removeChild(b.linkObj3);qb_links=qb_delArrElement(qb_links,a);qb_validateLinks();html_HideElement(g_Single_Menu);return}function qb_delLinkClick(){var a=document.getElementById(qb_linkMenuNode);qb_delLink(a);qb_validateLinks();qb_validateLinks();app_AppMenuMultiClose();qb_genSql()}function qb_checkOuterLink(){var d=html_GetElement("defaultLinkMenu");var a=d.childNodes[0].childNodes[5];var b;var c;for(b=qb_links.length-1;b>=0;b--){c=qb_links[b];if(qb_links[b].id==qb_linkMenuNode&&(qb_links[b].condition=="R"||qb_links[b].condition=="L"||qb_links[b].condition=="I"||qb_links[b].condition=="F")){a.style.display="block"}else{a.style.display="none"}}}function qb_delArrElement(a,d){var c;var e=typeof(d)=="object"?d.id:d;var b;for(c=0;c<a.length;c++){if((typeof(a[c])=="object"&&a[c].id==e)||(typeof(a[c])=="string"&&a[c]==e)){b=a.splice(c,1)}}return a}function qb_OpenLinkMenu(a,e,b){a=(a)?a:((window.event)?event:null);var d=a.pageX?a.pageX:a.clientX;var c=a.pageY?a.pageY:a.clientY;dhtml_SingeMenuOpen(e,b,"Set",d,c);html_GetElement("defaultLinkMenu").style.zIndex=200001;return}var gCurrentAppMenu=false;var gCurrentAppMenuImage=false;var gSubMenuArray=new Array();function dhtml_CloseAllSubMenus(c){var d=null;if(!c){d=0}else{d=c}for(var b=d;b<=gSubMenuArray.length;b++){if(gSubMenuArray[b]){var a=html_HideElement(gSubMenuArray[b]);if(a){html_HideElement(a)}}}if(!c){gSubMenuArray.length=0}htmldb_IE_Select_Item_Fix(false);return}function dhtml_CloseAllSubMenusL(b){var a=parseInt(html_CascadeUpTill(b,"UL").getAttribute("htmldb:listlevel"))+1;dhtml_CloseAllSubMenus(a);return}function dhtml_DocMenuCheck(b){var a=html_GetTarget(b);var c=true;while(a.nodeName!="BODY"){a=a.parentNode;if(html_SubString(a.className,"dhtmlMenuLG")){c=!c}}if(c){app_AppMenuMultiClose();dhtml_CloseAllSubMenus();document.onclick=null}else{}return}function dhtml_ButtonDropDown(e,d,c,b,a){dhtml_SingeMenuOpen(e,d,"Bottom",b,a);return}function dhtml_MenuOpen(g,c,e,b){if(html_GetElement(c)){document.onclick=dhtml_DocMenuCheck;if(!e){dhtml_CloseAllSubMenus();gCurrentAppMenu=c}else{var f=parseInt(html_GetElement(c).getAttribute("htmldb:listlevel"));var a=gSubMenuArray[f];if(a){html_HideElement(a)}gSubMenuArray[f]=html_GetElement(c)}var d=html_GetElement(c);document.body.appendChild(d);if(!b||b=="Right"){d.style.position="absolute";d.style.top=parseInt(findPosY(g));d.style.left=parseInt(findPosX(g))}else{if(b=="Bottom"){d.style.position="absolute";d.style.top=parseInt(findPosY(g))+parseInt(g.offsetHeight);d.style.left=parseInt(findPosX(g))}else{if(b=="BottomRight"){d.style.position="absolute";d.style.top=parseInt(findPosY(g))+parseInt(g.offsetHeight);d.style.left=parseInt(findPosX(g))-parseInt(g.offsetWidth)}else{d.style.position="absolute";d.style.top=parseInt(findPosY(g));d.style.left=parseInt(findPosX(g))+parseInt(g.offsetWidth)}}}html_ShowElement(d);dhtml_FixLeft(g,d);htmldb_IE_Select_Item_Fix(d)}return}function dhtml_DocMenuSingleCheck(c,b){if(g_Single_Menu_Count>0){if(c){var a=html_GetTarget(c);var d=true;while(a.nodeName!="BODY"&&!b){a=a.parentNode;if(a==g_Single_Menu){d=!d}}}if(d||b){html_HideElement(g_Single_Menu);document.onclick=null}else{}}else{g_Single_Menu_Count=1}return}var g_Single_Menu=false;var g_Single_Menu_Count=0;function dhtml_SingeMenuOpen(g,d,c,b,a){var e=html_GetElement(d);var f=html_GetElement(g);e.style.zIndex=2001;document.body.appendChild(e);if(!c||c=="Right"){e.style.position="absolute";e.style.top=parseInt(findPosY(f));e.style.left=parseInt(findPosX(f))}else{if(c=="Bottom"){e.style.position="absolute";e.style.top=parseInt(findPosY(f))+parseInt(f.offsetHeight);e.style.left=parseInt(findPosX(f))}else{if(c=="BottomRight"){e.style.position="absolute";e.style.top=parseInt(findPosY(f))+parseInt(f.offsetHeight);e.style.left=parseInt(findPosX(f))-parseInt(f.offsetWidth)}else{if(c=="Set"){e.style.position="absolute";e.style.top=parseInt(a);e.style.left=parseInt(b)}else{e.style.position="absolute";e.style.top=parseInt(findPosY(f));e.style.left=parseInt(findPosX(f))+parseInt(f.offsetWidth)}}}}html_ShowElement(e);dhtml_FixLeft(f,e);htmldb_IE_Select_Item_Fix(true);g_Single_Menu_Count=0;g_Single_Menu=e;document.onclick=dhtml_DocMenuSingleCheck;return}function dhtml_FixLeft(c,b){var a;if(document.all){a=document.body.clientWidth}else{a=window.innerWidth}if(parseInt(a)<parseInt(findPosX(c))+parseInt(c.offsetWidth)+parseInt(b.offsetWidth)){b.style.position="absolute";b.style.left=(parseInt(findPosX(c))-parseInt(b.offsetWidth))}return}function htmldb_IE_Select_Item_Fix(a){var b=document.getElementsByTagName("SELECT").length>=1;if(document.all&&a&&b){if(a.firstChild&&a.firstChild.nodeName!="IFRAME"){a.innerHTML='<iframe  src="'+htmldb_Img_Dir+'blank.html" width="'+a.offsetWidth+'" height="'+a.offsetHeight+'" style="z-index:-10;position: absolute;left: 0;top: 0;filter: progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0);" scrolling="no" frameborder="0"></iframe>'+a.innerHTML}}return}function app_AppMenuMultiOpenBottom(e,a,d){var c=html_GetElement(a);if(e!=gCurrentAppMenuImage){app_AppMenuMultiClose();var b=e.previousSibling.firstChild;e.className="dhtmlMenuOn";dhtml_MenuOpen(b,a,false,"Bottom");gCurrentAppMenuImage=e}else{dhtml_CloseAllSubMenus();app_AppMenuMultiClose()}return}function app_AppMenuMultiOpenBottom2(e,a,d){var c=html_GetElement(a);if(e!=gCurrentAppMenuImage){app_AppMenuMultiClose();var b=e.parentNode;e.className="dhtmlMenuOn";dhtml_MenuOpen(b,a,false,"Bottom");gCurrentAppMenuImage=e}else{dhtml_CloseAllSubMenus();app_AppMenuMultiClose()}return}function app_AppMenuMultiClose(){if(gCurrentAppMenu){var a=html_GetElement(gCurrentAppMenu);gCurrentAppMenuImage.className="dhtmlMenu";html_HideElement(a);gCurrentAppMenu=false;gCurrentAppMenuImage=false}return}function qb_toggleTable(c){var g=html_CascadeUpTill(c,"DIV");var e=g.getAttribute("htmldb:id");var f=g.getAttribute("htmldb:cnt");var b=e+"_"+f+"_tog";var a=html_GetElement(b);var d="none";if(html_CheckImageSrc(c,"min")){html_SwitchImageSrc(c,"min",htmldb_Img_Dir+"qb/vertical_max.png");html_HideElement(a)}else{html_SwitchImageSrc(c,"max",htmldb_Img_Dir+"qb/vertical_min.png");html_ShowElement(a);d=""}qb_redraw();toolTip_disable()}function html_CheckImageSrc(b,a){var c=html_GetElement(b);var d=false;if(c&&c.nodeName=="IMG"){if(c.src.indexOf(a)!=-1){d=true}}return d}function html_SwitchImageSrc(c,a,b){var d=html_GetElement(c);if(d&&d.nodeName=="IMG"){if(d.src.indexOf(a)!=-1){d.src=b}}return d}function qb_outer(a){var b=document.getElementById(qb_linkMenuNode);b.arrayElement.condition=a;b.arrayElement.updateTip();qb_validateLinks();html_HideElement("defaultLinkMenu");qb_genSql()}function qb_dragStart(a){qb_colDrag=true;qb_begDrag=a}function qb_dragStop(d){if(qb_begDrag!=""&&d!=""){var c=qb_begDrag.split(".");var b=d.split(".");if(c[0]!=b[0]){var e=new qb_link(qb_begDrag,d,"E");qb_validateLinks();qb_redraw();qb_genSql()}}var a=html_GetElement("dragimg");a.style.display="none";qb_colDrag=false;qb_begDrag=""}function qb_getItem(k,h){var f=document.getElementsByTagName("TD");var c=false;var m="";for(i=0;i<f.length;i++){var b=f[i].innerHTML;var e=f[i];if(e.getAttributeNode&&e.getAttributeNode("htmldb:dragable")){var d=fPosX(f[i]);var g=fPosY(f[i]);var l=d+e.clientWidth;var a=g+e.clientHeight;if(d<k&&l>k&&g<h&&a>h){return f[i]}}}return null}function fPosX(a){var b=0;if(a.offsetParent){while(a.offsetParent){b+=a.offsetLeft;a=a.offsetParent}}else{if(a.x){b+=a.x}}return b}function fPosY(b){var a=0;if(b.offsetParent){while(b.offsetParent){a+=b.offsetTop;b=b.offsetParent;if(b.className=="qbData"){a-=b.offsetParent.firstChild.scrollTop}}}else{if(b.y){a+=b.y}}return a}function qb_getTableList(){qb_getObjectList("dbaseObjectsSlider",";TABLE;VIEW",html_GetElement("P1002_SCHEMA").value,"1","1000","DIV",null,"q(this.id)","o");qb_searchTables()}function qb_searchTables(){var a=html_GetElement("dbaseObjectsSlider");html_Find(html_GetElement("dbaseObjectsSlider"),html_GetElement("P1002_FIND").value,"DIV","dbaseObject")}var gRegex=false;function html_Find(k,h,b,c){if(!b){b="DIV"}k=html_GetElement(k);if(k){var f=k.getElementsByTagName(b);k.style.display="none";if(!gRegex){gRegex=new RegExp("test")}gRegex.compile(h,"i");var g=new Date();for(var e=0,a=f.length;e<a;e++){if(gRegex.test(f[e].innerHTML)){f[e].style.display="block"}else{f[e].style.display="none"}}k.style.display="block"}return}function shqueryedit(a){var b="/tmworks/rview";var c=new Ajax.Request(b,{method:"post",parameters:"requestID=showallquerys&qbID="+docid("qbID").value,onComplete:function(d){aftShqueryedit(d.responseText,a)}})}var qbdelHtml="";function aftShqueryedit(html,eOrD){if(qbdelHtml==""){qbdelHtml=docid("querydeldiv").innerHTML;docid("querydeldiv").parentNode.removeChild(docid("querydeldiv"))}showDialog(qbdelHtml,"position=absolute, left=175, top=80, closeButton=no, modal=yes",function(){var obj=eval("("+html+")");var ele=docid("allqblistd");for(var i=0;i<obj.length/2;i++){ele.options[i]=new Option(obj[i*2]+" : "+obj[i*2+1],obj[i*2],true,true)}})}function getsqldetail(){var c=docid("sqldetaildiv");if(c.style.display==""){c.style.display="none";return}else{c.style.display="";var b=docid("allqblistd").value;if(b==""){return}var a=new Ajax.Request("/tmworks/rview",{method:"post",parameters:"requestID=getreptypeimg&param1="+b+"&param2=getsqlcontent",onComplete:function(d){docid("sqlcontent").value=d.responseText}})}}function updatequery(){var b=docid("allqblistd").value;var a=new Ajax.Request("/tmworks/rview",{method:"post",parameters:"requestID=updatequery&qbID="+b+"&qbContent="+(docid("sqlcontent").value).escapeHTML(),onComplete:function(c){alert("Query has been updated!")}})}function getTableLinks(h){var e=new Array();for(var d=0;d<qb_links_clone.length;d++){if(qb_links_clone[d].field1.id.substring(0,qb_links_clone[d].field1.id.lastIndexOf("."))==h){e.push(qb_links_clone[d]);qb_links_clone.splice(d,1);d--}}var f="";for(var d=0;d<e.length;d++){var g=e[d];var b=g.field2.id;var m=b.substring(0,b.lastIndexOf("."));var a=g.condition;if(a=="I"){f+="INNER JOIN\n"}else{if(a=="L"){f+="LEFT OUTER JOIN\n"}else{if(a=="R"){f+="RIGHT OUTER JOIN\n"}else{if(a=="F"){f+="FULL OUTER JOIN\n"}else{f+="INNER JOIN\n"}}}}f+="  "+m+"\n";f+="ON\n";f+="  ("+e[d].field1.id+" = "+b+")\n";e.splice(d,1);d--;for(var c=0;c<e.length;c++){var l=e[c].field2.id;var k=l.substring(0,l.lastIndexOf("."));if(k==m){f+="AND\n";f+="  ("+e[c].field1.id+" = "+l+")\n";e.splice(c,1)}}}return f}function setColumnCheckStatus(a,h){var e=$("qbTableHolder").select('input[type="checkbox"]');var d="";var c=0;var f=new Array();var g=true;var b=0;if(!a){e.each(function(l,k){e[k].checked=true;e[k].disabled=true})}else{e.each(function(l,k){e[k].disabled=false;if(e[k].checked){if(g){if(h=="0"){d+="  "+e[k].value}else{d+="  "+e[k].value+" <a onclick='javascript:popupInputHelper(this, 2);return false;' class='subopen'><=></a> <a href='#' onclick='javascript:popupInputHelper(this, 0);return false;' class='subopen'><--></a>"}g=false}else{if(h=="0"){d+=",<br/>  "+e[k].value}else{d+=",<br/>  "+e[k].value+" <a onclick='javascript:popupInputHelper(this, 2);return false;' class='subopen'><=></a> <a href='#' onclick='javascript:popupInputHelper(this, 0);return false;' class='subopen'><--></a>"}}f[b++]=e[k].value;c++}})}return{checkColumn:d,checkNum:c,allColumn:f}}var base_condition='  <a class="subopen" onclick="popupInputHelper(this, 1);return false;"><--></a> <a class="subopen" onclick="popupInputHelper(this, 2);return false;">=</a> <a class="subopen" onclick="popupInputHelper(this, 1);return false;"><--></a>  <img src="./static/dbfacephp/img/qb/add.gif" align="absmiddle" onclick="iud_addcondition();"/>';var iud_tn;var iud_columnlist;var iud_valuelist;var iud_condition=base_condition;var tpl;function iud_g_sql(){if(appendFlag&&!confirm("Changing the generated script pattern will reset all your input. Do you really want to do this?\nPress OK to confirm or press Cancel to return back.")){return}appendFlag=false;var f=$("mainForm").getInputs("radio","sqltype").find(function(h){return h.checked});var g=$F(f);var e="";var d="";if(g=="0"){tpl=new Template("insert into #{tablename}(<br/>#{columnlist}<br/>) values (<br/>#{valuelist}<br/>)");e=setColumnCheckStatus(true,g);var a=e.checkNum;for(var c=0;c<a;c++){if(c==a-1){d+="  <a onclick='popupInputHelper(this, 0);return false;' class='subopen'><--></a>"}else{d+="  <a onclick='popupInputHelper(this, 0);return false;' class='subopen'><--></a>,<br/>"}}}else{if(g=="1"){tpl=new Template("update<br/>&nbsp;&nbsp;#{tablename}<br/>&nbsp;set&nbsp;<br/>#{columnlist}<br/>&nbsp;where&nbsp;<br/>#{condition}");e=setColumnCheckStatus(true,g)}else{if(g=="2"){tpl=new Template("delete from<br/>&nbsp;#{tablename}&nbsp;<br/>&nbsp;where&nbsp;<br/>#{condition}");setColumnCheckStatus(false)}else{alert("unknow exception occured!")}}}iud_tn=$$("div.qbDataTableHolder")[0].readAttribute("dbname");iud_columnlist=e.checkColumn;iud_valuelist=d;var b={tablename:iud_tn,columnlist:iud_columnlist,valuelist:iud_valuelist,condition:iud_condition};$("iud_sql").update(tpl.evaluate(b));prettyPrint()}var appendItem;var appendFlag=false;function popupInputHelper(c,b){$("edit_listHolder_select").options.length=0;var a=$("fieldpanel");if(b==0){if(plist){assignSelect($("edit_listHolder_select"),plist.split(";"))}$("edit_input").onclick()}else{if(b==1){if(plist){assignSelect($("edit_listHolder_select"),plist.split(";"))}assignSelect($("edit_listHolder_select"),getAllColumns());$("edit_list").onclick()}else{if(b==2){assignSelect($("edit_listHolder_select"),["=",">",">=","<","<=","<>","like","not like","in","not in","between","not between","is null","is not null"]);$("edit_list").onclick()}else{if(b==3){assignSelect($("edit_listHolder_select"),["and","or","and not","or not"]);$("edit_list").onclick()}}}}if(a.toggle().visible()){var d=$(c).cumulativeOffset();a.style.left=d.left+"px";a.style.top=(d.top+15)+"px";appendItem=$(c)}}function assignAppendItem(){if(appendItem){var a;if($("edit_listHolder").visible()){value=$("edit_listHolder_select").value}if($("edit_inputHolder").visible()){if($("edit_input_checkbox").checked){value='"'+$("edit_inputHolder_input").value+'"'}else{value=$("edit_inputHolder_input").value}}appendItem.down().update(value);appendFlag=true}$("fieldpanel").hide()}function assignSelect(d,a){var c=d.options;for(var b=0;b<a.length;b++){c[c.length]=new Option(a[b],a[b],true,true)}}function getAllColumns(){var b=$("qbTableHolder").select('input[type="checkbox"]');var c=new Array();var a=0;b.each(function(e,d){c[a++]=b[d].value});return c}function iud_addcondition(){if(appendFlag&&!confirm("Changing the generated script pattern will reset all your input. Do you really want to do this?<br/>Press OK to confirm or press Cancel to return back.")){return}appendFlag=false;iud_condition+="  <br/><a class='subopen' onclick='popupInputHelper(this, 3);return false;' class='subopen'>and</a><br/>";iud_condition+=base_condition;var a={tablename:iud_tn,columnlist:iud_columnlist,valuelist:iud_valuelist,condition:iud_condition};$("iud_sql").update(tpl.evaluate(a));prettyPrint()}function iud_gensql(){var a={tablename:iud_tn,columnlist:iud_columnlist,valuelist:iud_valuelist,condition:iud_condition};return tpl.evaluate(a)}function iud_delcondition(){}var qbpropHtml="";var qbprop=["","Untitled Query","This is a untitled query."];function shqueryProp(a){if(qbpropHtml==""){qbpropHtml=docid("querypropdiv").innerHTML;docid("querypropdiv").parentNode.removeChild(docid("querypropdiv"))}if(a=="dml"){showDialog(qbpropHtml,"position=absolute, left=175, top=80, closeButton=no, modal=yes",initDMLProp)}else{showDialog(qbpropHtml,"position=absolute, left=175, top=80, closeButton=no, modal=yes",initQueryProp)}}function initDMLProp(){docid("qbID").value=qbprop[0];docid("qbName").value=qbprop[1];try{iud_gensql();var b=$("iud_sql").innerHTML.stripTags();b=b.replace(/<br>/g,"\n");b=b.replace(/\u2009/g,"");b=b.replace(/<.*?>/g,"");b=b.replace(/&lt;/g,"<");b=b.replace(/&gt;/g,">");b=b.replace(/&amp;/gi,"&");b=b.replace(/&nbsp;/g," ");b=b.replace(/ /g,"")}catch(a){alert(a);b=""}docid("qbContent").value=b}function initQueryProp(){docid("qbID").value=qbprop[0];docid("qbName").value=qbprop[1];qb_genSQL();docid("qbContent").value=codepress?codepress.getCode():docid("QUERYTEXT").value}function subQueryProp(a){var b;if(a=="dml"){b="index.php?c=req&m=savesqlbookmark&cat=sql&subcat=dmlbuilder&catkey="+docid("qbName").value+"&sql="+encodeURIComponent(docid("qbContent").value)}else{b="index.php?c=req&m=savesqlbookmark&catkey="+docid("qbName").value+"&sql="+encodeURIComponent(docid("qbContent").value)}getHtml(b,"aftsubQueryProp")}function aftsubQueryProp(html){var data=eval("("+html+")");if(data.success){alert(data.message);closeDialog()}else{alert(data.message)}};