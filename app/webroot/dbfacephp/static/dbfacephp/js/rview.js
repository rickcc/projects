var objectChild=new Array();var subWin;var autoComplete=1;var selectedRow=-1;var lastList="";var lastQuery=null;var columnsByTable=new Object();var tableAliases=new Object();var showAutoCompleteWait=0;var req;var STATIC_URL="./static/dbfacephp";var ROOT_URL="./index.php";var UPGRADE_URL="./upgrade.php";var codepress;var DB_SQLSERVER="3";function signIn(b){var e="";if(!b){var f=document.login.username.value;var c=document.login.password.value;var a=document.login.autologin.value;e="username="+f+"&password="+c+"&autologin="+a}else{e="usecookie=true"}$("loading_f").show();var d=new Ajax.Request(ROOT_URL+"?c=home&m=login",{method:"post",parameters:e,onComplete:function(n){var m=n.responseJSON;if(!m.success){$("div_message").update('<div style="padding: 0pt 0.7em;" class="ui-state-error ui-corner-all"> <strong>Alert:</strong> '+m.message+"</div>").show()}else{$("div_message").hide();var k=m.lastdbid;var h=m.conns;$("connection").options.length=0;if(h.length>0){var g=false;for(var l=0;l<h.length;l++){if(h[l].dbid==k){AddSelectOption($("connection"),h[l].aliasname,h[l].dbid,true);g=true}else{AddSelectOption($("connection"),h[l].aliasname,h[l].dbid,false)}}if(g){enter();return}}else{AddSelectOption($("connection"),"No connection found",-1,true)}$("div_selconnection").show();$("div_login").hide()}$("loading_f").hide()}})}function loadCookie(){var c=document.cookie;if(c!=null){var b=getCookie("rv_userID");if(b!=null){document.forms[0].userID.value=getCookie("rv_userID")}var a=getCookie("rv_psd");if(a!=null){document.getElementById("psd").setAttribute("value",getCookie("rv_psd"))}var d=getCookie("rv_connID");if(d!=null){document.forms[0].connID.value=getCookie("rv_connID")}if(getCookie("rv_rememberme")=="true"){document.forms[0].autologin.checked=true}else{document.forms[0].autologin.checked=false}}}function AddSelectOption(d,c,b,a){if(d!=null&&d.options!=null){d.options[d.options.length]=new Option(c,b,false,a)}}function displayMenu(b,a){Display(b);VisibleSelectTag(b)}function Display(c){var b=GetElement(c);if(b&&b.style){var a=GetElement("btn"+c);if(b.style.display=="none"){OptionButtonAction(a,true);b.style.display=""}else{OptionButtonAction(a,false);b.style.display="none"}}}function Display(c){var b=GetElement(c);if(b&&b.style){var a=GetElement("btn"+c);if(b.style.display=="none"){OptionButtonAction(a,true);b.style.display=""}else{OptionButtonAction(a,false);b.style.display="none"}}}function VisibleElement(b){var a=GetElement(b);if(a&&a.style){if(a.style.visibility=="hidden"){a.style.visibility="visible"}else{a.style.visibility="hidden"}}}function Visible(d){if(typeof(d)=="string"){if(d.length<1){return}var b=d.split(" ");for(var c=0;c<b.length;++c){VisibleElement(b[c])}}else{VisibleElement(d)}}function DisplayMenu(b,a){Display(b);VisibleSelectTag(b)}function Show(b){var a=GetElement(b);if(a&&a.style){if(a.style.display=="none"){a.style.display=""}}}function GetElement(a){if(document.getElementById){return document.getElementById(a)}return null}function gl(a){p=a.offsetParent;if(!p||p.tagName=="BODY"){return a.offsetLeft}return a.offsetLeft+gl(p)}function gt(a){p=a.offsetParent;if(!p||p.tagName=="BODY"){return a.offsetTop}return a.offsetTop+gt(p)}function VisibleSelectTag(l){var g=GetElement(l);if(!g){return}var k=gl(g);var b=k+g.offsetWidth;var f=gt(g)+g.offsetHeight;var a=document.forms;for(i=1;i<a.length;i++){var e=a[i].elements;for(j=0;j<e.length;j++){var h=e[j];if(h.tagName=="SELECT"){if(g.style.display==""){if(gt(h)<f&&gl(h)<b&&k<gl(h)+h.offsetWidth){h.style.visibility="hidden"}}else{h.style.visibility="visible"}}}}}function OptionButtonAction(a,b){return}function RemoveMember(c,a){var b=c.elements[a].options;li=b.length-1;for(i=0;i<li;i++){if(b[i].selected){b[i]=null;li-=1;i-=1}}}function AddMember(g,e,b){var l=g.elements[e].options;var d=g.elements[b].options;for(i=0;i<l.length-1;i++){var k=l[i];if(!k.selected||!k.value){continue}var h=false;var a=d.length-1;for(j=0;j<a;j++){if(d[j].value==k.value){h=true;break}}if(h){continue}d[d.length]=new Option(d[a].text,"");d[a]=new Option(k.text,k.value,true,true)}}function submitData(a){setBusy();document.mainForm.requestID.value=a;document.mainForm.submit()}function submitData2(a){setBusy();document.mainForm2.requestID.value=a;document.mainForm2.submit()}function submitForm(b,c){setBusy();var a=document.getElementById(c);a.requestID.value=b;a.submit()}function openSunWin(a){var b=window.open(a,"","scrollbars=yes,menubar=no,height=500,width=600,resizable=yes,toolbar=no,location=no,status=no")}function pickdb(){var a="index.php?c=req&m=getdblist&"+$("mainForm").serialize();var b=window.open(a,"","scrollbars=yes,menubar=no,height=300,width=300,resizable=yes,toolbar=no,location=no,status=no")}function openSQLEditor(){var a=window.open("/tmworks/rview?requestID=initsqllab","","scrollbars=yes,menubar=no,height=500,width=830,resizable=yes,toolbar=no,location=no,status=no")}function openFB(b){var a=ROOT_URL+"?c=form&m=show";if(b!=undefined){a+="&closeTrigger="+b}var c=window.open(a,"","scrollbars=yes,menubar=no,height=500,width=800,resizable=yes,toolbar=no,location=no,status=no")}function openSB(b,a,c){if(b==1){openQB(a,c)}else{openIUDB(a,c)}}function openQB(b,c){var a=ROOT_URL+"?c=qb&m=show&wt=true";if(b){a+="&closeFun="+b+"();"}if(c){a+="&plist="+c}var d=window.open(a,"","scrollbars=yes,menubar=no,height=500,width=800,resizable=yes,toolbar=no,location=no,status=no")}function openIUDB(b,c){var a="index.php?c=req&m=initiudbuilder&iframe=true";if(b){a+="&closeFun="+b+"();"}if(c){a+="&plist="+c}var d=window.open(a,"","scrollbars=yes,menubar=no,height=500,width=800,resizable=yes,toolbar=no,location=no,status=no")}var fromvarlist="";function getFormVarList(){return fromvarlist}function copyToIUDEditor(){if($("iud_sql")){var b=$("iud_sql").select("br");b.each(function(e,d){b[d].replace("\n")});var c=$("iud_sql").innerHTML.unescapeHTML().stripTags();var a=window.opener.codepress.getCode();if(a&&!a.blank()){a+="\n;\n"}a+=c;a=a.replace("&nbsp;"," ");window.opener.codepress.setCode(a);window.close()}else{copyToEditor()}}function copyToEditor(){qb_genSQL();var a="";if(window.opener){a=window.opener.codepress.getCode()}else{a=window.parent.codepress.getCode()}if(a&&!a.blank()){a+="\n;\n"}a+=codepress?codepress.getCode():document.getElementById("QUERYTEXT").value;if(window.opener){window.opener.codepress.setCode(a);window.close()}else{if(window.parent){window.parent.codepress.setCode(a)}}}function copyToLoadAction(){qb_genSQL();window.opener.document.getElementById("loadAction").value=codepress?codepress.getCode():document.getElementById("QUERYTEXT").value;window.close()}function copyToEffectForm(){qb_genSQL();window.opener.document.getElementById("updatescript").value=codepress?codepress.getCode():document.getElementById("QUERYTEXT").value;window.close()}function copyToDataSource(){qb_genSQL();var a=codepress?codepress.getCode():document.getElementById("QUERYTEXT").value;window.opener.document.getElementById("datasource").value=a;window.close()}function openCM(){var a=window.open("/tmworks/rview?requestID=catman","","scrollbars=yes,menubar=no,height=500,width=800,resizable=yes,toolbar=no,location=no,status=no")}function openRegist(){var a=window.open("/tmworks/rview?requestID=regist","","scrollbars=no,menubar=no,height=500,width=600,resizable=yes,toolbar=no,location=no,status=no")}function openFeedback(){var a=window.open("/tmworks/rview?requestID=contact","","scrollbars=yes,menubar=no,height=500,width=700,resizable=yes,toolbar=no,location=no,status=no")}function openFBCloseTrigger(){var b=window.opener.document.getElementById("fbclosetrigger");if(b){if(document.all){b.click()}else{var a=document.createEvent("MouseEvents");a.initEvent("click",true,true);b.dispatchEvent(a)}}return true}function trim(a){return a.replace(/(\s*$)/g,"")}function keyDown(c,e){var a=c.keyCode?c.keyCode:c.charCode;if(a==null){return true}if(a==13&&c.ctrlKey){document.mainForm.requestID.value=e;document.mainForm.submit();return false}var b=document.getElementById("autoCompTable");if(b.rows.length>0){if(a==27){while(b.rows.length>0){b.deleteRow(0)}return false}else{if((a==13&&!c.shiftKey)||(a==9&&!c.shiftKey)){if(b.rows.length>selectedRow){var d=b.rows[selectedRow];insertText(d.cells[0].innerHTML);highlightRow(0);if(autoComplete==0){autoComplete=0}return false}}else{if(a==38&&!c.shiftKey){if(b.rows.length>selectedRow){selectedRow=selectedRow<=0?b.rows.length-1:selectedRow-1;highlightRow(selectedRow)}return false}else{if(a==40&&!c.shiftKey){if(b.rows.length>selectedRow){selectedRow=selectedRow>=b.rows.length-1?0:selectedRow+1;highlightRow(selectedRow)}return false}}}}return true}}function highlightRow(b){if(b!=null){selectedRow=b}var a=document.getElementById("autoCompTable");highlightThisRow(a.rows[selectedRow])}function highlightThisRow(f){var e=document.getElementById("autoCompTable");for(var c=0;c<e.rows.length;c++){var d=e.rows[c];var b=(d==f)?"#95beff":"";var a=d.cells;if(a.length>0){a[0].style.backgroundColor=b}}}function keyUp(a){if(autoComplete!=0){showAutoComplete()}return true}function showAutoComplete(){if(showAutoCompleteWait==0){showAutoCompleteWait=5;setTimeout("showAutoCompleteNow()",100)}else{showAutoCompleteWait-=1}}function showAutoCompleteNow(){var a=document.mainForm.sqlContent;var c=a.selectionStart;var b=a.value.substring(0,c);if(b!=lastQuery){lastQuery=b;retrieveList(b)}showAutoCompleteWait=0}function retrieveList(a){sendAsyncRequest("/tmworks/rview?requestID=autocomp&dbaction="+encodeURIComponent(a))}function getXMLHTTPRequest(){req=false;if(window.XMLHttpRequest){try{req=new XMLHttpRequest()}catch(a){req=false}}else{if(window.ActiveXObject){try{req=new ActiveXObject("Msxml2.XMLHTTP")}catch(a){try{req=new ActiveXObject("Microsoft.XMLHTTP")}catch(a){req=false}}}}return req}function ajaxRequest(a,c){req=getXMLHTTPRequest();req.onreadystatechange=c;var b=(new Date()).getTime();a+="&ts="+b;req.open("GET",a,true);req.send("")}function sendAsyncRequest(a){req=false;if(window.XMLHttpRequest){try{req=new XMLHttpRequest()}catch(c){req=false}}else{if(window.ActiveXObject){try{req=new ActiveXObject("Msxml2.XMLHTTP")}catch(c){try{req=new ActiveXObject("Microsoft.XMLHTTP")}catch(c){req=false}}}}if(req){req.onreadystatechange=processAsyncResponse;req.open("GET",a,true);req.send("")}else{var b=document.getElementById("autoComp");b.innerHTML="<tbody><tr><td>ERROR</td></tr></tbody>"}}function processAsyncResponse(){if(req.readyState==4){if(req.status==200){var a=document.getElementById("autoComp");a.innerHTML=req.responseText}else{var a=document.getElementById("autoComp");a.innerHTML="<table><tbody><tr><td>ERROR</td></tr></tbody></table>"}}}function insertText(b){var d=document.mainForm.sqlContent;var a=d.value;var c=a.substring(a.length-1);if(c!="."&&c!="'"&&c!='"'&&c>" "){b=" "+b}d.value+=b;d.focus()}function addEvent(b,a,c){if(c==null){return}if(b.addEventListener){b.addEventListener(a,c,true);return true}else{if(b.attachEvent){return b.attachEvent("on"+a,c)}else{alert("Event handler could not be added")}}}function driverTip(a){a="/tmworks/rview?requestID=drivertip&connSource="+document.getElementById("connSource").value;ajaxRequest(a,function(){if(req.readyState==4){if(req.status==200){var f=req.responseText;if(f==""){return}var e=f.split("|");for(var c=0;c<e.length;c++){var b=e[c].indexOf("=");var d=[e[c].substring(0,b),e[c].substring(b+1)];if(d[0].indexOf("l_")>=0){document.getElementById(d[0]).firstChild.nodeValue=d[1]}else{if(d[0].indexOf("i_")>=0){document.getElementById(d[0]).innerHTML='<img src="'+STATIC_URL+"/img/"+d[1]+'" align="absmiddle"/>'}else{document.getElementById(d[0]).value=d[1]}}}}}})}function dba_mysql_createdb(){if(document.mainForm2.databasename.value==""){alert("Please fill out the database name field!");return false}if(window.confirm("Create Database:"+document.mainForm2.databasename.value+", OK?")){document.mainForm2.scriptContent.value="Create Database "+document.mainForm2.databasename.value;var a="/tmworks/rview?requestID=dbaction2&scriptContent="+encodeURIComponent(document.mainForm2.scriptContent.value);dba_common_response(a)}}function dba_sqlserver_createdb(){if(document.mainForm2.databasename.value==""){alert("Please specify the database name.");return false}if(window.confirm("Create Database:"+document.mainForm2.databasename.value+", OK?")){document.mainForm2.scriptContent.value="CREATE DATABASE ["+document.mainForm2.databasename.value+"]";var a="/tmworks/rview?requestID=dbaction2&scriptContent="+encodeURIComponent(document.mainForm2.scriptContent.value);dba_common_response(a)}}function dba_sqlserver_renamedb(c){var a=document.mainForm2.newdbname.value;if(a==""){alert("Please specify the new database name.");return false}document.mainForm2.scriptContent.value="ALTER DATABASE ["+c+"] MODIFY NAME = ["+a+"]";var b="/tmworks/rview?requestID=dbaction2&scriptContent="+encodeURIComponent(document.mainForm2.scriptContent.value);dba_common_response(b)}function dba_sqlserver_createschema(){var a=document.mainForm2.owner.options[document.mainForm2.owner.selectedIndex].text;var b=document.mainForm2.schemaname.value;if(window.confirm("Create Schema: "+b+", OK?")){document.mainForm2.scriptContent.value="CREATE SCHEMA ["+b+"] AUTHORIZATION ["+a+"] ";var c="/tmworks/rview?requestID=dbaction2&scriptContent="+encodeURIComponent(document.mainForm2.scriptContent.value);dba_common_response(c)}}function dba_sqlserver_dropschema(){var a=document.mainForm2.schemaname.options[document.mainForm2.schemaname.selectedIndex].text;if(window.confirm("Drop Schema: "+a+", OK?")){document.mainForm2.scriptContent.value="DROP SCHEMA ["+a+"]";var b="/tmworks/rview?requestID=dbaction2&scriptContent="+encodeURIComponent(document.mainForm2.scriptContent.value);dba_common_response(b)}}function dba_sqlserver_renametable(){var b=document.mainForm2.oldtablename.options[document.mainForm2.oldtablename.selectedIndex].text;var a=document.mainForm2.newtablename.value;if(a==""){alert("Please specify the new table name.");return false}document.mainForm2.scriptContent.value="EXEC sp_rename '"+b+"', '"+a+"', 'OBJECT'";var c="/tmworks/rview?requestID=dbaction2&scriptContent="+encodeURIComponent(document.mainForm2.scriptContent.value);dba_common_response(c)}function dba_sqlserver_droptable(){var b=document.mainForm2.tablename.options[document.mainForm2.tablename.selectedIndex].text;document.mainForm2.scriptContent.value="DROP TABLE "+b;var a="/tmworks/rview?requestID=dbaction2&scriptContent="+encodeURIComponent(document.mainForm2.scriptContent.value);dba_common_response(a)}function dba_mysql_dropdb(){var b=document.mainForm2.databasename.options[document.mainForm2.databasename.selectedIndex].text;if(window.confirm("Drop Database: "+b+", OK?")){document.mainForm2.scriptContent.value="Drop Database "+b;var a="/tmworks/rview?requestID=dbaction2&scriptContent="+encodeURIComponent(document.mainForm2.scriptContent.value);dba_common_response(a)}}function dba_mysql_createtable(){var h=document.getElementById("tablename").value;var o=document.mainForm2.engine.options[document.mainForm2.engine.selectedIndex].text;var k=document.getElementById("tablecomment").value;var b=document.getElementById("columnset");var n="";var c="CREATE TABLE `"+h+"` (";var s=0;for(var f=1;f<b.rows.length;f++){var a=b.rows[f].cells[1].firstChild.value;if(a==""){continue}if(s!=0){c+=","}s=1;var e=b.rows[f].cells[3].firstChild.value;c+="`"+a+"` "+e;var d=b.rows[f].cells[4].firstChild.value;var g=b.rows[f].cells[5].firstChild.value;var r=b.rows[f].cells[6].firstChild.value;var q=b.rows[f].cells[7].firstChild.value;if(d!=""){if(g!=""){c+="("+d+","+g+") "}else{c+="("+d+") "}}var m=b.rows[f].cells[2].getElementsByTagName("input");if(m[2].checked){c+=" UNSIGNED "}if(m[4].checked){c+=" ZEROFILL "}if(m[0].checked){c+=" NOT NULL "}if(r!=""){c+=" DEFAULT "+r+" "}if(m[3].checked){c+=" AUTO_INCREMENT "}if(m[1].checked){c+=" UNIQUE "}if(q!=""){c+=" COMMENT '"+q+"'"}if(m[5].checked){if(n==""){n+="`"+a+"`"}else{n+=",`"+a+"`"}}}if(n!=""){c+=",PRIMARY KEY ("+n+")"}c+=")ENGINE="+o+" COMMENT='"+k+"'";if(window.confirm("Create Table:\n"+c+", Please Confirm?")){var l="/tmworks/rview?requestID=dbaction2&scriptContent="+encodeURIComponent(c);dba_common_response(l)}}function dba_mysql_renametable(){var b=document.mainForm2.oldtablename.options[document.mainForm2.oldtablename.selectedIndex].text;var a=document.mainForm2.newtablename.value;if(a==""){alert("Please specify the new table name.");return false}document.mainForm2.scriptContent.value="RENAME TABLE "+b+" TO "+a;var c="/tmworks/rview?requestID=dbaction2&scriptContent="+encodeURIComponent(document.mainForm2.scriptContent.value);dba_common_response(c)}function dba_mysql_emptytable(){var b=document.mainForm2.tablename.options[document.mainForm2.tablename.selectedIndex].text;document.mainForm2.scriptContent.value="DELETE FROM "+b;var a="/tmworks/rview?requestID=dbaction2&scriptContent="+encodeURIComponent(document.mainForm2.scriptContent.value);dba_common_response(a)}function dba_mysql_droptable(){var b=document.mainForm2.tablename.options[document.mainForm2.tablename.selectedIndex].text;document.mainForm2.scriptContent.value="DROP TABLE "+b;var a="/tmworks/rview?requestID=dbaction2&scriptContent="+encodeURIComponent(document.mainForm2.scriptContent.value);dba_common_response(a)}function dba_mysql_createview(){var a="/tmworks/rview?requestID=dbaction2&scriptContent="+encodeURIComponent(document.mainForm2.scriptContent2.value);dba_common_response(a)}function dba_sqlserver_createview(){dba_mysql_createview()}function dba_mysql_dropview(){var b="DROP VIEW "+document.mainForm2.viewname.options[document.mainForm2.viewname.selectedIndex].text;var a="/tmworks/rview?requestID=dbaction2&scriptContent="+encodeURIComponent(b);dba_common_response(a)}function dba_sqlserver_dropview(){var b='DROP VIEW "'+document.mainForm2.viewname.options[document.mainForm2.viewname.selectedIndex].text+'"';var a="/tmworks/rview?requestID=dbaction2&scriptContent="+encodeURIComponent(b);dba_common_response(a)}function dba_mysql_createindex(){var f=document.getElementById("tablename").value;if(document.getElementById("tablename").selectedIndex==0){alert("Please specify a valid table.");return}var g=document.getElementById("indexname").value;if(g==""){alert("Please specify a index name to create.");return}var d="CREATE ";if(document.getElementById("unique").checked){d+=" UNIQUE "}d+="INDEX "+g+" ON "+f+" (";var k=0;var b=document.getElementById("columnset");for(var e=1;e<b.rows.length;e++){var c=b.rows[e].cells[1].firstChild.value;if(c==""){continue}if(k!=0){d+=","}k=1;d+=c;var a=b.rows[e].cells[2].firstChild.value;if(a!=""){d+="("+a+")"}d+=" "+b.rows[e].cells[3].firstChild.value}d+=")";if(window.confirm("Create Index:\n"+g+" on "+f+", Please Confirm?\n"+d)){var h="/tmworks/rview?requestID=dbaction2&scriptContent="+encodeURIComponent(d);dba_common_response(h)}}function dba_mysql_dropindex(){var c=document.getElementById("tablename").value;var a=document.getElementById("indexname").value;if(document.getElementById("tablename").selectedIndex==0){alert("Please specify a valid table.");return}if(a==""){alert("Please select the index name to drop.");return}var d="DROP INDEX "+a+" ON "+c;if(window.confirm("Drop Index:\n"+a+", Please Confirm?")){var b="/tmworks/rview?requestID=dbaction2&scriptContent="+encodeURIComponent(d);dba_common_response(b)}}function dba_mysql_createprocedure(){var h=document.getElementById("procedurename").value;if(h==""){alert("Please specify the procedure name!");return}var d="CREATE PROCEDURE `"+h+"` (";var c=document.getElementById("columnset");var n=0;for(var f=1;f<c.rows.length;f++){var g=c.rows[f].cells[2].firstChild.value;if(g==""){continue}var a=c.rows[f].cells[1].firstChild.value;if(n!=0){d+=","}n=1;d+=a+" "+g+" ";var e=c.rows[f].cells[3].firstChild.value;d+=e;var m=c.rows[f].cells[4].firstChild.value;if(m!=""){d+="("+m+")"}}d+=")";var b=document.getElementById("proceduretype").value;d+=" "+b+" ";var l=document.getElementById("sqlsecurity").value;d+=" SQL SECURITY "+l+" ";d+=" BEGIN ";d+=document.getElementById("procedurebody").value;d+=" END";if(window.confirm("Create Procedure:\n"+d+", Please Confirm?")){var k="/tmworks/rview?requestID=dbaction2&scriptContent="+encodeURIComponent(d);dba_common_response(k)}}function dba_mysql_dropprocedure(){var b=document.getElementById("procedurename").value;if(b==""){alert("No procedure selected to drop!");return}if(window.confirm("Drop Procedure:\n"+b+", Please Confirm?")){var a="/tmworks/rview?requestID=dbaction2&scriptContent="+encodeURIComponent("DROP PROCEDURE `"+b+"`");dba_common_response(a)}}function dba_mysql_createfunction(){var d=document.getElementById("functionname").value;if(d==""){alert("Please specify the function name!");return}var b="CREATE FUNCTION `"+d+"` (";var a=document.getElementById("columnset");var n=0;for(var f=1;f<a.rows.length;f++){var g=a.rows[f].cells[1].firstChild.value;if(g==""){continue}if(n!=0){b+=","}n=1;b+=g+" ";var e=a.rows[f].cells[2].firstChild.value;b+=e;var l=a.rows[f].cells[3].firstChild.value;if(l!=""){b+="("+l+")"}}b+=")";var o=document.getElementById("returndatatype").value;b+=" RETURNS "+o;var c=document.getElementById("returndatasize").value;if(c!=""){b+="("+c+") "}var m=document.getElementById("functiontype").value;b+=" "+m+" ";var k=document.getElementById("sqlsecurity").value;b+=" SQL SECURITY "+k+" ";b+=" BEGIN ";b+=document.getElementById("functionbody").value;b+=" END";if(window.confirm("Create Function:\n"+b+", Please Confirm?")){var h="/tmworks/rview?requestID=dbaction2&scriptContent="+encodeURIComponent(b);dba_common_response(h)}}function dba_mysql_dropfunction(){var b=document.getElementById("functionname").value;if(b==""){alert("No function selected to drop!");return}if(window.confirm("Drop Function:\n"+b+", Please Confirm?")){var a="/tmworks/rview?requestID=dbaction2&scriptContent="+encodeURIComponent("DROP FUNCTION `"+b+"`");dba_common_response(a)}}function dba_mysql_createtrigger(){var c=document.getElementById("triggername").value;var e=document.getElementById("tablename").value;var f=document.getElementById("triggertype").value;var b=document.getElementById("triggerevent").value;var a=document.getElementById("triggerbody").value;stmt="CREATE TRIGGER `"+c+"` "+f+" "+b+" ON `"+e+"` FOR EACH ROW ";stmt+=" BEGIN ";stmt+=a;stmt+=" END";if(window.confirm("Create Trigger:\n"+stmt+", Please Confirm?")){var d="/tmworks/rview?requestID=dbaction2&scriptContent="+encodeURIComponent(stmt);dba_common_response(d)}}function dba_mysql_droptrigger(){var a=document.getElementById("triggername").value;if(a==""){alert("No Trigger Available!");return}if(window.confirm("Drop Trigger:\n"+a+", Please Confirm?")){var b="/tmworks/rview?requestID=dbaction2&scriptContent="+encodeURIComponent("DROP TRIGGER `"+a+"`");dba_common_response(b)}}function dba_mysql_createuser(){var g=document.getElementById("username").value;var q=document.getElementById("host").value;var n=document.getElementById("psd1").value;var l=document.getElementById("psd2").value;if(g==""){return}if(n!=l){alert("Password Confirm Fail, Please Check.");return}var e="GRANT ";var o="";var b=0;var a=document.getElementById("privileges_set");var m=a.getElementsByTagName("input");for(var f=0;f<m.length;f++){if(m[f].checked){if(o!=""){o+=","}o+=m[f].value}else{b=1}}if(b==0){e+="ALL PRIVILEGES "}else{e+=o+" "}e+="ON *.* TO ";e+="'"+g+"'@'"+q+"' IDENTIFIED BY '"+n+"' WITH ";if(document.getElementById("grant_priv").checked){e+=" GRANT OPTION "}var h=document.getElementById("max_queries").value;if(h!=""&&h!="0"){e+="MAX_QUERIES_PER_HOUR "+h+" "}else{e+="MAX_QUERIES_PER_HOUR 0 "}var r=document.getElementById("max_updates").value;if(r!=""&&r!="0"){e+="MAX_UPDATES_PER_HOUR "+r+" "}var c=document.getElementById("max_connections").value;if(c!=""&&c!="0"){e+="MAX_CONNECTIONS_PER_HOUR "+c+" "}var d=document.getElementById("max_user_connections").value;if(d!=""&&d!="0"){e+="MAX_USER_CONNECTIONS "+d+" "}if(window.confirm("Grant User:\n"+e+", Please Confirm?")){var k="/tmworks/rview?requestID=dbaction2&scriptContent="+encodeURIComponent(e);dba_common_response(k)}}function dba_mysql_dropuser(){var b=document.getElementById("username").value;var c=b.split("@");if(window.confirm("Drop User:\n"+b+", Please Confirm?")){var a="/tmworks/rview?requestID=dbaction2&scriptContent="+encodeURIComponent("DROP USER '"+c[0]+"'@'"+c[1]+"'");dba_common_response(a)}}function dba_mysql_commonalert(b){if(window.confirm(b)){var a="/tmworks/rview?requestID=dbaction2&scriptContent="+encodeURIComponent(document.getElementById("scriptContent2").value);dba_common_response(a)}}function dba_mysql_getcreatetable(){var b=document.getElementById("tablename").value;var a="/tmworks/rview?requestID=datagetter&actionName=dba_mysql_getcreatetable&param1="+b;ajaxRequest(a,function(){if(req.readyState==4){if(req.status==200){document.getElementById("scriptContent2").value=req.responseText}}})}function dba_mysql_getcreateview(){var a=document.getElementById("viewname").value;var b="/tmworks/rview?requestID=datagetter&actionName=dba_mysql_getcreateview&param1="+a;ajaxRequest(b,function(){if(req.readyState==4){if(req.status==200){document.getElementById("scriptContent2").value=req.responseText}}})}function dba_mysql_getcreateprocedure(){var b=document.getElementById("procedurename").value;var a="/tmworks/rview?requestID=datagetter&actionName=dba_mysql_getcreateprocedure&param1="+b;ajaxRequest(a,function(){if(req.readyState==4){if(req.status==200){document.getElementById("scriptContent2").value=req.responseText}}})}function dba_mysql_getcreatefunction(){var b=document.getElementById("functionname").value;var a="/tmworks/rview?requestID=datagetter&actionName=dba_mysql_getcreatefunction&param1="+b;ajaxRequest(a,function(){if(req.readyState==4){if(req.status==200){document.getElementById("scriptContent2").value=req.responseText}}})}function dba_mysql_gettableindex(){var b=document.getElementById("tablename").value;var a="/tmworks/rview?requestID=datagetter&actionName=dba_mysql_gettableindex&param1="+b;ajaxRequest(a,function(){if(req.readyState==4){if(req.status==200){var d=document.getElementById("indexname");d.options.length=0;var e=req.responseText;var g=e.split(";");for(var c=0;c<g.length;c++){var f=new Option(g[c],g[c]);d.options[d.length]=f}}}})}function dba_getcolumnsforcreateindex(){var b=document.getElementById("tablename").value;var a="/tmworks/rview?requestID=datagetter&actionName=dba_getcolumnsforcreateindex&param1="+b;ajaxRequest(a,function(){if(req.readyState==4){if(req.status==200){var c=document.getElementById("columnset");var f=c.rows.length-2;for(var e=0;e<f;e++){deleteColumn()}var d=c.rows[1].cells[1].firstChild;d.options.length=0;var g=req.responseText;var k=g.split(";");for(var e=0;e<k.length;e++){var h=new Option(k[e],k[e]);d.options[d.length]=h}}}})}function dba_common_response(a){ajaxRequest(a,function(){if(req.readyState==4){if(req.status==200){var b=document.getElementById("error");b.style.display="block";b.innerHTML=req.responseText+"<img src='"+STATIC_URL+"/img/close.gif' onclick='javascript:hideElement(\"error\")' style='float:right;cursor:pointer'/>"}}})}function dba_mysql_checkallprivilege(){var c=document.getElementById("fieldset_privileges");var b=c.getElementsByTagName("input");for(var a=0;a<b.length;a++){b[a].checked=true}}function dba_mysql_uncheckallprivilege(){var c=document.getElementById("fieldset_privileges");var b=c.getElementsByTagName("input");for(var a=0;a<b.length;a++){b[a].checked=false}}function addColumn(){var c=document.getElementById("columnset");var b=c.rows[c.rows.length-1];var a=b.cloneNode(true);var d=document.getElementById("columnsetbody");d.appendChild(a);a.cells[0].innerHTML=c.rows.length-1;if(c.rows.length%2==0){a.className="odd"}else{a.className="even"}}function deleteColumn(){var a=document.getElementById("columnset");if(a.rows.length<3){return}a.deleteRow(a.rows.length-1)}function applyEvent(g,f,l){var h="on"+f;if(g.addEventListener){g.addEventListener(f,l,false)}else{if(g.attachEvent){g.attachEvent(h,l)}else{var k=g[h];g[h]=function(){var b=k.apply(this,arguments),a=l.apply(this,arguments);return b==undefined?a:(a==undefined?b:a&&b)}}}}function getTipList(c,a,b){var d="/tmworks/rview?requestID=tip&tipType="+a+"&param="+b;ajaxRequest(d,function(){if(req.readyState==4){if(req.status==200){var k=document.getElementById("autoComp");k.innerHTML=req.responseText;var h=document.getElementById("autoCompTable");var l=document.getElementById(c);var g=l.offsetLeft;var f=l.offsetTop+21;while(l=l.offsetParent){g+=l.offsetLeft;f+=l.offsetTop}h.style.left=g+"px";h.style.top=f+"px";k.style.display=""}}})}function selectTipItem(b,a){document.getElementById(b).value=a}function closeTip(){var a=document.getElementById("autoComp");if(a){a.style.display="none"}}function showTipList(d,a){var b=d.keyCode?d.keyCode:d.charCode;if(b==null){return true}var c=document.getElementById("autoCompTable");if(c.rows.length>0){if(b==27){while(c.rows.length>0){c.deleteRow(0)}return false}else{if((b==13&&!d.shiftKey)||(b==9&&!d.shiftKey)){if(c.rows.length>selectedRow){var e=c.rows[selectedRow];document.getElementById(a).value=e.cells[0].innerHTML;highlightRow(selectedRow);document.getElementById("autoComp").style.display="none";return false}}else{if(b==38&&!d.shiftKey){if(c.rows.length>selectedRow){selectedRow=selectedRow<=0?c.rows.length-1:selectedRow-1;highlightRow(selectedRow)}return false}else{if(b==40&&!d.shiftKey){if(c.rows.length>selectedRow){selectedRow=selectedRow>=c.rows.length-1?0:selectedRow+1;highlightRow(selectedRow)}return false}}}}return true}}function getSumary(b,a){if(b.length<=a){return b}return b.substring(0,a)+"..."}function dba_sqlserver_createtable(){var k=document.getElementById("tablename").value;var e=document.mainForm2.schema.options[document.mainForm2.schema.selectedIndex].text;var l=document.getElementById("tablecomment").value;var b=document.getElementById("columnset");var o="";var c="CREATE TABLE ["+e+"].["+k+"] (";var s=0;for(var g=1;g<b.rows.length;g++){var a=b.rows[g].cells[1].firstChild.value;if(a==""){continue}if(s!=0){c+=","}s=1;var f=b.rows[g].cells[3].firstChild.value;c+="["+a+"] "+f;var d=b.rows[g].cells[4].firstChild.value;var h=b.rows[g].cells[5].firstChild.value;var r=b.rows[g].cells[6].firstChild.value;var q=b.rows[g].cells[7].firstChild.value;if(d!=""){if(h!=""){c+="("+d+","+h+") "}else{c+="("+d+") "}}var n=b.rows[g].cells[2].getElementsByTagName("input");if(n[0].checked){c+=" NOT NULL "}if(r!=""){c+=" DEFAULT "+r+" "}if(n[1].checked){c+=" UNIQUE "}if(n[2].checked){if(o==""){o+="["+a+"]"}else{o+=",["+a+"]"}}}if(o!=""){c+=",PRIMARY KEY CLUSTERED ("+o+")"}c+=")";if(window.confirm("Create Table:\n"+c+", Please Confirm?")){var m="/tmworks/rview?requestID=dbaction2&scriptContent="+encodeURIComponent(c);dba_common_response(m)}}function dba_sqlserver_emptytable(){var b=document.mainForm2.tablename.options[document.mainForm2.tablename.selectedIndex].text;document.mainForm2.scriptContent.value="DELETE FROM "+b;if(window.confirm("Empty Table:\n"+stmt+", Please Confirm?")){var a="/tmworks/rview?requestID=dbaction2&scriptContent="+encodeURIComponent(document.mainForm2.scriptContent.value);dba_common_response(a)}}function getHTMLByURL(a,b){setBusy();ajaxRequest(a,function(){if(req.readyState==4){if(req.status==200){setBusy(false);document.getElementById(b).innerHTML=req.responseText}}})}function qb_copyNewCondition(a){var c=a.parentNode;var e=a.cloneNode(true);insertAfter(e,a);for(var b=1;b<c.rows.length;b++){var d=c.rows[b];d.cells[1].firstChild.id="con_key"+b;d.cells[3].firstChild.id="con_value"+b}tb_init("a.thickbox, area.thickbox, input.thickbox")}function qb_delCondition(a){var c=a.parentNode;if(c.rows.length<3){a.cells[1].firstChild.value="";a.cells[3].firstChild.value="";return}c.removeChild(a);for(var b=1;b<c.rows.length;b++){var d=c.rows[b];d.cells[1].firstChild.id="con_key"+b;d.cells[3].firstChild.id="con_value"+b}tb_init("a.thickbox, area.thickbox, input.thickbox")}function qb_copyNewSort(a){var c=a.parentNode;var e=a.cloneNode(true);insertAfter(e,a);for(var b=1;b<c.rows.length;b++){var d=c.rows[b];d.cells[1].firstChild.id="sort_key"+b}}function qb_delSort(a){var c=a.parentNode;if(c.rows.length<3){a.cells[1].firstChild.value="";return}c.removeChild(a);for(var b=1;b<c.rows.length;b++){var d=c.rows[b];d.cells[1].firstChild.id="sort_key"+b}}function insertAfter(c,a){var b=a.parentNode;if(b.lastchild==a){b.appendChild(c)}else{b.insertBefore(c,a.nextSibling)}}function qb_genSQL_renew_value(a){if(!a){return""}if(a.indexOf("${")>=0||a.indexOf("*{")>=0||a.indexOf("@{")>=0||a.indexOf(".")>0){return a}return"'"+a+"'"}function qb_genSQLWithLinks(){qb_links_clone=qb_links.clone();var I=document.getElementById("conditions");var n=document.getElementById("columnconditions");var y=document.getElementById("sortcolumns");var d=document.getElementById("uniquerecords").checked?"DISTINCT":"";var m="";var v=new Array();var h=new Array();var H="SELECT "+d+" \n";var e=I.rows.length;if(e==1){H+="  *\n"}for(var G=1;G<e;G++){var k=I.rows[G];var f=k.cells[1].innerHTML;var B=k.cells[2].firstChild.value;var u=k.cells[3].firstChild;var z=u.options[u.selectedIndex].value;var K=f.substring(0,f.lastIndexOf("."));if(!v[K]){v[K]=K;h.push(K)}if(k.cells[4].firstChild.checked){m+=f+","}if(z!=""){f=z+f+")"}if(B==""){H+="  "+f}else{H+="  "+f+" AS "+B}if(G==e-1){H+="\n"}else{H+=",\n"}}H+="FROM\n";var t=new Hash();while(qb_links_clone.length>0){var l=qb_links_clone[0];var c=l.field1.id;var a=l.field2.id;var s=c.substring(0,c.lastIndexOf("."));var r=a.substring(0,a.lastIndexOf("."));var F=l.condition;t.set(s,getTableLinks(s))}var b=t.keys();H+="  "+b[0]+"\n";H+=t.get(b[0]);for(var G=1;G<b.length;G++){H+=t.get(b[G])}var A="";e=n.rows.length;for(var G=1;G<e;G++){var k=n.rows[G];var L=k.cells[1].firstChild.value;var J=k.cells[2].firstChild;var o=J.options[J.selectedIndex].value;var C=k.cells[3].firstChild.value;if(L==""||o=="ignore"){continue}var x=k.cells[4].firstChild.options[k.cells[4].firstChild.selectedIndex].value;switch(o){case"=":case">=":case"<":case"<=":case"<>":A+="  "+L+" "+o+" "+qb_genSQL_renew_value(C)+"";break;case"like":case"not like":A+="  "+L+" "+o+" '%"+C+"%'";break;case"in":case"not in":var q=C.split(",");if(q.length>0){A+="  "+L+" "+o+"(";A+="'"+q[0]+"'";for(var E=1;E<q.length;E++){A+=", '"+q[E]+"'"}A+=")"}break;case"between":case"not between":var q=C.split(",");if(q.length==2){A+="  "+L+" "+o+" '"+q[0]+"' and '"+q[1]+"'"}break;case"is null":case"is not null":A+="  "+L+" "+o;break;default:break}if(G==e-1){A+="\n"}else{A+=" "+x+"\n"}}if(A!=""){H+="WHERE\n"+A}if(m!=""){H+="GROUP BY\n";H+="  "+m.substring(0,m.length-1)+"\n"}var g="";e=y.rows.length;for(var G=1;G<e;G++){var k=y.rows[G];var D=k.cells[1].firstChild.value;if(D==""){continue}var w=k.cells[2].firstChild.options[k.cells[2].firstChild.selectedIndex].value;g+="  "+D+" "+w;if(G==e-1){g+="\n"}else{g+=",\n"}}if(g!=""){H+="ORDER BY\n"+g}if(codepress){codepress.setCode(H)}else{document.getElementById("QUERYTEXT").value=H}}function qb_genSQL(){if(qb_links!=null&&qb_links.length>0){qb_genSQLWithLinks();return}var B=document.getElementById("conditions");var h=document.getElementById("columnconditions");var s=document.getElementById("sortcolumns");var a=document.getElementById("uniquerecords").checked?"DISTINCT":"";var g="";var o=new Array();var e=new Array();var A="SELECT "+a+" \n";var b=B.rows.length;if(b==1){A+="  *\n"}for(var z=1;z<b;z++){var f=B.rows[z];var c=f.cells[1].innerHTML;var v=f.cells[2].firstChild.value;var m=f.cells[3].firstChild;var t=m.options[m.selectedIndex].value;var D=c.substring(0,c.lastIndexOf("."));var n=c.substring(c.lastIndexOf(".")+1,c.length);c="`"+D+"`.`"+n+"`";if(!o[D]){o[D]=D;e.push(D)}if(f.cells[4].firstChild.checked){g+=c+","}if(t!=""){c=t+c+")"}if(v==""){A+="  "+c}else{A+="  "+c+" AS "+v}if(z==b-1){A+="\n"}else{A+=",\n"}}A+="FROM\n";if(e.length>0){for(var z=0;z<e.length-1;z++){A+="  "+renewViewName(e[z])+",\n"}A+="  "+renewViewName(e[e.length-1])+"\n";var u="";b=h.rows.length;for(var z=1;z<b;z++){var f=h.rows[z];var E=f.cells[1].firstChild.value;var C=f.cells[2].firstChild;var k=C.options[C.selectedIndex].value;var w=f.cells[3].firstChild.value;if(E==""||k=="ignore"){continue}var r=f.cells[4].firstChild.options[f.cells[4].firstChild.selectedIndex].value;switch(k){case"=":case">=":case"<":case"<=":case"<>":u+="  "+E+" "+k+" "+qb_genSQL_renew_value(w)+"";break;case"like":case"not like":u+="  "+E+" "+k+" '%"+w+"%'";break;case"in":case"not in":var l=w.split(",");if(l.length>0){u+="  "+E+" "+k+"(";u+="'"+l[0]+"'";for(var y=1;y<l.length;y++){u+=", '"+l[y]+"'"}u+=")"}break;case"between":case"not between":var l=w.split(",");if(l.length==2){u+="  "+E+" "+k+" '"+l[0]+"' and '"+l[1]+"'"}break;case"is null":case"is not null":u+="  "+E+" "+k;break;default:break}if(z==b-1){u+="\n"}else{u+=" "+r+"\n"}}if(u!=""){A+="WHERE\n"+u}if(g!=""){A+="GROUP BY\n";A+="  "+g.substring(0,g.length-1)+"\n"}var d="";b=s.rows.length;for(var z=1;z<b;z++){var f=s.rows[z];var x=f.cells[1].firstChild.value;if(x==""){continue}var q=f.cells[2].firstChild.options[f.cells[2].firstChild.selectedIndex].value;d+="  "+x+" "+q;if(z==b-1){d+="\n"}else{d+=",\n"}}if(d!=""){A+="ORDER BY\n"+d}}else{A=""}if(codepress){codepress.setCode(A)}else{document.getElementById("QUERYTEXT").value=A}}function renewViewName(b){if(b&&b.indexOf(" ")!=-1&&b.indexOf('"')==-1){var c="";var a=b.lastIndexOf(".");if(a==-1){c="`"+b+"`"}else{c=b.substring(0,a+1)+"`"+b.substring(a+1)+"`"}return c}return b}function qb_getResult(){var a=document.getElementById("conditions");if(a.rows.length<2){document.getElementById("queryResults").innerHTML="<p/>No column available, please click a table and choose some columns first.";return}positioncenter($("loading").show());qb_genSQL();var c=codepress?codepress.getCode():document.getElementById("QUERYTEXT").value;var b=new Ajax.Request(ROOT_URL+"?c=qb&m=getresult",{method:"post",parameters:"sql="+encodeURIComponent(c),onComplete:function(d){document.getElementById("queryResults").innerHTML=d.responseText;$("loading").hide()}})}function qb_switchCheckAllColumns(d){var c=d.checked;var b=d.parentNode.parentNode.parentNode;var f=b.rows.length;for(var a=1;a<f;a++){var e=b.rows[a].cells[0].firstChild;if(e.checked!=c){e.checked=c;e.onclick()}}}function getRepTypeImg(){var a=document.getElementById("repType");document.getElementById("img_rep").src=STATIC_URL+"/img/charts/"+a.options[a.selectedIndex].value+".jpg";getChartDSHelp()}function selectTableasTemplate(){var ele=document.getElementById("alltablelist");var tableid=ele.options[ele.selectedIndex].value;var gen_forceuse=new Array();var gen_forcefield=new Array();var gen_forcetype=new Array();$j(".gen_forceuse").each(function(){if(this.checked){gen_forceuse.push("gen_forceuse[]=1")}else{gen_forceuse.push("gen_forceuse[]=0")}});$j(".gen_forcefield").each(function(){gen_forcefield.push("gen_forcefield[]="+this.value)});$j(".gen_forcetype").each(function(){gen_forcetype.push("gen_forcetype[]="+this.value)});var force=gen_forceuse.join("&")+"&"+gen_forcefield.join("&")+"&"+gen_forcetype.join("&");var params="formName="+tableid+"&"+force;var url=ROOT_URL+"?c=form&m=tableastemplate";loadon();new Ajax.Request(url,{parameters:params,method:"post",onComplete:function(req){closeDialog();var txt=req.responseText;var start=txt.indexOf("<attachment>");var end=txt.indexOf("</attachment>");var html=txt.substring(0,start);var data=eval("("+txt.substring(start+12,end)+")");formprop[0]=data.formID;formprop[1]=data.formName;formprop[2]=data.formDescription;docid("fname").innerHTML=data.formName+"<span id='formsaved' style='color:red;vertical-align:middle;'></span>";html="<table id='MainContent' width='99%' height='90%' align='center' cellpadding='0' cellspacing='0'  border='0'>"+html+"</table>";var createdDiv=document.createElement("div");createdDiv.innerHTML=html;document.getElementById("MainContent").parentNode.replaceChild(createdDiv.childNodes[0],document.getElementById("MainContent"));MainContent=new GridCustomize("MainContent");MainContent.regEventByClass("div","field-outer-container");currOrd=getCurrentOrder();loadoff()}})}function selectForm(formid){closeDialog();loadon();if(formid==undefined||formid==null){var ele=document.getElementById("allformlist");formid=ele.options[ele.selectedIndex].value}new Ajax.Request(ROOT_URL+"?c=req",{method:"post",parameters:{requestID:"getform",formID:formid},onComplete:function(ajax){var txt=ajax.responseText;var start=txt.indexOf("<attachment>");var end=txt.indexOf("</attachment>");if(start!=-1&&end!=-1){var html=txt.substring(0,start);var data=eval("("+txt.substring(start+12,end)+")");formprop[0]=data.formID;formprop[1]=data.formName;formprop[2]=data.formDescription;formprop[3]=data.formLoadAction;docid("fname").innerHTML=data.formName+"<span id='formsaved' style='color:red;vertical-align:middle;'></span>";html="<table id='MainContent' width='99%' height='90%' align='center' cellpadding='0' cellspacing='0'  border='0'>"+html+"</table>";var createdDiv=document.createElement("div");createdDiv.innerHTML=html;document.getElementById("MainContent").parentNode.replaceChild(createdDiv.childNodes[0],document.getElementById("MainContent"))}MainContent=new GridCustomize("MainContent");MainContent.regEventByClass("div","field-outer-container");currOrd=getCurrentOrder();loadoff()}})}function deleteForm(e){var d="";if(e==0&&docid("allformlist").selectedIndex>=0){d=docid("allformlist").options[docid("allformlist").selectedIndex].value}if(d==""){return}if(confirm("the selected form data will be lost, are you sure?")){var a=ROOT_URL+"?c=form&m=delform&formid="+d+"&t="+b;var b=(new Date()).getTime();var c=document.getElementById("allformlist");setSelectByAjax(a,c)}}function deleteQuery(){var c="";if(docid("allqblistd").selectedIndex>=0){c=docid("allqblistd").options[docid("allqblistd").selectedIndex].value}if(c==""){return}if(confirm("the selected query data will be lost, are you sure?")){var a="/tmworks/rview?requestID=delquery&qbID="+c;var b=document.getElementById("allqblistd");setSelectByAjax(a,b)}}function appendCat(){var b=document.getElementById("catbody");if(document.getElementById("norowtip")){b.deleteRow(0);c=0}if(b.rows.length>0){if(b.rows[b.rows.length-1].cells[1].firstChild.type=="text"){return}}var c=b.rows.length;var d=document.getElementById("clone");var a=d.cloneNode(true);if(c%2==0){a.className="odd"}else{a.className="even"}b.appendChild(a)}function newCat(d){var a=d.cells[1].firstChild.value;var c=d.cells[2].firstChild.value;if(a==""||c==""){alert("Please input the catalog's name and description");return}var b="/tmworks/rview?requestID=updatecat&param=0&catName="+a+"&catDescription="+c;ajaxRequest(b,function(){if(req.readyState==4){if(req.status==200){document.getElementById("catdiv").innerHTML=req.responseText}}})}function delCat(b){var a="/tmworks/rview?requestID=updatecat&param=2&catID="+b;ajaxRequest(a,function(){if(req.readyState==4){if(req.status==200){document.getElementById("catdiv").innerHTML=req.responseText}}})}function uv_operate(d){setBusy();var g=document.getElementById("viewName").value;var f=encodeURIComponent(document.getElementById("viewDescription").value);var e=document.getElementById("formID").options[document.getElementById("formID").selectedIndex].value;var a=encodeURIComponent(codepress?codepress.getCode():document.getElementById("sqlContent").value);var c=document.getElementById("catID").options[document.getElementById("catID").selectedIndex].value;var b="/tmworks/rview?requestID="+d+"&viewName="+g+"&viewDescription="+f+"&formID="+e+"&sqlContent="+a+"&catID="+c;if(d=="edituserview2"){b+="&viewID="+document.getElementById("viewID").value}ajaxRequest(b,function(){if(req.readyState==4){if(req.status==200){var h=document.getElementById("error");h.style.display="block";h.innerHTML=req.responseText+"<img src='"+STATIC_URL+"/img/close.gif' onclick='javascript:hideElement(\"error\")' style='float:right;cursor:pointer'>";setBusy(false);document.body.scrollTop=0}}})}function createUV(){uv_operate("newuserview2")}function confirmUV(){uv_operate("confirmUV")}function updateUV(){uv_operate("edituserview2")}function op_operate(d){setBusy();var e=document.getElementById("opName").value;var g=encodeURIComponent(document.getElementById("opDescription").value);var c=document.getElementById("formID").options[document.getElementById("formID").selectedIndex].value;var a=encodeURIComponent(codepress?codepress.getCode():document.getElementById("sqlContent").value);var k=encodeURIComponent(document.getElementById("opTip").value);var h=document.getElementById("catID").options[document.getElementById("catID").selectedIndex].value;var f=document.getElementById("pageFlow").options[document.getElementById("pageFlow").selectedIndex].value;var b="/tmworks/rview?requestID="+d+"&opName="+e+"&opDescription="+g+"&formID="+c+"&sqlContent="+a+"&catID="+h+"&opTip="+k+"&pageFlow="+f;if(d=="updateop"){b+="&opID="+document.getElementById("opID").value}ajaxRequest(b,function(){if(req.readyState==4){if(req.status==200){var l=document.getElementById("error");l.style.display="block";l.innerHTML=req.responseText+"<img src='"+STATIC_URL+"/img/close.gif' onclick='javascript:hideElement(\"error\")' style='float:right;cursor:pointer'>";setBusy(false);document.body.scrollTop=0}}})}function createOP(){op_operate("createop")}function confirmOP(){op_operate("confirmOP")}function updateOP(){op_operate("updateop")}function qr_operate(f){setBusy();var a=document.getElementById("monName").value;var g=encodeURIComponent(document.getElementById("monDescription").value);var b=encodeURIComponent(codepress?codepress.getCode():document.getElementById("sqlContent").value);var e=document.getElementById("catID").options[document.getElementById("catID").selectedIndex].value;var d=document.getElementById("monType").value;var c="/tmworks/rview?requestID="+f+"&monName="+a+"&monDescription="+g+"&sqlContent="+b+"&catID="+e+"&monType="+d;if(f=="updatemon"){c+="&monID="+document.getElementById("monID").value}ajaxRequest(c,function(){if(req.readyState==4){if(req.status==200){var h=document.getElementById("error");h.style.display="block";h.innerHTML=req.responseText+"<img src='"+STATIC_URL+"/img/close.gif' onclick='javascript:hideElement(\"error\")' style='float:right;cursor:pointer'>";setBusy(false);document.body.scrollTop=0}}})}function createMON(){qr_operate("createmon")}function confirmMON(){qr_operate("confirmmon")}function updateMON(){qr_operate("updatemon")}function rp_operate(g){setBusy();var c=document.getElementById("repName").value;var d=encodeURIComponent(document.getElementById("repDescription").value);var f=encodeURIComponent(codepress?codepress.getCode():document.getElementById("sqlContent").value);var e=document.getElementById("repType").options[document.getElementById("repType").selectedIndex].value;var h=document.getElementById("formID").options[document.getElementById("formID").selectedIndex].value;var b=document.getElementById("catID").options[document.getElementById("catID").selectedIndex].value;var a="/tmworks/rview?requestID="+g+"&repName="+c+"&repDescription="+d+"&repDetail="+f+"&catID="+b+"&repType="+e+"&formID="+h;if(g=="updaterep"){a+="&repID="+document.getElementById("repID").value}ajaxRequest(a,function(){if(req.readyState==4){if(req.status==200){var k=document.getElementById("error");k.style.display="block";k.innerHTML=req.responseText+"<img src='"+STATIC_URL+"/img/close.gif' onclick='javascript:hideElement(\"error\")' style='float:right;cursor:pointer'>";setBusy(false);document.body.scrollTop=0;setBusy(false)}}})}function createREP(){rp_operate("createrep")}function confirmREP(){rp_operate("confirmrep")}function updateREP(){rp_operate("updaterep")}function getSqlContent(){var b=document.getElementById("query");var c=b.options[b.selectedIndex].value;if(c==""){return}var a="/tmworks/rview?requestID=getreptypeimg&param1="+c+"&param2=getsqlcontent";ajaxRequest(a,function(){if(req.readyState==4){if(req.status==200){if(codepress){codepress.setCode(req.responseText)}else{document.getElementById("sqlContent").value=req.responseText}}}})}function setCodePress(b,a){if(codepress){codepress.setCode(a)}else{document.getElementById(b).value=a}}function setFormHideElementValue_CD(b,a){if(b.eleId){b.eleId.value=codepress?codepress.getCode():document.getElementById(id).value}else{var c=document.createElement("input");c.type="hidden";c.name=a;c.value=codepress?codepress.getCode():document.getElementById(id).value;b.appendChild(c)}}function getFormVar(c){var d="";if(c==undefined||c==null){var b=document.getElementById("formid");d=b.options[b.selectedIndex].value;if(d==""){return}}else{d=c}var a=$("cklist_formvars");if(d==-1){if(a){$("cklist_formvars").update("");$j("#td_formvars").fadeOut("fast")}else{$("formvar").update('<font color="blue">No variables you can used in your query sql without a search form.</font>')}return}$j.getJSON(ROOT_URL+"?c=form&m=getformvar",{formid:d},function(h){var g="";var e=new Array();for(var f=0;f<h.length;f++){if(f%2==0){g+='<li class="alt" ><label for="a'+f+'" onclick="javascript:copyVariable(this);">'+h[f]+"</label></li>"}else{g+='<li><label for="a'+f+'" onclick="javascript:copyVariable(this);">'+h[f]+"</label></li>"}e.push(h[f])}fromvarlist=e.join(";");if(a){a.update(g);if(h.length>0){$j("#td_formvars").fadeIn("fast")}else{$j("#td_formvars").fadeOut("fast")}}else{$("formvar").update(fromvarlist)}})}function getChartDSHelp(){var b=document.getElementById("repType");var a=b.options[b.selectedIndex].value;if(a==""){return}new Ajax.Request(ROOT_URL+"?c=help&m=chartsql",{method:"post",parameters:{param1:a},onSuccess:function(c){document.getElementById("charthelp").innerHTML=c.responseText}})}function insertnew(){_get_message_form("insertnew2")}function createsupport(){_get_message_form("createsupport")}function updatesupport(){_get_message_form("updatesupport")}function _get_message_form(a){document.mainForm.requestID.value=a;$("mainForm").request({onComplete:function(c){var b=document.getElementById("error");b.style.display="block";b.innerHTML=c.responseText+"<img src='"+STATIC_URL+"/img/close.gif' onclick='javascript:hideElement(\"error\")' style='float:right;cursor:pointer'>";document.body.scrollTop=0;$("mainForm").enable();setBusy(false)}});$("mainForm").disable()}function createuser(){_get_message_form("createuser")}function testconn(){setBusy();_get_message_form("testconn")}function createconn(){_get_message_form("createconn")}function editconn(){_get_message_form("editconn")}function uv_search(b){b=!b?1:b;if(!checkFormInput()){return}setBusy();$("searchResultDiv").update("<div align='center'><img src='"+STATIC_URL+"/img/loading_b.gif' alt='Fetching result set...' title = 'Fetching result set...'/></div>");var a=$j("#mainForm").serialize();a+="&pageNo="+b;new Ajax.Request(ROOT_URL+"?c=app",{method:"post",parameters:a,onComplete:function(c){$("searchResultDiv").update(c.responseText);$j("#searchResultDiv").fadeIn("fast");setBusy(false)}})}function cp_search(){setBusy();$("dowhat").value="searchform";$("searchResultDiv").update("<div align='center'><img src='"+STATIC_URL+"/img/loading_b.gif' alt='Fetching resultset checkpoints...' title = 'Fetching resultset checkpoints...'/></div>");var a=$("mainForm").serialize();$("dowhat").value="";a+="&paramskeysrc="+encodeURIComponent($("mainForm").serialize());new Ajax.Request(ROOT_URL+"?c=app",{method:"post",parameters:a,onComplete:function(b){$("searchResultDiv").update(b.responseText);$j("#searchResultDiv").fadeIn("fast");setBusy(false)}})}function save_checkpoint(){setBusy();$("dowhat").value="savecp";$("searchResultDiv").update("<div align='center'><img src='"+STATIC_URL+"/img/loading_b.gif' alt='Fetching resultset checkpoints...' title = 'Fetching resultset checkpoints...'/></div>");var a=$("mainForm").serialize();$("dowhat").value="";a+="&paramskeysrc="+encodeURIComponent($("mainForm").serialize());new Ajax.Request(ROOT_URL+"?c=app",{method:"post",parameters:a,onComplete:function(b){$("searchResultDiv").update(b.responseText);$j("#searchResultDiv").fadeIn("fast");setBusy(false)}})}function delcheckpoint(b){setBusy();$("dowhat").value="delcp";$("searchResultDiv").update("<div align='center'><img src='"+STATIC_URL+"/img/loading_b.gif' alt='Fetching resultset checkpoints...' title = 'Fetching resultset checkpoints...'/></div>");var a=$("mainForm").serialize();$("dowhat").value="";a+="&paramskeysrc="+encodeURIComponent($("mainForm").serialize());a+="&cpid="+b;new Ajax.Request(ROOT_URL+"?c=app",{method:"post",parameters:a,onComplete:function(c){$("searchResultDiv").update(c.responseText);$j("#searchResultDiv").fadeIn("fast");setBusy(false)}})}var retryTimes=0;function sv_search(b){b=!b?1:b;setBusy();positioncenter($("loading").show());document.mainForm.pageNo.value=b;var a=$("mainForm").serialize();$j.getJSON(ROOT_URL+"?c=viewtable&m=search",a,function(c){$("loading").hide();if(c.banner){$("pagebanner").update(c.banner);$("te_container").update(c.datagrid);$j("#te_container").fadeIn("normal");lastSelRow_Ele=null;retryTimes=0}else{TmMsgBox.showError(c.error);if(++retryTimes<2){document.mainForm.orderColumnName.value="";sv_search(b)}}setBusy(false);tb_init("a.thickbox, area.thickbox, input.thickbox")})}function executeop1(){if(!checkFormInput()){return}setBusy();document.mainForm.action.value="submitform";ajaxPost(ROOT_URL+"?c=app",document.mainForm,function(){if(req.readyState==4){if(req.status==200){var a=false;var c=req.responseText;if(c.indexOf("[MSG]")==0){c=c.substring(5);a=true}if(document.mainForm.apptype.value=="2"){var b=document.getElementById("dataset");b.style.display="block";b.innerHTML=c}else{var b=document.getElementById("error");b.style.display="block";$(b).update(c)}setBusy(false)}}})}function exeop(){setBusy();document.mainForm.action.value="execute";ajaxPost(ROOT_URL+"?c=app",document.mainForm,function(){if(req.readyState==4){if(req.status==200){var a=document.getElementById("error");a.style.display="block";a.innerHTML=req.responseText+"<img src='"+STATIC_URL+"/img/close.gif' onclick='javascript:hideElement(\"error\")' style='float:right;cursor:pointer'>";setBusy(false)}}});closeDialog()}function closeDialog(){document.getElementById("moreFilterDialog").style.display="none"}var bIsCatchFlyBar=false;var dragClickX=0;var dragClickY=0;var movemovefun;function catchFlyBar(d,c){bIsCatchFlyBar=true;var b=document.getElementById(c);var a=(d.x?d.x:d.pageX)+document.body.scrollLeft;var f=(d.y?d.y:d.pageY)+document.body.scrollTop;dragClickX=a-parseInt(b.style.left);dragClickY=f-parseInt(b.style.top);applyEvent(document,"mousemove",movemovefun=function(h){var l=h.x?h.x:h.pageX;var k=h.y?h.y:h.pageY;if(bIsCatchFlyBar){var g=l+document.getElementsByTagName("body")[0].scrollLeft-dragClickX;var e=k+document.getElementsByTagName("body")[0].scrollTop-dragClickY;g=g<0?0:g;e=e<0?0:e;b.style.left=g;b.style.top=e}})}var lastFlyBarX;var lastFlyBarY;function releaseFlyBar(b){bIsCatchFlyBar=false;if(document.addEventListener){document.removeEventListener("mousemove",movemovefun,true)}else{document.detachEvent("onmousemove",movemovefun)}var a=b.target!=null?b.target:b.srcElement;lastFlyBarX=findPosX(a);lastFlyBarY=findPosY(a)}function ajaxPost(b,c,a){req=getXMLHTTPRequest();req.onreadystatechange=a;handleForm(req,b,c)}function handleForm(c,b,d){var a=getFormQS(d);a+="&t="+(new Date()).getTime();c.open("POST",b,true);c.setRequestHeader("Content-type","application/x-www-form-urlencoded;charset=UTF-8");c.setRequestHeader("Content-length",a.length);c.send(a)}function getFormQS(d){var a="";for(var f=0;f<d.elements.length;f++){if(document.all){var b=d.elements[f]}else{var b=d.elements.item(f)}switch(b.type){case"textarea":case"hidden":case"text":a+=b.name+"="+encodeURIComponent(b.value)+"&";break;case"select-one":if(b.selectedIndex!=-1){sv=b.options[b.selectedIndex].value;a+=b.name+"="+encodeURIComponent(sv)+"&"}break;case"select-multiple":ss="";for(var e=0;e<b.options.length;e++){if(b.options[e].selected==true){ss+=(ss=="")?"":"&";sv=b.options[e].value;ss+=b.name+"="+encodeURIComponent(sv)}}ss+=(ss=="")?"":"&";a+=ss;break;case"radio":case"checkbox":if(b.checked==true){a+=b.name+"="+encodeURIComponent(b.value)+"&"}break;default:a+=b.name+"="+encodeURIComponent(b.value)+"&"}}a=a.substr(0,(a.length-1));return a}function getChart(){if(!checkFormInput()){return}setBusy();ajaxPost("index.php?c=app",document.mainForm,function(){if(req.readyState==4){if(req.status==200){setBusy(false);$("chartdivp").update("<div id='chartdiv'>"+req.responseText+"</div>")}}})}function te_focusTd(b){var a=document.getElementById("focusDIV");var d=document.getElementById("te_container").scrollLeft;var c=document.getElementById("te_container").scrollTop;a.style.left=(findPosX(b)-d)+"px";focusDIV.style.top=(findPosY(b)-c)+"px";focusDIV.style.width=(b.offsetWidth-3)+"px";focusDIV.style.height=(b.offsetHeight-3)+"px";focusDIV.style.display="block"}var lastSelRow_Ele;function te_selRow(d,e){var f=d.ctrlKey;if(!f&&lastSelRow_Ele!=null&&lastSelRow_Ele!=e){lastSelRow_Ele.className="rowHead";var c=lastSelRow_Ele.nextSibling;do{c.className="dataCell"}while(c=c.nextSibling)}var a=document.getElementById("databody");lastSelRow_Ele=e;var b=e.className;if(b=="rowHead"){e.className="rowHead rowHeadFocus";var c=e.nextSibling;do{c.className="dataCell dataCellFocus"}while(c=c.nextSibling)}else{e.className="rowHead";var c=e.nextSibling;do{if(c==null||c==undefined||c.tagName!="TD"||a.rows[0].cells[c.cellIndex].className=="colHead colHeadFocus"){continue}c.className="dataCell"}while(c=c.nextSibling)}}function getLastSelectRowNo(){if(lastSelRow_Ele==undefined||lastSelRow_Ele==null||lastSelRow_Ele.className=="rowHead"){return -1}return lastSelRow_Ele.innerHTML.replace(/<\/?[^>]+>/gi,"")}function te_selColumn(f,g){var h=f.target!=null?f.target.tagName:f.srcElement.tagName;if(h!="TD"){return}var a=document.getElementById("databody");var c=g.className;var e="dataCell";if(c=="colHead"){g.className="colHead colHeadFocus";e="dataCell dataCellFocus"}else{g.className="colHead"}var b=g.cellIndex;for(var d=1;d<a.rows.length;d++){if(e=="dataCell"&&a.rows[d].cells[0].className=="rowHead rowHeadFocus"){continue}a.rows[d].cells[b].className=e}}function showcontextmenu(a){document.getElementById("contextmenu").style.display="block";document.getElementById("contextmenu").style.left=(findPosX(a)+5)+"px";document.getElementById("contextmenu").style.top=findPosY(a)+"px";return false}function hidecontextmenu(){document.getElementById("contextmenu").style.display="none"}function addCondition(){var d=document.getElementById("filter_body");var c=document.getElementById("filter_row0").cloneNode(true);var b=document.getElementById("filter_button");var a=$j(c).find(".config-textfield")[0];if(a){a.enable();a.value=""}d.insertBefore(c,b);tb_init("a.thickbox, area.thickbox, input.thickbox")}function delFilter(c){var b=document.getElementById("filter_body");if(b.rows.length<=2){$j(c.parentNode).find("select")[1].value="ignore";return}var a=c.parentNode.parentNode;b.removeChild(a)}function resetFilters(){var a=document.getElementById("filter_body");while(a.rows.length>2){a.deleteRow(a.rows.length-2)}$j(a.rows[0]).find("select")[1].value="ignore"}function alertArray(a){var c=a[0];for(var b=1;b<a.length;b++){c+=", "+a[b]}alert(c)}function freezeBackground(c){var b=document.createElement("DIV");b.id="FreezeLayer";b.className="freezeLayer";b.style.width="100%";b.style.height="100%";b.style.zIndex="900";if(!!(window.attachEvent&&!window.opera)){var a=document.createElement("iframe");a.src="javascript:void(0);";a.style.position="absolute";a.style.visibility="inherit";a.style.left=a.style.top="0px";a.style.width=a.style.height="100%";a.style.zIndex="-1";a.style.filter="progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)";b.appendChild(a)}if(c){b.innerHTML="<span><img src='"+STATIC_URL+"/img/loading_b.gif' title='Loading..., please wait.'/></span>"}document.body.appendChild(b)}function removeFreezeLoading(){if(document.getElementById("FreezeLayer")!=null){document.getElementById("FreezeLayer").innerHTML=""}}function unFreezeBackground(){if(document.getElementById("FreezeLayer")!=null){document.body.removeChild(document.getElementById("FreezeLayer"))}}function submitConn(d){var a=document.mainForm.allowedUsers_tmp.options;var c="";li=a.length-1;var b=0;for(i=0;i<li;i++){if(b==1){c+=","}c+=a[i].value;b=1}document.mainForm.allowedUsers.value=c;_get_message_form(d)}function fb_submitField(){if(!submitField()){return false}}function setChecked(a){a.parentNode.childNodes[0].checked=true}function setupCalendar(a){Calendar.setup({inputField:a,ifFormat:"%Y-%m-%d %H:%M:%S",showsTime:true,button:"c_"+a})}function setupCalendarFormat(b,a){if(a=="1"){a="%Y-%m-%d %H:%M:%S"}Calendar.setup({inputField:b,ifFormat:a,showsTime:true,button:"c_"+b})}function setupCalendar4(a){Calendar.setup({inputField:a,ifFormat:"%Y-%m-%d %H:%M:%S",showsTime:true,button:"b_"+a})}function setupCalendar2(a){Calendar.setup({inputField:a,ifFormat:"%Y-%m-%d %H:%M:%S",showsTime:true,button:a})}function setupCalendar3(a){Calendar.setup({inputField:a,ifFormat:"%Y-%m-%d %H:%M:%S",showsTime:true,electric:false,button:a})}function setSelectByAjax(url,ele,dKey,dValue){var selValue=ele.value;ajaxRequest(url,function(){if(req.readyState==4){if(req.status==200){ele.options.length=0;var obj=eval("("+req.responseText+")");if(obj.message){alert(obj.message);return}if(dKey!=undefined&&dValue!=undefined){ele.options[0]=new Option(dValue,dKey,true,selValue==dKey);for(var i=0;i<obj.length/2;i++){ele.options[i+1]=new Option(obj[i*2+1],obj[i*2],true,selValue==obj[i*2])}}else{for(var i=0;i<obj.length/2;i++){ele.options[i]=new Option(obj[i*2+1],obj[i*2],true,selValue==obj[i*2])}}}}})}function getFormList(c){var b=$(c);var a=ROOT_URL+"?c=form&m=getall";setSelectByAjax(a,b,"-1","not Required")}function getQueryList(c){var b=document.getElementById(c);var a="/tmworks/rview?requestID=showallquerys";setSelectByAjax(a,b,"-1","not Required")}function getCatalogList(d){var b=(new Date()).getTime();var c=document.getElementById(d);var a="/tmworks/rview?requestID=showallcats&timestamp="+b;setSelectByAjax(a,c,"-1","Default Catalog")}function refreshmenu(){parent.frames.menu.document.location.reload();setCookie("NavAccordion",parent.frames.menu.defaultNavAccordion.Accordion.elementsVisible.join("|"))}function feedback(){if(document.mainForm.content.value==""){alert("The message must be input.");return}_get_message_form("contact2")}function showRedirect(a,b){if(a==500){alert("Error Occured. We are sorry for the inconvenience. \n\nPlease try after some time or refresh the page and try again.");loadoff();return}alert(a+" : "+b);location.href="/tmworks/rview"}function copyurl(){document.getElementById("dburl").value=document.getElementById("l_dburl").firstChild.nodeValue}function checkVersion(){var a=new Ajax.Request("/tmworks/rview?requestID=checkversion",{method:"get",onComplete:function(b){if(b.responseText!=""){$(updatemsg).innerHTML=b.responseText}}})}function setBusy(a){if(!parent.frames||!parent.frames.bar||!parent.frames.bar.document.getElementById("busyflag")){return}if(a==undefined){a=true}if(a){parent.frames.bar.document.getElementById("busyflag").style.display=""}else{parent.frames.bar.document.getElementById("busyflag").style.display="none"}}function setReady(){setBusy(false)}function changepftip(){var c=document.getElementById("pageFlow");var b=document.getElementById("pageflowtip");var a=c.selectedIndex;if(a==0){b.innerHTML="Execute sql scripts with parameters of the form specified.";$("tiprow").show()}else{if(a==1){b.innerHTML="Get a updatable resultset with paremeters of the form specified.Click <a href='javascript:;' onclick='javascript:openQB(\"copyToEditor\");'>here</a> to open Query Builder.<br/><b>Please notice that your database may not support this by reason of JDBC limitation</b>.";$("tiprow").hide()}}}var lastOpenRowNo=-1;function op_editrow(b,a){if(document.getElementById("opupdateform_"+a)){removeOPEditRow(a);return}if(lastOpenRowNo!=-1){removeOPEditRow(lastOpenRowNo)}setBusy();document.getElementById("rowNo").value=a;ajaxPost(ROOT_URL+"?c=app&m=showrowdata",document.mainForm,function(){if(req.readyState==4){if(req.status==200){var k=document.getElementById("databody");var h=k.rows;var g=h.length;var f=-1;for(var e=0;e<g;e++){if(b==h[e]){f=e;break}}var d=k.insertRow(f+1);d.id="opupdateform_"+a;d.className="opupdateform";var c=d.insertCell(0);c.innerHTML=req.responseText;c.setAttribute("colSpan",k.rows[0].cells.length);lastOpenRowNo=a;setBusy(false)}}})}function op_updateform(a){setBusy();document.getElementById("rowNo").value=a;ajaxPost(ROOT_URL+"?c=app&m=opupdaterow",document.mainForm,function(){if(req.readyState==4){if(req.status==200){var b=document.getElementById("error");b.style.display="block";b.innerHTML=req.responseText+"<img src='"+STATIC_URL+"/img/close.gif' onclick='javascript:hideElement(\"error\")' style='float:right;cursor:pointer'>";setBusy(false);document.body.scrollTop=0;setBusy(false)}}})}function removeOPEditRow(b){var a=document.getElementById("opupdateform_"+b);if(a&&a.parentNode){a.parentNode.removeChild(a)}}function op_delrow(a){if(!confirm("The selected row data will be lost. Do you really want to do this?\nPress OK to delete or press Cancel to return back.")){return}setBusy();document.getElementById("rowNo").value=a;ajaxPost(ROOT_URL+"?c=app&m=opdelrow",document.mainForm,function(){if(req.readyState==4){if(req.status==200){var b=document.getElementById("error");b.style.display="block";b.innerHTML=req.responseText+"<img src='"+STATIC_URL+"/img/close.gif' onclick='javascript:hideElement(\"error\")' style='float:right;cursor:pointer'>";setBusy(false);document.body.scrollTop=0;setBusy(false)}}})}function registProduct(){if($(document.mainForm.registName).value.blank()||$(document.mainForm.registCompany).value.blank()||$(document.mainForm.licenseKey).value.blank()){alert("Please input the registName, registOrganization and the license key!\n\nThe software license certificate is sent by email to the address you provided \nwithin 24 hours (normally much faster), After the payment has been received.");return}ajaxPost(ROOT_URL,document.mainForm,function(){if(req.readyState==4){if(req.status==200){if(confirm(req.responseText)){if(window.opener){window.opener.location.reload(true);window.opener.close()}else{window.location=ROOT_URL}}}}})}function checkFormEffect(){if(docid("updatescriptenable").checked){docid("actionscripttdiv").style.display=""}else{docid("actionscripttdiv").style.display="none"}}function loadableFormInit(){var a=$("mainForm").getElements();a.each(function(c,b){if(a[b].readAttribute("disabledf")!="disabled"){a[b].enable()}else{a[b].disable()}})}var formIndex=0;var formDataArray=null;function effectForm(b){setBusy();var a=$("mainForm").serialize();a+="&sql="+encodeURIComponent(b);$("mainForm").disable();new Ajax.Request(ROOT_URL+"?c=form&m=effect",{method:"post",parameters:a,evalJSON:"force",onComplete:function(g){setBusy(false);loadableFormInit();var f=$H(g.responseJSON);var k=f.get("oak_form_warning");var e=$("oak_form_warning");if(k){e.parentNode.style.display="";e.update("<img src='"+STATIC_URL+"/img/form/close_hover.gif' width='12px' alt='close the tip layer' title='close the tip layer' height='12px' style='vertical-align:middle' onclick='javascript:this.parentNode.parentNode.style.display=\"none\";'/>&nbsp;"+k)}else{e.parentNode.style.display="none"}var c=$A(f.get("data"));formDataArray=c;formIndex=0;var l=$H(c[0]);l.each(function(d){if($(d.key)){$(d.key).value=d.value}})}})}function form_prev(){if(!formDataArray||formIndex==0){return}var a=$H(formDataArray[--formIndex]);a.each(function(b){if($(b.key)){$(b.key).value=b.value}});$("formIndex").update(formIndex+1)}function form_next(){if(!formDataArray||formIndex==formDataArray.size()-1){return}var a=$H(formDataArray[++formIndex]);a.each(function(b){if($(b.key)){$(b.key).value=b.value}});$("formIndex").update(formIndex+1)}function initFormLoadAction(a){effectForm(a)}function qb_tabToQueryText(b){var a=document.getElementById("conditions");html_TabClick(b,"queryText_table");if(a.rows.length>1){qb_genSQL()}else{if(codepress){codepress.setCode("No column available, please click a table and choose some columns first.")}}return false}function changepsd(){$("mainForm").request({onComplete:function(b){var a=document.getElementById("error");a.style.display="block";a.innerHTML=b.responseText+"<img src='"+STATIC_URL+"/img/close.gif' onclick='javascript:hideElement(\"error\")' style='float:right;cursor:pointer'>";setBusy(false);document.body.scrollTop=0}})}function reviewDBURL(){if($("connSource").value==DB_SQLSERVER){var b=$("dburl").value;var a=0;if((a=b.toLowerCase().indexOf("databasename="))>0){var c=b.indexOf(";",a);if(c>a+13){$("connName").value=b.substring(a+13,c)}else{$("connName").value=b.substring(a+13)}}}}function copyVariable(a){if(codepress){codepress.insertCode(a.innerHTML)}}function switchElement(a){var b=document.getElementById(a);if(b.style.display!="none"){b.style.display="none"}else{b.style.display=""}}function checkFormInput(){var e=$("mainForm");var b=true;var a=e.getInputs();var f="The form contains following errors for submitting:\n";for(var c=0;c<a.length;c++){var d=a[c].readAttribute("isreq");if(d&&d=="true"&&!a[c].present()){f+=a[c].readAttribute("name")+" must be filled out\n";b=false}}if(!b){alert(f)}return b}function field_setnull(a){var b=$(a).next();if(a.checked){a.value=b.value;b.value="(NULL)";b.setStyle({background:"grey"})}else{b.value=a.value;b.setStyle({background:"#FFFFFF"})}}function configFocusInput(){document.observe("dom:loaded",function(){var a=$("mainForm");var b=a.getElements();var c=true;b.each(function(e,d){if(b[d].className=="config-textfield"||b[d].className=="config-textarea"||b[d].className=="config-picklist"){b[d].observe("focus",function(){this.style.backgroundColor="lightyellow"});b[d].observe("blur",function(){this.style.backgroundColor="#FFFFFF"});if(c){b[d].focus();c=false}}else{if(b[d].className=="it1"){b[d].observe("focus",function(){this.className="it2"});b[d].observe("blur",function(){this.className="it1"});if(c){b[d].focus();c=false}}}})})}function _hack_ie_select(a){if(!!(window.attachEvent&&!window.opera)){a+="<iframe src='javascript:;' style='filter:progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0);position:absolute;visibility:inherit;width:100%;height:100%;left:0px;top:0px;z-index:-1'></iframe>"}return a}function js_show_tooltip(a){var b=$("tippanel");if(!b){b=$(document.createElement("DIV"));b.id="tippanel";document.body.appendChild(b);$(document).observe("click",function(d){b.hide()})}var c=$(a).cumulativeOffset();b.style.left=c.left+"px";b.style.top=(c.top+15)+"px";b.update(a.getAttribute("tooltip"));b.show()}function openHelpTip(b,a,d){var c=$("tippanel");if(!c){c=$(document.createElement("DIV"));c.id="tippanel";document.body.appendChild(c)}var e=$(b).cumulativeOffset();c.style.left=e.left+"px";c.style.top=(e.top+15)+"px";c.update(_hack_ie_select("<img src='"+STATIC_URL+"/img/loading_b.gif' align='center'/>"));c.show();new Ajax.Request(ROOT_URL+"?c=tip",{method:"get",parameters:{tipType:a,param:d},onSuccess:function(f){c.update(_hack_ie_select(f.responseText))}})}function openHelp(b,a){var c=$("tippanel");if(!c){c=$(document.createElement("DIV"));c.id="tippanel";document.body.appendChild(c)}var d=$(b).cumulativeOffset();c.style.left=d.left+"px";c.style.top=(d.top+15)+"px";c.update(a);c.show()}function closeHelpTip(){$("tippanel").hide()}function dupuserview(a){document.mainForm.requestID.value="dupuserview";document.mainForm.param1.value=a;document.mainForm.submit()}function dupop(a){document.mainForm.requestID.value="dupop";document.mainForm.param1.value=a;document.mainForm.submit()}function dupqr(a){document.mainForm.requestID.value="dupqr";document.mainForm.param1.value=a;document.mainForm.submit()}function duprp(a){document.mainForm.requestID.value="duprp";document.mainForm.param1.value=a;document.mainForm.submit()}function go(a){setBusy(true);document.menuform.requestID.value=a;document.menuform.submit()}function getInfoType(a){document.menuform.requestID.value="conninfo";document.menuform.infotype.value=a;document.menuform.submit()}function submitViewSearch(c,a,b){setBusy(true);document.menuform.requestID.value=c;document.menuform.viewID.value=a;if(b){document.menuform.viewName.value=b}document.menuform.submit()}function submitOp(b,a){document.menuform.requestID.value=b;document.menuform.opID.value=a;document.menuform.submit()}function submitMonitor(b,a){document.menuform.requestID.value=b;document.menuform.monID.value=a;document.menuform.submit()}function submitReport(a){document.menuform.requestID.value="viewreport";document.menuform.repID.value=a;document.menuform.submit()}var rq=new Array();var paramsArr=new Array();var lockstate=false;function handleRequest(m,k,a,h,g,d){if(lockstate==true){return}if(d){lockstate=true}if(h!=false&&h!="false"){loadon(h)}if(window.XMLHttpRequest){var c=getXmlObj();rt=rq.length;rq[rt]=c;var b=paramsArr.length;paramsArr[b]=a;rq[rt].onreadystatechange=new Function("if( rq["+rt+"].readyState == 4) { if(rq["+rt+"].status < 300 ) { loadoff();lockstate=false;"+k+"(rq["+rt+"].responseXML, paramsArr["+b+"]); } else {showRedirect(rq["+rt+"].status,rq["+rt+"].statusText);}}");if(g&&g!=null){handleForm(rq[rt],m,g)}else{rq[rt].open("GET",m,true);rq[rt].send(null)}return rq[rt]}if(!navigator.__ice_version&&window.ActiveXObject){try{var c=getXmlObj(g);rt=rq.length;rq[rt]=c;var b=paramsArr.length;paramsArr[b]=a;rq[rt].onreadystatechange=new Function("if( rq["+rt+"].readyState == 4) { var toSend = rq["+rt+"]; if(rq["+rt+"].responseXML) {toSend = rq["+rt+"].responseXML} if(rq["+rt+"].status >= 300){showRedirect(rq["+rt+"].status, rq["+rt+"].statusText);} else { loadoff();lockstate=false;"+k+"(toSend, paramsArr["+b+"]); }}");if(g&&g!=null){handleForm(rq[rt],m,g)}else{rq[rt].load(m)}return true}catch(l){alert(l)}}return false}function getXmlObj(b){var a=Try.these(function(){return new XMLHttpRequest()},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")})||false;return a}function getHtmlForForm(e,c,d,b,a,g){if(!d){d=""}return getHtml(e.action,c,d,b,e,a,g)}function getHtml(a,k,f,e,d,c,b){if(lockstate==true){return}if(c){lockstate=true}if(e!=false&&e!="false"){loadon(e)}if(b){a+=b}var h=null;if(window.XMLHttpRequest){h=getXmlObj(true)}else{if(!navigator.__ice_version&&window.ActiveXObject){h=getXmlObj(true)}else{return false}}rt=rq.length;rq[rt]=h;var g=paramsArr.length;paramsArr[g]=f;if(h){rq[rt].onreadystatechange=new Function(" if (rq["+rt+"].readyState==4) { if(rq["+rt+"].status < 300) {loadoff();lockstate=false;"+k+"(rq["+rt+"].responseText, paramsArr["+g+"]);  } else {showRedirect(rq["+rt+"].status,rq["+rt+"].statusText);}}");if(d&&d!=null){handleForm(rq[rt],a,d)}else{rq[rt].open("GET",a,true);rq[rt].setRequestHeader("Content-type","text/html");rq[rt].setRequestHeader("Content-length",0);rq[rt].send(null)}}return true}function viewOpener(){var a=window.open(ROOT_URL+"?c=codeeditor","","scrollbars=yes,menubar=no,height=600,width=800,resizable=yes,toolbar=no,location=no,status=no")}function checkNumberic(a){var b;b=window.event?a.keyCode:a.which;if(!(((b>=48)&&(b<=57))||(b==13)||(b==45)||(b==37)||(b==39)||(b==8))){return false}return true}function checkDecimal(a){var b;b=window.event?a.keyCode:a.which;if(!(((b>=48)&&(b<=57))||(b==13)||(b==46)||(b==45)||(b==37)||(b==39)||(b==8))){return false}return true}function confirmLink(d,b,c){var a=confirm("Do you really want to :\n"+b);if(a){if(typeof(d.href)!="undefined"){d.href+="&continue="+encodeURIComponent(c)}else{if(typeof(d.form)!="undefined"){d.form.action+="?is_js_confirmed=1"}}}return a}var marked_row=new Array;function markAllRows(e){var d=document.getElementById(e).getElementsByTagName("tr");var b;var c;for(var a=0;a<d.length;a++){c=d[a].getElementsByTagName("input")[0];if(c&&c.type=="checkbox"){b=c.name+c.value;if(c.disabled==false){c.checked=true;if(typeof(marked_row[b])=="undefined"||!marked_row[b]){d[a].className+=" marked";marked_row[b]=true}}}}return true}function setCheckboxes(d,c){var b=document.getElementById(d).getElementsByTagName("input");for(var a=0;a<b.length;a++){if(b[a].type=="checkbox"){b[a].checked=c}}return true}function unMarkAllRows(e){var d=document.getElementById(e).getElementsByTagName("tr");var b;var c;for(var a=0;a<d.length;a++){c=d[a].getElementsByTagName("input")[0];if(c&&c.type=="checkbox"){b=c.name+c.value;c.checked=false;d[a].className=d[a].className.replace(" marked","");marked_row[b]=false}}return true}function suggestPassword(a){var c="abcdefhjmnpqrstuvwxyz23456789ABCDEFGHJKLMNPQRSTUVWYXZ";var d=16;if(a){var b=a.generated_pw}else{var b=document.getElementById("generated_pw")}b.value="";for(i=0;i<d;i++){b.value+=c.charAt(Math.floor(Math.random()*c.length))}if(a){a.pma_pw.value=b.value;a.pma_pw2.value=b.value}else{document.getElementById("text_pma_pw").value=b.value;document.getElementById("text_pma_pw2").value=b.value}return true}function checkAddUser(a){if(a.elements.pred_hostname.value=="userdefined"&&a.elements.hostname.value==""){alert("Host is empty!");a.elements.hostname.focus();return false}if(a.elements.pred_username.value=="userdefined"&&a.elements.username.value==""){alert("Username is empty!");a.elements.username.focus();return false}return checkPassword(a)}function checkPassword(a){if(typeof(a.elements.nopass)!="undefined"&&a.elements.nopass[0].checked){return true}else{if(typeof(a.elements.pred_password)!="undefined"&&(a.elements.pred_password.value=="none"||a.elements.pred_password.value=="keep")){return true}}var c=a.elements.pma_pw;var d=a.elements.pma_pw2;var b=false;if(c.value==""){b="Password is empty!"}else{if(c.value!=d.value){b="Password not matched!"}}if(b){alert(b);c.value="";d.value="";c.focus();return false}return true}function checkTableEditForm(b,a){return true}function createdb(){$("mainForm").request({onComplete:function(c){var a=c.responseText;if(a.toString().search(/^-?[0-9]+$/)==0){var b=document.getElementById("error");b.style.display="block";document.switchform.dbid.value=a;b.innerHTML="Database created successfully, click <a href='javascript:document.switchform.submit()'>here</a> to switch to the new connection and create tables on it.";document.body.scrollTop=0;$("mainForm").enable()}else{var b=document.getElementById("error");b.style.display="block";b.innerHTML=c.responseText+"<img src='"+STATIC_URL+"/img/close.gif' onclick='javascript:hideElement(\"error\")' style='float:right;cursor:pointer'>";document.body.scrollTop=0;$("mainForm").enable()}setBusy(false)}});$("mainForm").disable()}function setSelectOptions(b,a,e){var f=document.forms[b].elements[a];var d=f.length;for(var c=0;c<d;c++){f.options[c].selected=e}return true}function syn_change_type(c,a){for(var b=1;b<7;b++){if(a){$(c+"tr"+b).hide()}else{$(c+"tr"+b).show()}}if(a){$(c+"tr7").show()}else{$(c+"tr7").hide()}}function advrep_addjoin(a){$j("#adv_rep_join_content").append($j("#span_advrep_join_tmp").html());$j(a).parent(".advrep_div").children(".sel_tbl").trigger("change")}function advrep_deljoin(a){$j(a).parent("div").remove()}function encodeDataXML(d){var g=["\\$","\\+"];var c=d.match(/=\s*\".*?\"/g);if(c){for(var e=0;e<c.length;e++){var h=c[e].replace(/^=\s*\"|\"$/g,"");h=h.replace(/\'/g,"%26apos;");var f=d.indexOf(c[e]);var a="='"+h+"'";var b=d.substring(0,f);var k=d.substring(f+c[e].length);var d=b+a+k}}d=d.replace(/\"/g,"%26quot;");d=d.replace(/%(?![\da-f]{2}|[\da-f]{4})/ig,"%25");d=d.replace(/\&/g,"%26");return d}function start_upgrade(c,b,a){$("alert_newversion_message").hide();$(c).show();$j.get(UPGRADE_URL,{v:b,t:a},function(d){$(c).update(d)})}if(window.attachEvent){window.attachEvent("onload",setReady)}else{if(navigator.userAgent.match(/AppleWebKit/)){window.addEventListener("load",setReady,false)}else{window.addEventListener("DOMContentLoaded",setReady,false)}};