TE={};TE.agent=navigator.userAgent.toLowerCase();TE.ie=((TE.agent.indexOf("msie")!=-1)&&(TE.agent.indexOf("opera")==-1));TE.first=true;TE.edit=function(a){if(typeof a=="string"){a=$(a)}if(this.el){this.el.innerHTML=this.document.body.innerHTML;this.el.style.display="block"}this.tec=this.tec||$("tec");this.te=this.te||$("te");this.tec.style.left=a.style.left;this.tec.style.top=a.style.top;this.tec.style.height=a.style.height;this.tec.style.width=a.style.width;this.te.style.height=(a.clientHeight-19)+"px";this.te.style.width=(a.clientWidth)+"px";this.tec.style.display="block";a.style.display="none";this.te.contentWindow.document.designMode="on";this.document=this.te.contentWindow.document;if(this.first){addEvents(this.document,["keydown","keypress","mousedown","mouseup","drag"],function(b){return TE.event(b||window.te.event)});this.first=false}TE.setContent(a.innerHTML);this.el=a};TE.setContent=function(a){this.document.body.innerHTML="";if(a!=""){this.document.body.innerHTML=this.document.body.contentEditable?"<div id='ted'>"+a+"</div>":a}this.te.contentWindow.focus()};TE.event=function(c){try{if(this.tecm){this.tecm.style.display="none"}delete this.tecm;if((this.ie&&c.type=="keydown")||c.type=="keypress"){if(c.ctrlKey){var a=String.fromCharCode(this.ie?c.keyCode:c.charCode).toLowerCase();var d=null;switch(a){case"b":d="bold";break;case"i":d="italic";break;case"u":d="underline";break;case"l":d="justifyleft";break;case"e":d="justifycenter";break;case"r":d="justifyright";break;case"j":d="justifyfull";break;case"t":d="indent";break;case"d":d="outdent";break}if(d){this.exec(d,false,null);stopEvent(c)}}}this.updateBar()}catch(b){alert(b)}return true};TE.exec=function(){this.document.execCommand(arguments[0],arguments[1],arguments[2]);this.te.contentWindow.focus()};TE.revoke=function(){if(!this.el){return}this.el.innerHTML=this.document.body.contentEditable?this.document.body.getElementById("ted").innerHTML:this.document.body.innerHTML;this.el.style.display="block";this.tec.style.display="none";if(this.document.body.contentEditable){this.document.body.contentEditable=false}else{this.document.designMode="Off"}this.el=null};TE.getSelection=function(){return window.te.getSelection?window.te.getSelection():this.document.selection};TE.buttons=["Bold","Italic","Underline"];TE.options=["FontName","FontSize"];TE.getRange=function(b){var a=null;if(b.createRange){a=b.createRange()}else{if(typeof b!="undefined"){this.te.contentWindow.focus();try{a=b.getRangeAt(0)}catch(c){a=this.document.createRange()}}else{a=this.document.createRange()}}return a};TE.getSelectedNode=function(){var a=this.getSelection();var d=this.getRange(a);if(a&&a.type){switch(a.type){case"Text":case"None":return d.parentElement();case"Control":return d.item(0);default:return this.document.body}}else{try{var c=d.commonAncestorContainer;if(!d.collapsed&&d.startContainer==d.endContainer&&d.startOffset-d.endOffset<=1&&d.startContainer.hasChildNodes()){c=d.startContainer.childNodes[d.startOffset]}while(c.nodeType==3){c=c.parentNode}return c}catch(b){return null}}};TE.hl=function(b,c,a){b.style.color=c;b.style.backgroundColor=a};TE.bhl=function(a){if(a.className.indexOf("tetbbh")!=-1){removeClass(a,"tetbbh")}else{addClass(a,"tetbbh")}};TE.bs=function(a){this.exec(a.id.replace(/tetbb_/,""),false,null);this.updateBar()};addClass=function(d,b){var a=d.className.split(" ");var e=false;for(var c=0;c<a.length;c++){if(a[c]==b){e=true;break}}if(!e){d.className=d.className+" "+b}};removeClass=function(d,b){var a=d.className.split(" ");var e=-1;for(var c=0;c<a.length;c++){if(a[c]==b){e=c;break}}if(e!=-1){a.splice(e,1);d.className=a.join(" ")}};TE.updateBar=function(){if(this.utimer){clearTimeout(this.utimer)}this.utimer=setTimeout("TE.us()",100)};TE.us=function(){for(var a=0;a<this.buttons.length;a++){if(this.document.queryCommandState(this.buttons[a])){addClass($("tetbb_"+this.buttons[a]),"tetbbs")}else{removeClass($("tetbb_"+this.buttons[a]),"tetbbs")}}};TE.sm=function(e){var h=e.id.replace(/tetbb_/,"");var b=$("tem_"+h);if(b.style.display=="none"){var c=this.document.queryCommandValue(h);var a=document.getElementsByName("temo_"+h);for(var d=0;d<a.length;d++){if(a[d].getAttribute("option")==c){addClass(a[d].firstChild,"temocs")}else{removeClass(a[d].firstChild,"temocs")}}var g=findPosX(e)-80;var f=findPosY(e)-80;b.style.left=g+"px";b.style.top=f+"px";b.style.display="block"}else{b.style.display="none"}if(this.tecm){this.tecm.style.display="none"}this.tecm=b};TE.os=function(b){var c=b.id.split("_")[1];this.exec(c,false,b.getAttribute("option"));var a=$("tem_"+c);a.style.display="none";if(this.tecm){this.tecm.style.display="none"}delete this.tecm};TE.getContent=function(){return this.document.body.innerHTML};var colorId="";function showColorDialog(b){var a=docid("color_div");a.style.display="block";colorId=b;if(b=="plaintxt"){docid("clrpickrow").style.display=rowdisp}}var prevColor="000000";var prevBkColor="000000";var is_bkcolor=0;function View(a){docid("ColorPreview").style.backgroundColor="#"+a;docid("ColorHex").value="#"+a}function setPrevColor(a){docid("PrevColor").style.backgroundColor="#"+a}function Set(a){var l=ValidateColor(a);if(l==null){alert("Invalid color code: "+a)}else{View(l);setPrevColor(l);if(docid(colorId+"color")){docid(colorId+"color").value=l}if(colorId=="header"){var i=docid("hdrprivclr");i.bgColor=l;var f=docid(colorId+"clrpicker");f.style.backgroundColor=l}else{if(colorId=="border"){var e=docid("bdrprivclr");e.style.borderColor="#"+l;var d=docid(colorId+"clrpicker");d.style.backgroundColor=l}}if(colorId=="viewhdr"){if(docid(colorId+"privclr")){docid(colorId+"privclr").bgColor=l}var f=docid(colorId+"clrpicker");f.style.backgroundColor=l;if(docid("calhdrprivclr")){docid("calhdrprivclr").bgColor=l}if(docid("sumryhdrprivclr")){docid("sumryhdrprivclr").bgColor=l}}else{if(colorId=="viewbdr"){if(docid(colorId+"privclr")){docid(colorId+"privclr").style.borderColor="#"+l}var d=docid(colorId+"clrpicker");d.style.backgroundColor=l;if(docid("calbdrprivclr")){docid("calbdrprivclr").style.borderColor="#"+l}if(docid("sumrybdrprivclr")){docid("sumrybdrprivclr").style.borderColor="#"+l}}else{if(colorId=="calBg"){var c=docid(colorId+"clrpicker");c.style.backgroundColor=l;var b=docid(colorId+"privclr");b.style.backgroundColor=l;var k=docid(colorId+"privclr1");k.style.backgroundColor=l;var j=docid(colorId+"privclr2");j.style.backgroundColor=l}else{if(colorId=="calgrid"){var h=docid(colorId+"clrpicker");h.style.backgroundColor=l;var g=docid(colorId+"privclr");g.style.backgroundColor=l}else{if(colorId=="labelbg"){docid(colorId+"clrpicker").style.backgroundColor=l;docid(colorId+"privclr").style.backgroundColor=l;docid(colorId+"privclr1").style.backgroundColor=l}else{if(colorId=="altrow"){docid(colorId+"clrpicker").style.backgroundColor=l;docid(colorId+"privclr").style.backgroundColor=l}}}}}}if(colorId=="header"||colorId=="border"){generateSnippet()}if(colorId=="viewhdr"||colorId=="viewbdr"||colorId=="calBg"||colorId=="calgrid"||colorId=="labelbg"||colorId=="altrow"){if(docid("readsnippet"+vilinkId).style.display=="none"){genJsSnippet()}else{genViewSnippet()}}if(colorId=="plaintxt"){TE.exec("forecolor",false,l)}closePicker()}}function ValidateColor(e){e=e||"";e=e+"";e=e.toUpperCase();var d="0123456789ABCDEF";var a="";for(var c=0;c<e.length;c++){var b=e.charAt(c);if(d.indexOf(b)!=-1){a+=b}}if(a.length!=6){return null}return a}function closePicker(){docid("color_div").style.display="none";if(colorId=="plaintxt"){docid("clrpickrow").style.display="none"}};