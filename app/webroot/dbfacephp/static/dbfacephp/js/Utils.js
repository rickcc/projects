var browser_opera=false;var browser_ie=false;var browser_nn6=false;var browser_nn4=false;if(document.all){if(window.navigator.appName.toUpperCase=="OPERA"){browser_opera=true}else{browser_ie=true}}else{if(document.layers||(!document.all&&document.getElementById)){browser_nn6=true}else{if(document.layers){browser_nn4=true}}}function html_GetElement(a){try{var b;switch(typeof(a)){case"string":b=document.getElementById(a);break;case"object":b=a;break;default:b=false;break}return b}catch(c){return false}}function findPosX(b){b=html_GetElement(b);var a=0;var c=0;if(b.x){return b.x}else{if(b.offsetParent){while(b.offsetParent){if(b.style.left){c+=parseInt(b.style.left.substring(0,b.style.left.length-2));return c}else{c+=b.offsetLeft}b=b.offsetParent}}}return c}function findPosY(b){b=html_GetElement(b);var a=0;if(b.y){return b.y}else{if(b.offsetParent){while(b.offsetParent){if(b.style.top){a+=parseInt(b.style.top.substring(0,b.style.top.length-2));return a}else{a+=b.offsetTop}b=b.offsetParent}}}return a}function findDocDim(){if(browser_ie){return{width:document.body.offsetWidth+document.body.scrollLeft,height:document.body.offsetHeight+document.body.scrollTop}}else{if(browser_nn4||browser_nn6){return{width:window.innerWidth+document.body.scrollLeft,height:window.innerHeight+document.body.scrollTop}}}}function getCursorPos(b){if(browser_ie){var a=window.event.clientX+document.body.scrollLeft;var c=window.event.clientY+document.body.scrollTop}else{if(browser_nn6){var a=b.pageX;var c=b.pageY}}return{x:a,y:c}}var scrollConst=0;var scrX=0,scrY=0,pgeX=0,pgeY=0,srcElement;if(browser_ie){document.attachEvent("onclick",popUpListener)}else{if(browser_nn4||browser_nn6){document.addEventListener("click",popUpListener,true)}}function popUpListener(a){if(browser_ie){srcElement=window.event.srcElement}else{if(browser_nn4||browser_nn6){srcElement=a.target;scrX=a.screenX;scrY=a.screenY;pgeX=a.pageX;pgeY=a.pageY}}}function getObj(f,e){var c,b,a;if(!e){e=document}if((c=f.indexOf("?"))>0&&parent.frames.length){e=parent.frames[f.substring(c+1)].document;f=f.substring(0,c)}if(!(a=e[f])&&e.all){a=e.all[f]}for(b=0;!a&&b<e.forms.length;b++){a=e.forms[b][f]}for(b=0;!a&&e.layers&&b<e.layers.length;b++){a=getObj(f,e.layers[b].document)}if(!a&&e.getElementById){a=e.getElementById(f)}return a}String.prototype.trim=function(){var a=this;a=a.replace(/^\s*(.*)/,"$1");a=a.replace(/(.*?)\s*$/,"$1");return a};function clearTextSelection(){if(window.getSelection){window.getSelection().removeAllRanges()}else{if(document.getSelection){var a=document.getSelection();if(a.collapse){a.collapse(true)}if(a.removeAllRanges){a.removeAllRanges()}}else{if(document.selection){document.selection.empty()}}}}function docid(a){return document.getElementById(a)}function getA(b,a){return b.getAttribute(a)}function setA(b,a,c){return b.setAttribute(a,c)}function getBool(a){if(a=="true"||a=="1"){return true}return false}var celldisp="block";var rowdisp="block";var tabledisp="block";if(!document.all){celldisp="table-cell";rowdisp="table-row";tabledisp="table"}var samplef=null;function getForm(e,c,d){if(samplef==null){samplef=document.createElement("form");samplef.method="post";document.body.appendChild(samplef)}var a=samplef.elements;for(var b=a.length-1;b>=0;b--){samplef.removeChild(a.item(b))}samplef.action=e;for(var b=0;b<c.length;b++){samplef.appendChild(getInp(c[b],d[b]))}return samplef}function getInp(a,c){var b=document.createElement("input");b.type="hidden";b.setAttribute("name",a);b.setAttribute("value",c);return b}if(!document.all){HTMLElement.prototype.__defineSetter__("outerHTML",function(c){var a=this.ownerDocument.createRange();a.setStartBefore(this);var b=a.createContextualFragment(c);this.parentNode.replaceChild(b,this);return c});HTMLElement.prototype.__defineGetter__("outerHTML",function(){return getOuterHTML(this)});function getOuterHTML(d){var e="";var c=["IMG","HR","BR","INPUT"];switch(d.nodeType){case 1:e+="<"+d.nodeName;for(var b=0;b<d.attributes.length;b++){if(d.attributes.item(b).nodeValue!=null){e+=" ";e+=d.attributes.item(b).nodeName;e+='="';e+=d.attributes.item(b).nodeValue;e+='"'}}var a=-1;for(var b=0;b<c.length;b++){if(c[b]==d.nodeName){a=b;break}}if(d.childNodes.length==0&&a>0){e+=">"}else{e+=">";e+=d.innerHTML;e+="</"+d.nodeName+">"}break;case 3:e+=d.nodeValue;break;case 4:e+="<![CDATA["+d.nodeValue+"]]>";break;case 5:e+="&"+d.nodeName+";";break;case 8:e+="<!--"+d.nodeValue+"-->";break}return e}}function trimString(a){if(a!=null){a=a.replace(/^\s+/g,"");a=a.replace(/\s+$/g,"")}return a}function makeSelect(b){if(!b){return}if(b.createTextRange){var a=b.createTextRange();a.collapse(true);a.select()}else{if(b.setSelectionRange){b.focus();b.setSelectionRange(0,0)}}}function freezeScriptBackground(b){var a;if(!document.getElementById("ScriptFreezeLayer")){var c=document.createElement("DIV");c.id="ScriptFreezeLayer";if(b){if(b=="1"){c.className="scriptfreezeLayer"}else{if(b=="2"){c.className="scriptfreezeLayer2"}else{if(b=="3"){c.className="scriptfreezeLayer3"}}}}else{c.className="scriptfreezeLayer"}c.style.zIndex="99";document.body.appendChild(c);if(browser_ie){if(b&&b=="2"){}else{a=document.createElement("IFRAME");a.scrolling="no";a.id="ScriptIEHackLayer";a.frameBorder=0;if(window.CONTEXT_PATH!=null){a.src=CONTEXT_PATH+"/framework/html/blank.html"}a.style.position="absolute";a.style.zIndex="98";a.style.filter="progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)";a.style.top="0px";a.style.left="0px";a.style.height="100%";a.style.width="100%";document.body.appendChild(a)}}}}function unFreezeScript(){if(document.getElementById("ScriptFreezeLayer")!=null){document.body.removeChild(docid("ScriptFreezeLayer"));if(browser_ie){try{document.body.removeChild(docid("ScriptIEHackLayer"))}catch(a){}}}}var diffTaskDefLeft=0;var diffTaskDefTop=0;var TaskDefDialog=null;function setCurrentTaskDef(a){TaskDefDialog=a}function captureTaskDef(a){TaskDefDialog.style.cursor="move";if(browser_ie){diffTaskDefLeft=window.event.clientX+document.body.scrollLeft-parseInt(findPosX(TaskDefDialog));diffTaskDefTop=window.event.clientY+document.body.scrollTop-parseInt(findPosY(TaskDefDialog))}else{if(browser_nn4||browser_nn6){diffTaskDefLeft=a.pageX-parseInt(findPosX(TaskDefDialog));diffTaskDefTop=a.pageY-parseInt(findPosY(TaskDefDialog))}}document.onmousemove=moveTaskDef;document.onmouseup=releaseTaskDef}function moveTaskDef(a){clearTextSelection();if(browser_ie){if(document.getElementById("FreezeLayer")!=null||browser_opera){TaskDefDialog.style.left=(window.event.clientX+document.body.scrollLeft-diffTaskDefLeft)+"px";TaskDefDialog.style.top=(window.event.clientY+document.body.scrollTop-diffTaskDefTop)+"px"}else{TaskDefDialog.style.left=(window.event.clientX+document.body.scrollLeft-diffTaskDefLeft)+"px";TaskDefDialog.style.top=(window.event.clientY+document.body.scrollTop-diffTaskDefTop)+"px"}}else{if(browser_nn4||browser_nn6){TaskDefDialog.style.left=(a.pageX-diffTaskDefLeft)+"px";TaskDefDialog.style.top=(a.pageY-diffTaskDefTop)+"px"}}}function releaseTaskDef(){TaskDefDialog.style.cursor="default";document.onmousemove=null;document.onmouseup=null}function positioncenter(b){var c=b.offsetWidth;var a=b.offsetHeight;var f=findDocDim();var e=(f.width/2)-(c/2)+document.body.scrollLeft;var d=(f.height/2)-(a/2)+document.body.scrollTop;e=e<0?0:e;d=d<0?0:d;b.style.left=parseInt(e)+"px";b.style.top=parseInt(d)+"px"}function swapImg(b,a){b.src=a}function reStoreImg(b,a){b.src=a}function removeAllChildNodes(a){while(a.hasChildNodes()){a.removeChild(a.firstChild)}}function createElem(l,f,j){var c=document.createElement(l);if(f){var k=f.split(" ");for(var g in k){var b=k[g];var d=b.split("=");var a=d[0];var h=d[1];if(a&&h){c.setAttribute(a,h);if(a=="class"){c.className=h}}else{if(a){c.setAttribute(a,"")}}}}if(j){var e=null;if(typeof j=="string"){e=document.createTextNode(j)}else{e=j}c.appendChild(e)}return c}function equalsIgnoreCase(b,a){if(a&&a){if(b.toLowerCase()==a.toLowerCase()){return true}}return false}function getCookieVal(b){var a=document.cookie.indexOf(";",b);if(a==-1){a=document.cookie.length}return unescape(document.cookie.substring(b,a))}function setCookie(b,h){var c=new Date();c.setTime(c.getTime()+2*365*24*3600*1000);var g=arguments;var e=arguments.length;var d=(e>2)?g[2]:c;var i="/";var f=(e>4)?g[4]:null;var a=(e>5)?g[5]:false;document.cookie=b+"="+escape(h)+((d==null)?"":("; expires="+c.toGMTString()))+((i==null)?"":("; path="+i))+((f==null)?"":("; domain="+f))+((a==true)?"; secure":"")}function delCookie(a){var b=getCookie(a);if(b!=null){document.cookie=a+"="+b+";path=/;expires=Fri,31 Dec 1999 23:59:59 GMT;"}}function getCookie(d){var b=d+"=";var f=b.length;var a=document.cookie.length;var e=0;while(e<a){var c=e+f;if(document.cookie.substring(e,c)==b){return getCookieVal(c)}e=document.cookie.indexOf(" ",e)+1;if(e==0){break}}return null}function addEvent(b,a,c){if(b.attachEvent){b.attachEvent("on"+a,c)}else{if(b.addEventListener){b.addEventListener(a,c,false)}else{var f="on"+a;var g=b[f];b[f]=function(){var e=g.apply(this,arguments),d=c.apply(this,arguments);return e==undefined?d:(d==undefined?e:d&&e)}}}}function addEvents(c,a,d){for(var b in a){addEvent(c,a[b],d)}}function removeEvent(b,a,c){if(b.detachEvent){b.detachEvent("on"+a,c)}else{b.removeEventListener(a,c,false)}}function removeEvents(c,a,d){for(var b in a){removeEvent(c,a[b],d)}}function stopEvent(a){if(a.stopPropagation){a.preventDefault();a.stopPropagation()}else{a.cancelBubble=true;a.returnValue=false}}function onlyNumber(b){var a;iKeyCode=window.event?b.keyCode:b.which;if(!(((iKeyCode>=48)&&(iKeyCode<=57))||(iKeyCode==13)||(iKeyCode==46)||(iKeyCode==45)||(iKeyCode==37)||(iKeyCode==39)||(iKeyCode==8))){return false}return true}function html_SubString(a,b){var c=false;if(a&&b){if(a.toString().indexOf(b.toString())!=-1){c=true}}return c}function hideElement(b){var a;if(typeof(b)=="string"){a=$j("#"+b)}else{a=$j(b)}if(a){a.fadeOut("fast")}}var oDialog,doc,srcEl,closeOnEscKey=true,closeOnBodyClick=false,needIframe=false,iframeIEHack;var dialogProperties=new Array("position","top","left","height","width","srcElement","modal","draggable","title","closeButton","closeOnEscKey","transitionType","transitionInterval","closeOnBodyClick","needIframe");var oCloseClBk=null;function showDialog(v,u,r,p){oCloseClBk=p;if(typeof(u)=="undefined"){var u="position=absmiddle"}u=u.split(",");var m;for(var x=0;x<dialogProperties.length;x++){m=false;for(var w=0;w<u.length;w++){if(u[w].indexOf(dialogProperties[x])>=0){m=true;break}}self["dialog_"+dialogProperties[x]]=(m)?u[w].substr(u[w].indexOf("=")+1,u[w].length).trim():"undefined"}if(document.getElementById("_DIALOG_LAYER")!=null&&oDialog){oDialog.parentNode.removeChild(oDialog)}oDialog=document.createElement("DIV");oDialog.id="_DIALOG_LAYER";document.body.appendChild(oDialog);var v='<div id="_DIALOG_CONTENT">'+v+"</div>";var f='<table class="DialogBox" border="0" cellspacing="0" cellpadding="0"><tr><td class="boxTL">&nbsp;</td>';if(dialog_draggable!="undefined"&&dialog_draggable=="no"){f+='<td class="boxHeader">'}else{f+='<td class="boxHeader drag" onMouseDown="captureDialog(event)">'}if(dialog_title!="undefined"){if(dialog_title.charAt(0)=="'"&&dialog_title.charAt(dialog_title.length-1)=="'"){dialog_title=dialog_title.substr(1,dialog_title.length-2)}if(dialog_title.trim().length==0){dialog_title="&nbsp;"}}else{dialog_title="&nbsp;"}f+=dialog_title+'</td><td class="boxCtrlButtonPane">';if(dialog_closeButton!="undefined"&&dialog_closeButton=="no"){f+="&nbsp;</td>"}else{f+='<input type="button" class="closeButton" onClick="closeDialog()"></td>'}f+='<td class="boxTR">&nbsp;</td></tr><tr><td colspan="4" class="boxContent">'+v+"</td></tr>";f+='<tr><td class="boxBL"></td><td class="boxBC" colspan="2"></td><td class="boxBR"></td></tr></table>';oDialog.style.display="block";var d=true;if(dialog_closeButton!="undefined"){if(dialog_title=="&nbsp;"&&dialog_closeButton=="no"){d=false}}if(d){oDialog.innerHTML="<table cellpadding='0' cellspacing='0'><tr><td height='100%' style='display:block'>"+f+"</td></tr></table>"}else{oDialog.innerHTML="<table cellpadding='0' cellspacing='0'><tr><td height='100%' style='display:block'>"+v+"</td></tr></table>"}oDialog.style.position="absolute";oDialog.style.left="-1000px";oDialog.style.top="-1000px";oDialog.style.zIndex="1000";var t=oDialog.getElementsByTagName("SCRIPT");for(var x=0;x<t.length;x++){var s=document.createElement("SCRIPT");s.type="text/javascript";s.language="javascript";if(t[x].src!=""){s.src=t[x].src}s.text=t[x].text;if(typeof document.getElementsByTagName("HEAD")[0]=="undefined"){document.createElement("HEAD").appendChild(s)}else{document.getElementsByTagName("HEAD")[0].appendChild(s)}}if(browser_opera){var q=v;var n=oDialog.getElementsByTagName("STYLE");for(var x=0;x<n.length;x++){n[x].innerHTML=q.substring(q.indexOf("<style>")+7,q.indexOf("</style>")-1);q=q.substring(q.indexOf("</style>")+8,q.length)}}oDialogContent=getObj("_DIALOG_CONTENT");var k=0,h=0;var o=oDialog.offsetWidth;var l=oDialog.offsetHeight;doc=findDocDim();if(dialog_closeOnEscKey!="undefined"&&dialog_closeOnEscKey=="no"){closeOnEscKey=false}else{closeOnEscKey=true}if(dialog_closeOnBodyClick!="undefined"&&dialog_closeOnBodyClick=="yes"){closeOnBodyClick=true}else{closeOnBodyClick=false}if(dialog_needIframe!="undefined"&&dialog_needIframe=="no"){needIframe=false}else{needIframe=true}if(!browser_opera){if(dialog_modal!="undefined"&&dialog_modal=="yes"){freezeBackground()}else{if(document.getElementById("FreezeLayer")!=null){document.body.removeChild(document.getElementById("FreezeLayer"))}}}if(dialog_left!="undefined"){k+=parseInt(dialog_left)}if(dialog_top!="undefined"){h+=parseInt(dialog_top)}var g=(document.body.scrollLeft>0)?15:0;var e=(document.body.scrollTop>0)?15:0;if(dialog_position!="undefined"&&dialog_position=="relative"){if(dialog_srcElement!="undefined"){srcEl=getObj(dialog_srcElement)}else{if(srcEl==null){srcEl=document.body}}var c=(srcEl.offsetWidth)?srcEl.offsetWidth:0;var b=(srcEl.offsetHeight)?srcEl.offsetHeight:0;if(findPosX(srcEl)+o>doc.width-g){k+=findPosX(srcEl)+c-o}else{k+=findPosX(srcEl)}if(findPosY(srcEl)+b+l>doc.height-e){h+=findPosY(srcEl)-l}else{h+=findPosY(srcEl)+b+2}}else{if(dialog_position!="undefined"&&dialog_position=="current"){if(dialog_cursor_left!=null&&dialog_cursor_top!=null){k=dialog_cursor_left;h=dialog_cursor_top}else{k=h=0}k=(dialog_cursor_left!=null)?dialog_cursor_left:0;h=(dialog_cursor_top!=null)?dialog_cursor_top:0;if(k+o>doc.width-g){k-=o}if(h+l>doc.height-e){h-=l}}else{if(dialog_position!="undefined"&&dialog_position=="absolute"){k+=document.body.scrollLeft;h+=document.body.scrollTop}else{k=(doc.width/2)-(o/2)+document.body.scrollLeft;h=(doc.height/2)-(l/2)+document.body.scrollTop}}}k=(k>0)?k:0;h=(h>0)?h:0;oDialog.style.left=parseInt(k)+"px";oDialog.style.top=parseInt(h)+"px";if(!browser_opera){if(dialog_modal!="undefined"&&dialog_modal=="yes"){var a=findDocDim();document.getElementById("FreezeLayer").style.width=a.width+"px";document.getElementById("FreezeLayer").style.height=a.height+"px";if(browser_ie&&iframeIEHack!=null){iframeIEHack.style.height=document.getElementById("FreezeLayer").style.height}}}if(r!=null&&typeof r!="undefined"){r()}return oDialog}var diffLeft=0,diffTop=0;function captureDialog(a){if(browser_ie){diffLeft=window.event.clientX+document.body.scrollLeft-parseInt(findPosX(oDialog));diffTop=window.event.clientY+document.body.scrollTop-parseInt(findPosY(oDialog))}else{if(browser_nn4||browser_nn6){diffLeft=a.pageX-parseInt(findPosX(oDialog));diffTop=a.pageY-parseInt(findPosY(oDialog))}}document.onmousemove=moveDialog;document.onmouseup=releaseDialog}function moveDialog(b){clearTextSelection();if(browser_ie){var a=window.event.clientX+document.body.scrollLeft-diffLeft;var c=window.event.clientY+document.body.scrollTop-diffTop;a=(a>=0)?a:0;c=(c>=0)?c:0;if(document.getElementById("FreezeLayer")!=null||browser_opera||iframeIEHack==null){oDialog.style.left=a+"px";oDialog.style.top=c+"px"}else{oDialog.style.left=iframeIEHack.style.left=a+"px";oDialog.style.top=iframeIEHack.style.top=c+"px"}}else{if(browser_nn4||browser_nn6){oDialog.style.left=((b.pageX-diffLeft>0)?b.pageX-diffLeft:0)+"px";oDialog.style.top=((b.pageY-diffTop>0)?b.pageY-diffTop:0)+"px"}}}function releaseDialog(){oDialog.style.cursor="default";document.onmousemove=null;document.onmouseup=null}function closeDialog(a){if(oDialog!=null&&oDialog.style.display!="none"){oDialog.style.display="none";if(document.getElementById("FreezeLayer")!=null){document.getElementById("FreezeLayer").parentNode.removeChild(document.getElementById("FreezeLayer"))}if(browser_ie&&!browser_opera&&iframeIEHack!=null){document.body.removeChild(iframeIEHack);iframeIEHack=null}closeOnBodyClick=false;if(oCloseClBk&&oCloseClBk!=null&&oCloseClBk!="undefined"){oCloseClBk()}if(typeof a!="undefined"&&a.srcElement=="undefined"){a()}}}document.onkeydown=function(b){if(browser_ie){var a=window.event.keyCode}else{if(browser_nn4||browser_nn6){var a=b.which}}if(a==27&&closeOnEscKey==true&&oDialog!=null&&oDialog.style.display!="none"){closeDialog()}};var dialog_cursor_left,dialog_cursor_top;document.onmousedown=function(c){if(browser_ie){srcEl=window.event.srcElement}else{if(browser_nn4||browser_nn6){srcEl=c.target}}var b=getCursorPos(c);var a=b.x;var d=b.y;dialog_cursor_left=a;dialog_cursor_top=d;if(typeof closeOnBodyClick!="undefined"&&closeOnBodyClick==true&&oDialog!=null&&oDialog.style.visibility!="hidden"){if((a<findPosX(oDialog)||a>=findPosX(oDialog)+oDialog.offsetWidth)||(d<findPosY(oDialog)||d>=findPosY(oDialog)+oDialog.offsetHeight)){closeDialog()}}};function URLDecode(b){var a="0123456789ABCDEFabcdef";var f=b;var e="";var c=0;while(c<f.length){var d=f.charAt(c);if(d=="+"){e+=" ";c++}else{if(d=="%"){if(c<(f.length-2)&&a.indexOf(f.charAt(c+1))!=-1&&a.indexOf(f.charAt(c+2))!=-1){e+=unescape(f.substr(c,3));c+=3}else{alert("Bad escape combination near ..."+f.substr(c));e+="%[ERROR]";c++}}else{e+=d;c++}}}return e};