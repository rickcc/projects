var alphaVal=0,fadeInIntvl,fadeOutIntvl;function fadeIn(a,d,c){alphaVal=0;var b=document.getElementById(a);b.style.opacity=alphaVal;b.style.filter="alpha(opacity="+alphaVal+")";b.style.display="";fadeInIntvl=window.setInterval('doFadeIn("'+a+'", '+c+")",d)}function doFadeIn(a,c){var b=document.getElementById(a);if(!b){window.clearInterval(fadeInIntvl);if(typeof c!="undefined"){c()}return}if(alphaVal<10){b.style.filter="alpha(opacity="+(alphaVal*4)+")";b.style.opacity=alphaVal/6;alphaVal++}else{b.style.filter="alpha(opacity=100)";b.style.opacity=0.99;window.clearInterval(fadeInIntvl);if(typeof c!="undefined"){c()}}}function fadeOut(b,c,a){alphaVal=9;fadeOutCall=true;fadeOutIntvl=window.setInterval('doFadeOut("'+b+'", '+a+")",c)}function doFadeOut(b,a){var c=document.getElementById(b);if(!c||fadeOutCall==false){alphaVal=0;fadeOutCall=false;window.clearInterval(fadeOutIntvl);if(typeof a!="undefined"){a()}}else{if(alphaVal>0){c.style.filter="alpha(opacity="+(alphaVal*10)+")";c.style.opacity=(alphaVal/10);alphaVal--}else{alphaVal=0;c.style.filter="alpha(opacity=0)";c.style.opacity=0.01;c.style.display="none";window.clearInterval(fadeOutIntvl);fadeOutCall=false;if(typeof a!="undefined"){a()}}}}function loadoff(){var a=document.getElementById("loading");if(a){a.style.display="none"}}function loadon(a){var d=document.getElementById("loading");var c=document.getElementById("loadingmsg");if(d&&c){if(a){c.innerHTML=a}else{c.innerHTML="Please wait..."}var b=findDocDim();d.style.display="block";d.style.left=b.width/2-d.offsetWidth/2;d.style.top=b.height/2-d.offsetHeight/2}}function lazyloadcss(b){for(var a=0;a<b.length;a++){if(document.createStyleSheet){document.createStyleSheet(b[a])}else{var d=document.createElement("link");d.rel="stylesheet";d.href=b[a];d.type="text/css";document.getElementsByTagName("head")[0].appendChild(d)}}}function deg2rad(a){return(a/180)*Math.PI}function rad2deg(a){return(a/Math.PI)*180}function removeAllChildNodes(a){while(a.hasChildNodes()){a.removeChild(a.firstChild)}}function checkifpresent(a,c){for(var b=0;b<a.length;b++){if(a[b]+""==c+""){return true}}return false}function _emptyFunction(){}var TmMsgBox=new function(){this.eleID="TmMsgDiv";this.interval=8000;this.crId=null;this.slideStarted=false;this.nextError=null;this.showErrorIfNeeded=function(a){if(a&&a.isError()){TmMsgBox.showError(a.errorMsg)}};this.showError=function(a){this.showHintMsg(a,"error")};this.showSuccess=function(a){this.showHintMsg(a,"success")};this.showInfo=function(a){this.showHintMsg(a,"info")};this.showHintMsg=function(b,a){this.messagetype=a;this.content=document.getElementById(this.eleID);document.body.appendChild(this.content);if(this.content==null){return}if(b!=null){errEl=document.getElementById("err");icon=document.getElementById("msgicon");if(this.messagetype=="error"){icon.className="erroricon";errEl.className="errormessage"}else{if(this.messagetype=="info"){icon.className="infoicon";errEl.className="infomessage"}else{if(this.messagetype=="success"){icon.className="successicon";errEl.className="infomessage"}}}errEl.innerHTML=b;if(this.crId!=null){clearTimeout(this.crId);this.crId=null}if(this.slideStarted){this.nextError=b}else{if(this.content.style.display=="none"){MCEffect.SlideDown(this.eleID)}this.temp(this.eleID,b,this.interval)}}if(b==null&&this.content.style.display=="block"){clearTimeout(this.crId);this.crId=null;MCEffect.SlideUp(this.eleID,{ONCLOSE:TmMsgBox.checkNext})}};this.checkNext=function(){TmMsgBox.slideStarted=false;if(TmMsgBox.nextError){var a=TmMsgBox.nextError;TmMsgBox.nextError=null;TmMsgBox.showError(a)}};this.temp=function(a,c,b){this.slideStarted=false;this.crId=window.setTimeout(TmMsgBox.hideError,TmMsgBox.interval)};this.hideError=function(){TmMsgBox.slideStarted=true;TmMsgBox.currentTimeoutId=null;MCEffect.SlideUp(TmMsgBox.eleID,{ONCLOSE:TmMsgBox.checkNext});clearTimeout(TmMsgBox.crId)}};var MCEffect=new function(){};MCEffect.CONFIG={INTERVAL:10,SCROLL_INTERVAL:3,FADE_INTERVAL:5};MCEffect.getValue=function(b,a,c){if(a!=null){if(a[b]!=null){return a[b]}}if(c!=null){if(c[b]!=null){return c[b]}}return null};MCEffect.getDimensions=function(f){if(f.style.display!="none"){return{width:f.offsetWidth,height:f.offsetHeight}}var a=f.style;var d=a.visibility;var c=a.position;a.display="block";a.visibility="hidden";a.position="absolute";var b=f.offsetWidth;var e=f.offsetHeight;a.display="none";a.position=c;a.visibility=d;return{width:b,height:e}};MCEffect.SlideDown=function(_51b,_51c){var _51d=document.getElementById(_51b);if(_51d==null){return}if(MCEffect.getValue("INTERVAL",_51c,MCEffect.CONFIG)==-1){_51d.style.display="block";if(_51c!=null){var obj=_51c.ONOPEN;if(obj!=null){eval(obj)(_51c)}}return}window.clearInterval(_51d._intvl);window.clearInterval(_51d.s_intvl);_51d._reqOptions=_51c;appendParent(_51d);var _51f=MCEffect.getDimensions(_51d).height;var _520=-1*_51f;_51d.style.marginTop=_520+"px";_51d.setAttribute("__margin",_520);var _521=window.setInterval("MCEffect.openContent('"+_51b+"')",1);_51d._intvl=_521};MCEffect.openContent=function(_522){var _523=document.getElementById(_522);var _524=parseInt(_523.getAttribute("__margin"));var _525=_523._reqOptions;if(_524<=0){_523.style.marginTop=(_524)+"px";_524+=MCEffect.getValue("INTERVAL",_525,MCEffect.CONFIG);_523.setAttribute("__margin",_524);_523.style.display="block";var top=parseInt(findPosY(_523));var _527=_523.offsetHeight;var _528=document.body.clientHeight;var _529=document.body.scrollTop;if(top+_527-_529>_528){replaceParent(_523);_523.style.marginTop="0px";window.clearInterval(_523._intvl);MCEffect.ScrollToView(_522,_525)}}else{replaceParent(_523);_523.style.marginTop="0px";window.clearInterval(_523._intvl);if(_525!=null){var obj=_525.ONOPEN;if(obj!=null){eval(obj)(_525)}}}};MCEffect.ScrollToView=function(b,a){var i=document.getElementById(b);if(!i){return}window.clearInterval(i.s_intvl);var c=parseInt(findPosY(i));var h=i.offsetHeight;var g=document.body.clientHeight;var f=document.body.scrollTop;var e=null;if(c-f<0){if(a!=null){a._scroll=c}else{a={_scroll:c}}i._reqOptions=a;e=window.setInterval("MCEffect.scrollUp('"+b+"')",1)}else{if(c+h-f>g){var d=(c+h)-g;if(a!=null){a._scroll=d}else{a={_scroll:d}}i._reqOptions=a;e=window.setInterval("MCEffect.scrollDown('"+b+"')",1)}}i.s_intvl=e};MCEffect.scrollUp=function(_534){var _535=document.body.scrollTop;var _536=document.getElementById(_534);var _537=_536._reqOptions;if(!_537){window.clearInterval(_536.s_intvl);return}var _538=_537._scroll;if(_535>_538){document.body.scrollTop-=3}else{_538=0;window.clearInterval(scrollUpIntvl);if(_537!=null){var obj=_537.ONOPEN;if(obj!=null){eval(obj)(_537)}}}};MCEffect.scrollDown=function(_53a){var _53b=document.body.scrollTop;var _53c=document.getElementById(_53a);var _53d=_53c._reqOptions;if(!_53d){window.clearInterval(_53c.s_intvl);return}var _53e=_53d._scroll;if(_53b<_53e){document.body.scrollTop+=3}else{_53e=0;window.clearInterval(_53c.s_intvl);if(_53d!=null){var obj=_53d.ONOPEN;if(obj!=null){eval(obj)(_53d)}}}};function appendParent(b){var a=b.parentNode;var c=document.createElement("div");c.style.overflow="hidden";c.className="innerDiv";c.setAttribute("__MC_HOLDERDIV","true");a.replaceChild(c,b);c.appendChild(b)}function replaceParent(b){var a=b.parentNode;if(a.getAttribute("__MC_HOLDERDIV")==null){return}a.parentNode.replaceChild(b,a)}MCEffect.SlideUp=function(_545,_546){var _547=document.getElementById(_545);if(_547==null){return}if(MCEffect.getValue("INTERVAL",_546,MCEffect.CONFIG)==-1){_547.style.display="none";if(_546!=null){var obj=_546.ONCLOSE;if(obj!=null){eval(obj)(_546)}}return}window.clearInterval(_547._intvl);_547._reqOptions=_546;appendParent(_547);_547.style.display="block";var _549=_547.offsetHeight;var _54a=0;_547.setAttribute("__margin",_54a);_547.setAttribute("_conHeight",_549);var _54b=window.setInterval("MCEffect.closeContent('"+_545+"')",1);_547._intvl=_54b};MCEffect.closeContent=function(_54c){var _54d=document.getElementById(_54c);var _54e=_54d.getAttribute("_conHeight");var _54f=parseInt(_54d.getAttribute("__margin"));if(_54f>=_54e*-1){_54d.style.marginTop=(_54f)+"px";_54f-=MCEffect.getValue("INTERVAL",_550,MCEffect.CONFIG);_54d.setAttribute("__margin",_54f)}else{_54d.style.display="none";replaceParent(_54d);window.clearInterval(_54d._intvl);var _550=_54d._reqOptions;if(_550!=null){var obj=_550.ONCLOSE;if(obj!=null){eval(obj)(_550)}}}};function CreateEl(b,d){var a=document.createElement(b);a.className=d;a.style.display="block";return(a)}function setOpacity(a){a.style.filter="alpha(opacity:95)";a.style.KHTMLOpacity="0.95";a.style.MozOpacity="0.95";a.style.opacity="0.95"}function realLeft(a,b){var b=b||document.body;if(!a.offsetParent||a.offsetParent==b){return a.offsetLeft}else{var d=0;var c=a;while(c!=null&&c!=b){d+=c.offsetLeft;c=c.offsetParent}return d}}function realTop(b,c){var c=c||document.body;if(!b.offsetParent||b.offsetParent==c){return b.offsetTop}else{var a=0;var d=b;while(d!=null&&d!=c){a+=d.offsetTop;d=d.offsetParent}}return a}if(typeof(autoSuggest)=="undefined"){var autoSuggest={}}autoSuggest=function(a,b){if(!document.getElementById||!$(a)){return}this.input=$(a);for(var c in b){this[c]=b[c]}this.init()};autoSuggest.prototype={searchDelay:0.5,_inputTimer:null,urlFun:null,friendsMatch:[],_ul:null,li_null:null,aslihoverClass:"as_highlight",lastInput:"",returned:false,inputTip:"",_liHasHighlight:null,returnedLi:null,_checkInput:function(){var a=this.input.value;if(a==this.lastInput){return}this.lastInput=a;this.buildMenu(a)},setInputTip:function(){if(this.input.value==""){this.input.value=this.inputTip}},_inputOnKeyDown:function(b){var b=b||window.event;var a;switch(b.keyCode){case 38:if(this._liHasHighlight&&this._liHasHighlight.previousSibling){a=this._liHasHighlight.previousSibling}else{a=this._ul.lastChild}this._highLightMenu(a);return false;break;case 40:if(this._liHasHighlight&&this._liHasHighlight.nextSibling){a=this._liHasHighlight.nextSibling}else{a=this._ul.firstChild}this._highLightMenu(a);return false;break;case 13:if(this._liHasHighlight){this._selectMenu(this._liHasHighlight);this.input.blur()}return false;break;case 27:this.input.blur()}},_highLightMenu:function(a){if(this._liHasHighlight==a||!a){return}if(this._liHasHighlight!=null){this._liHasHighlight.className=""}a.className=this.aslihoverClass;this._liHasHighlight=a},_selectMenu:function(a){this.returned=true;this.returnedLi=a;this.lastInput=this.input.value=a.asname;this.input.value=a.friendid;if(a==this.li_null){this.returned=false;this.returnedLi=this.li_null}},hideMenu:function(){this._ul.style.display="none";this._ul.innerHTML=""},showMenu:function(){this._ul.style.display=""},buildMenu:function(a){var c=this;var b=this.urlFun();new Ajax.Request(b,{method:"get",onSuccess:function(d){c._buildMenu.call(c,d)}})},_buildMenu:function(list){var friendsMatch=[];var friendlist=eval("("+list.responseText+")").list;for(var i=0;i<friendlist.length;i++){friendsMatch.push(friendlist[i])}this.friendsMatch=friendsMatch;if(friendsMatch.length>0){this.createList(friendsMatch)}this._highLightMenu(this._ul.firstChild)},createList:function(e){var b=[];var d=document.createDocumentFragment();for(var c=0;c<e.length;c++){var a=document.createElement("li");a.asid=c;a.friendid=e[c].id;a.bgphoto=e[c].head;a.asname=e[c].name;a.appendChild(document.createTextNode(e[c].name));d.appendChild(a)}this._ul.innerHTML="";this._ul.appendChild(d);this.showMenu()},clearInterval:function(){if(this._inputTimer){clearInterval(this._inputTimer);this._inputTimer=null}},setInterval:function(){var a=this;this._inputTimer=setInterval(function(){a._checkInput()},a.searchDelay*1000)},_menuOnclick:function(a){this.returnedLi=this._liHasHighlight;this._selectMenu(this._liHasHighlight)},_menuOnmouseover:function(c){var b=c.target||c.srcElement;var a;if(b.tagName.toLowerCase()=="li"){a=b}else{if(b.parentNode.tagName.toLowerCase()=="li"){a=b.parentNode}}if(a){this._highLightMenu(a)}return false},initMenu:function(){var b=document.createElement("ul");b.id="as_ul";b.className="as_ul";var a=realLeft(this.input);var e=realTop(this.input);b.style.left=a+"px";b.style.top=e+this.input.offsetHeight-1+"px";b.style.width=this.input.offsetWidth+"px";document.body.appendChild(b);this._ul=b;var d=this;this._ul.onclick=function(f){var f=f||window.event;d._menuOnclick(f)};this._ul.onmousemove=function(f){var f=f||window.event;d._menuOnmouseover(f)};var c=document.createElement("li");c.asid=c.friendid=c.asname="";c.bgphoto=this.defaultPhoto;this.li_null=c;this.hideMenu()},checkReturn:function(){var a=this;window.setTimeout(function(){if(!a.returned){a.input.value="";a.setInputTip()}else{a._selectMenu(a.returnedLi)}a.hideMenu()},200);if(this.input.value==""){this._selectMenu(this.li_null)}},init:function(){var a=this.input;this.input.value=this.inputTip;var b=this;this.initMenu();this._checkInput();a.setAttribute("autocomplete","off");a.onfocus=function(){b.setInterval();if(b.inputTip==this.value){this.value=""}};a.onblur=function(){b.clearInterval();b.checkReturn();b.setInputTip()};a.onkeydown=function(c){return b._inputOnKeyDown(c)}}};function stopEventBubble(a){if(a&&a.stopPropagation){a.preventDefault();a.stopPropagation()}if(window.event){window.event.cancelBubble=true;window.event.returnValue=false}}function getParentWithAttr(e,d,c){if(e==null){return null}var b=e.parentNode;var a=0;while((b!=null)&&(b.getAttribute!=null)&&(c==null||a<c)){if(b.getAttribute(d)!=null){return b}a++;b=b.parentNode}return null}var DNDEvents=new function(){this.dragged=null;this.dropAreas=null;this.dropAreaEles=null;this.startDrag=function(c,b){c.style.cursor="move";if(b==null){b=window.event}var a=(c.getAttribute("VIEWTYPE"))?c:c.cloneNode(true);if(c.style.width!=null){c.style.width=""}DNDEvents.dragged=a;DNDEvents.state=1;DNDEvents.calcSizes();DNDEvents.storeDiff(b,c,a);document.onmousemove=DNDEvents.positionDrag;document.onmouseup=DNDEvents.dropField;stopEventBubble(b)};this.highLightBestDropArea=function(d){var a=d.view;var e=ZDBAnalysisView.getRuleToApply(d,a);var c=a.dropAreas[e[6]];this.bestDropArea=c;var b=DOMUtils.getParentWithAttr(c,"highlightTD");this.highlightBestTD=b;b.style.backgroundColor="#2FE010"};this.storeDiff=function(c,b,a){var d=getCursorPos(c);a.diffX=d.x-findPosX(b);a.diffY=d.y-findPosY(b)};this.calcSizes=function(){dropAreaEles=$j(".DropArea");var a=dropAreaEles.length;dropAreas=new Array(a);for(var b=0;b<a;b++){dropAreas[b]=this.getDimInfo(dropAreaEles[b])}};this.getDimInfo=function(c){var b=findPosY(c);var a=b+c.offsetHeight;var e=findPosX(c);var d=e+c.offsetWidth;return[b,a,e,d]};this.isWithin=function(f,d){var c=f[0];var b=f[1];var a=f[2];var e=f[3];drgElX1=d[0];drgElX2=d[1];drgElY1=d[2];drgElY2=d[3];return(((drgElX1>c&&drgElX1<b)||(drgElX2>c&&drgElX2<b))&&((drgElY1>a&&drgElY1<e)||(drgElY2>a&&drgElY2<e)))};this.positionDrag=function(a){if(DNDEvents.state==0){return}if(DNDEvents.dragged.getAttribute("viewtype")==null){}var h=getCursorPos(a);var j=DNDEvents.dragged;var b=j.style;b.position="absolute";b.left=h.x-j.diffX;b.top=h.y-j.diffY;stopEventBubble(a);if(DNDEvents.dragged&&(DNDEvents.state==1)){document.body.appendChild(DNDEvents.dragged);DNDEvents.state=2}a=(a!=null)?a:window.event;var f=null;var e=DNDEvents.getDimInfo(j);for(var g=0;g<dropAreas.length;g++){var d="noEffect";var c=getParentWithAttr(dropAreaEles[g],"highlightTD");if((f==null)&&(DNDEvents.isWithin(dropAreas[g],e))){f=dropAreaEles[g];d="highlightDropArea"}if(c!=null&&c.className!=d){c.className=d}}};this.dropField=function(c){var b=DNDEvents.dragged;if(DNDEvents.highlightBestTD){DNDEvents.highlightBestTD.style.backgroundColor=""}if((b==null)||(DNDEvents.state!=2)){DNDEvents.stopDrag(c);return}var n=dropAreas;c=(c!=null)?c:window.event;var f=null;var l=getCursorPos(c);var d=DNDEvents.getDimInfo(b);for(var h=0;h<dropAreas.length;h++){if((DNDEvents.isWithin(dropAreas[h],d))){f=dropAreaEles[h];break}}DNDEvents.stopDrag(c);if(f!=null){var m=jQuery(f).find("div.dropyourfields div.droptip");var j=jQuery(f).attr("single");if(j){jQuery(f).find("div.dropyourfields").children().not("div.droptip").remove()}var e=jQuery(f).find("div.dropyourfields").children().not("div.droptip");var k=null;for(var h=0;h<e.length;h++){var o=e[h];var g=jQuery(o).offset();if(g.top<l.y&&g.top+24>l.y){k=o;break}}if(k!=null){createDropEle(b,jQuery(f).find("div.dropyourfields")).insertAfter(k)}else{if(m!=null){createDropEle(b,jQuery(f).find("div.dropyourfields")).insertBefore(m)}else{createDropEle(b,jQuery(f).find("div.dropyourfields")).appendTo(jQuery(f).find("div.dropyourfields"))}}}var a=getParentWithAttr(f,"highlightTD");if(a!=null){a.className="noEffect"}return true};this.resetcurGraphFieldAttr=function(a){a.setAttribute("SHOWVALUEAS","0");a.removeAttribute("BASEFIELD");a.removeAttribute("BASEFIELDFN");a.removeAttribute("BASEFIELDPOS")};this.stopDrag=function(b,c){var a=DNDEvents.dragged;if((DNDEvents.state==2)&&(a)&&(a.parentNode)&&(a.getAttribute("VIEWTYPE")==null)){a.parentNode.removeChild(a)}DNDEvents.dragged=null;document.onmouseup=null;document.onmousemove=null;DNDEvents.state=0;stopEventBubble(b)}};function getElementPos(d){var a=navigator.userAgent.toLowerCase();var b=(a.indexOf("opera")!=-1);var e=(a.indexOf("msie")!=-1&&!b);if(d.parentNode===null||d.style.display=="none"){return false}var k=null;var j=[];var h;if(d.getBoundingClientRect){h=d.getBoundingClientRect();var c=Math.max(document.documentElement.scrollTop,document.body.scrollTop);var f=Math.max(document.documentElement.scrollLeft,document.body.scrollLeft);return{x:h.left+f,y:h.top+c}}else{if(document.getBoxObjectFor){h=document.getBoxObjectFor(d);var i=(d.style.borderLeftWidth)?parseInt(d.style.borderLeftWidth):0;var g=(d.style.borderTopWidth)?parseInt(d.style.borderTopWidth):0;j=[h.x-i,h.y-g]}else{j=[d.offsetLeft,d.offsetTop];k=d.offsetParent;if(k!=d){while(k){j[0]+=k.offsetLeft;j[1]+=k.offsetTop;k=k.offsetParent}}if(a.indexOf("opera")!=-1||(a.indexOf("safari")!=-1&&d.style.position=="absolute")){j[0]-=document.body.offsetLeft;j[1]-=document.body.offsetTop}}}if(d.parentNode){k=d.parentNode}else{k=null}while(k&&k.tagName!="BODY"&&k.tagName!="HTML"){j[0]-=k.scrollLeft;j[1]-=k.scrollTop;if(k.parentNode){k=k.parentNode}else{k=null}}return{x:j[0],y:j[1]}}if(typeof infosoftglobal=="undefined"){var infosoftglobal=new Object()}if(typeof infosoftglobal.FusionChartsUtil=="undefined"){infosoftglobal.FusionChartsUtil=new Object()}infosoftglobal.FusionCharts=function(d,a,k,g,m,e,i,l,b,f,j){if(!document.getElementById){return}this.initialDataSet=false;this.params=new Object();this.variables=new Object();this.attributes=new Array();if(d){this.setAttribute("swf",d)}if(a){this.setAttribute("id",a)}m=m?m:0;this.addVariable("debugMode",m);k=k.toString().replace(/\%$/,"%25");if(k){this.setAttribute("width",k)}g=g.toString().replace(/\%$/,"%25");if(g){this.setAttribute("height",g)}if(i){this.addParam("bgcolor",i)}this.addParam("quality","high");this.addParam("allowScriptAccess","always");this.addParam("wmode","opaque");this.addVariable("chartWidth",k);this.addVariable("chartHeight",g);this.addVariable("DOMId",a);e=e?e:0;this.addVariable("registerWithJS",e);l=l?l:"noScale";this.addVariable("scaleMode",l);b=b?b:"EN";this.addVariable("lang",b);this.detectFlashVersion=f?f:1;this.autoInstallRedirect=j?j:1;this.installedVer=infosoftglobal.FusionChartsUtil.getPlayerVersion();if(!window.opera&&document.all&&this.installedVer.major>7){infosoftglobal.FusionCharts.doPrepUnload=true}};infosoftglobal.FusionCharts.prototype={setAttribute:function(a,b){this.attributes[a]=b},getAttribute:function(a){return this.attributes[a]},addParam:function(a,b){this.params[a]=b},getParams:function(){return this.params},addVariable:function(a,b){this.variables[a]=b},getVariable:function(a){return this.variables[a]},getVariables:function(){return this.variables},getVariablePairs:function(){var a=new Array();var b;var c=this.getVariables();for(b in c){a.push(b+"="+c[b])}return a},getSWFHTML:function(){var d="";if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){d='<embed type="application/x-shockwave-flash" src="'+this.getAttribute("swf")+'" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'"  ';d+=' id="'+this.getAttribute("id")+'" name="'+this.getAttribute("id")+'" ';var c=this.getParams();for(var a in c){d+=[a]+'="'+c[a]+'" '}var b=this.getVariablePairs().join("&");if(b.length>0){d+='flashvars="'+b+'"'}d+="/>"}else{d='<object id="'+this.getAttribute("id")+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'">';d+='<param name="movie" value="'+this.getAttribute("swf")+'" />';var c=this.getParams();for(var a in c){d+='<param name="'+a+'" value="'+c[a]+'" />'}var b=this.getVariablePairs().join("&");if(b.length>0){d+='<param name="flashvars" value="'+b+'" />'}d+="</object>"}return d},setDataURL:function(a){if(this.initialDataSet==false){this.addVariable("dataURL",a);this.initialDataSet=true}else{var b=infosoftglobal.FusionChartsUtil.getChartObject(this.getAttribute("id"));if(!b.setDataURL){__flash__addCallback(b,"setDataURL")}b.setDataURL(a)}},encodeDataXML:function(d){var g=["\\$","\\+"];var c=d.match(/=\s*\".*?\"/g);if(c){for(var e=0;e<c.length;e++){var h=c[e].replace(/^=\s*\"|\"$/g,"");h=h.replace(/\'/g,"%26apos;");var f=d.indexOf(c[e]);var a="='"+h+"'";var b=d.substring(0,f);var j=d.substring(f+c[e].length);var d=b+a+j}}d=d.replace(/\"/g,"%26quot;");d=d.replace(/%(?![\da-f]{2}|[\da-f]{4})/ig,"%25");d=d.replace(/\&/g,"%26");return d},setDataXML:function(a){if(this.initialDataSet==false){this.addVariable("dataXML",this.encodeDataXML(a));this.initialDataSet=true}else{var b=infosoftglobal.FusionChartsUtil.getChartObject(this.getAttribute("id"));b.setDataXML(a)}},setTransparent:function(a){if(typeof a=="undefined"){a=true}if(a){this.addParam("WMode","transparent")}else{this.addParam("WMode","Opaque")}},render:function(a){if((this.detectFlashVersion==1)&&(this.installedVer.major<8)){if(this.autoInstallRedirect==1){var b=window.confirm("You need Adobe Flash Player 8 (or above) to view the charts. It is a free and lightweight installation from Adobe.com. Please click on Ok to install the same.");if(b){window.location="http://www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash"}else{return false}}else{return false}}else{var d=(typeof a=="string")?document.getElementById(a):a;if(this.getVariable("scaleMode").search(/noscale/i)>=0&&(this.getAttribute("width").search("%")>0||this.getAttribute("height").search("%")>0)){var c=this;if(window.addEventListener){window.addEventListener("load",function(){d.innerHTML=c.getSWFHTML()},false)}else{if(window.attachEvent){window.attachEvent("onload",function(){d.innerHTML=c.getSWFHTML()})}else{d.innerHTML=this.getSWFHTML()}}}else{d.innerHTML=this.getSWFHTML()}if(!document.embeds[this.getAttribute("id")]&&!window[this.getAttribute("id")]){window[this.getAttribute("id")]=document.getElementById(this.getAttribute("id"))}return true}}};infosoftglobal.FusionChartsUtil.getPlayerVersion=function(){var c=new infosoftglobal.PlayerVersion([0,0,0]);if(navigator.plugins&&navigator.mimeTypes.length){var a=navigator.plugins["Shockwave Flash"];if(a&&a.description){c=new infosoftglobal.PlayerVersion(a.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split("."))}}else{if(navigator.userAgent&&navigator.userAgent.indexOf("Windows CE")>=0){var d=1;var b=3;while(d){try{b++;d=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+b);c=new infosoftglobal.PlayerVersion([b,0,0])}catch(f){d=null}}}else{try{var d=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7")}catch(f){try{var d=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");c=new infosoftglobal.PlayerVersion([6,0,21]);d.AllowScriptAccess="always"}catch(f){if(c.major==6){return c}}try{d=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(f){}}if(d!=null){c=new infosoftglobal.PlayerVersion(d.GetVariable("$version").split(" ")[1].split(","))}}}return c};infosoftglobal.PlayerVersion=function(a){this.major=a[0]!=null?parseInt(a[0]):0;this.minor=a[1]!=null?parseInt(a[1]):0;this.rev=a[2]!=null?parseInt(a[2]):0};infosoftglobal.FusionChartsUtil.cleanupSWFs=function(){var c=document.getElementsByTagName("OBJECT");for(var b=c.length-1;b>=0;b--){c[b].style.display="none";for(var a in c[b]){if(typeof c[b][a]=="function"){c[b][a]=function(){}}}}};if(infosoftglobal.FusionCharts.doPrepUnload){if(!infosoftglobal.unloadSet){infosoftglobal.FusionChartsUtil.prepUnload=function(){__flash_unloadHandler=function(){};__flash_savedUnloadHandler=function(){};window.attachEvent("onunload",infosoftglobal.FusionChartsUtil.cleanupSWFs)};window.attachEvent("onbeforeunload",infosoftglobal.FusionChartsUtil.prepUnload);infosoftglobal.unloadSet=true}}if(!document.getElementById&&document.all){document.getElementById=function(a){return document.all[a]}}if(Array.prototype.push==null){Array.prototype.push=function(a){this[this.length]=a;return this.length}}infosoftglobal.FusionChartsUtil.getChartObject=function(b){var a=null;if(navigator.appName.indexOf("Microsoft Internet")==-1){if(document.embeds&&document.embeds[b]){a=document.embeds[b]}else{a=window.document[b]}}else{a=window[b]}if(!a){a=document.getElementById(b)}return a};var getChartFromId=infosoftglobal.FusionChartsUtil.getChartObject;var FusionCharts=infosoftglobal.FusionCharts;